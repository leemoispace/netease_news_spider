!function(){define("deferLink",["jquery"],function(e){"use strict";function t(e){return function(t){return n.call(this,t,e)}}function n(t,n){function i(){var e=+s.data(r)-1;s.data(r,e),0>=e&&!s.data(u)&&(c.location.href=d)}var s="A"===this.nodeName?e(this):e(t.target).closest("a"),d=s.attr("href"),p=s.attr("target"),h=s.length&&d&&1===t.which&&!t.metaKey&&!t.shiftKey,f=n;if(e.isFunction(n)&&(f=n.call(this,t),f===!1))return!1;h&&t.isDefaultPrevented()&&!s.data(r)&&(h=!1),h&&p&&"_self"!==p&&(h=!1),h&&a&&s.is("[download]")&&(h=!1),h&&s.hasClass(o)&&(h=!1);var m=+(s.data(r)||0);h&&(s.data(r,m+1),f.when?("resolved"===f.state()&&i(),f.done(i)):e.isNumeric(f)?c.setTimeout(i,f):(h=!1,s.data(r,m))),h&&!m&&(t.preventDefault(),s.data(l,!0))}function i(i){return i.when||e.isNumeric(i)||e.isFunction(i)?t(i):void n.call(this,i,s)}var s=50,o="no-defer",a="download"in document.createElement("a"),r="defer-link-pends",l="defer-link-preventable",u="defer-link-prevented",c=window,d=e.Event.prototype.preventDefault;return e.Event.prototype.preventDefault=function(){var t=e(this.target);return t.data(l)&&t.data(u,!0),d.apply(this,Array.prototype.slice.call(arguments))},i}),define("utils/applyAll",["jquery"],function(e){"use strict";function t(n,i,s){var o,a;for(o=0,a=i.length;a>o;o++)e.isArray(i[o])?t(n,i[o],s):i[o].apply(n,s)}return t}),define("utils/throwError",[],function(){"use strict";return function(e){throw new Error("Error in TED: "+e)}}),define("lib/pubSub",["jquery","utils/applyAll","utils/throwError"],function(e,t,n){"use strict";function i(e){var i={publish:e.fire,subscribe:e.add,unsubscribe:e.remove},s=null;e.add(function(e){s=e}),i.read=function(){return s};var o;return i.publishUnique=function(){if(!window.JSON)return n("JSON object not available. You may need to shim it on this client."),!1;var t=Array.prototype.slice.call(arguments,0),i=JSON.stringify(t);i!==o&&(e.fire.apply(e,t),o=i)},i.once=function(){function n(){t(e,i,arguments),e.remove(n)}var i=arguments;return e.add(n)},i.future=function(){function n(){o&&t(e,s,arguments)}var i,s=arguments,o=!1;return i=e.add(n),o=!0,i},i}function s(t){var n,s=t&&o[t];return s||(n=e.Callbacks("memory"),s=i(n),t&&(o[t]=s)),s}var o={};return s._reset=function(){o={}},s}),define("lib/resize",["jquery","lodash","lib/pubSub"],function(e,t,n){"use strict";function i(e){for(var t,i=p;i--;)!t&&e>=d[i].at&&(t=d[i].its);n("sizeGroup").publishUnique(t)}function s(){var e=0,t=c;if(o=window.innerHeight,a=window.innerWidth||document.documentElement.clientWidth,u)e=l;else for(;t--;)!e&&a>=r[t]&&(e=r[t]);n("breakpoint").publishUnique(e),n("height").publishUnique(o),n("width").publishUnique(a)}var o,a,r=[320,480,600,768,1024,1200],l=1024,u=e("html").is(".oldie"),c=r.length,d=[{at:0,its:"oh"},{at:480,its:"xs"},{at:768,its:"sm"},{at:1024,its:"lg"}],p=d.length;return e(window).on("resize",t.throttle(s,100)),s(),n("breakpoint").subscribe(i),n}),define("lib/ga",["jquery","lodash","deferLink","lib/pubSub","lib/resize"],function(e,t,n,i){"use strict";function s(){(u[u.GoogleAnalyticsObject]||e.noop).apply(u,l.slice.call(arguments))}function o(){var e=l.slice.call(arguments),i=this;return function(o){return i.apply(s,e),t.has(o,"originalEvent")&&t.has(this,"nodeName")&&"click"===o.type?n.call(this,o):void 0}}function a(){var e,t=0;i("breakpoint").subscribe(function(n){s("set","dimension1",n),t++&&s.sendEvent("breakpoint","change",e+"|"+n,t),e=n})}function r(t){var n=e(this),i="ga-";t=e.extend(t||{},{category:n.data(i+"category"),action:n.data(i+"action"),label:n.data(i+"label")}),s.sendEvent(t.category,t.action,t.label)}var l=[],u=window;return t.assign(s,{send:t.partial(s,"send"),set:t.partial(s,"set"),sendEvent:t.partial(s,"send","event"),sendSocial:t.partial(s,"send","social")},function(e,t){return t.recall=o,t}),a(),s.send("pageview"),e(function(){e(document).on("click","a.ga-link",n(function(){return r.call(this,{action:"click",category:"site.link",label:this.href}),50}))}),s}),define("models/Filters",["jquery","lodash","Backbone"],function(e,t,n){"use strict";function i(e){return t.isArray(e)&&(e=t.pluck(e,"value")),t.isPlainObject(e)&&(e=e.value),e}var s=n.Model.extend({getValue:function(e){return i(this.get(e))},toJSON:function(){return t.cloneDeep(this.attributes)},toValues:function(){return t.zipObject(t.map(this.toJSON(),function(e,t){return[t,i(e)]}))}});return s}),define("hbs/underscore",{}),function(window){var JSON=window.JSON||{};!function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,s,o,a,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,n=0;o>n;n+=1)a[n]=str(n,l)||"null";return s=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,s}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(s=str(i,l),s&&a.push(quote(i)+(gap?": ":":")+s));return s=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=walk(s,n),void 0!==i?s[n]=i:delete s[n]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("templates/helpers/icon",["Handlebars"],function(e){"use strict";function t(e,t,i){return e=n(e),t=n(t),i=n(i),'<i class="icon icon_'+e+" "+(i||"")+'">'+(t?"<span class=screen-reader-text>"+t+"</span>":"")+"</i>"}var n=e.Utils.escapeExpression;return e.registerHelper("icon",function(n,i,s){return new e.SafeString(t(n,i,s))}),t}),define("hbs!templates/stub",["hbs","hbs/handlebars","templates/helpers/icon"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<span class="stub '+this.escapeExpression((s=null!=(s=t["class"]||(null!=e?e["class"]:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"class",hash:{},data:i}):s))+'" data-name="'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+'" data-value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">\n  <span class="stub__label">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+'</span>\n  <a class="stub__remove" href="#">\n    '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"close-small","Remove","stub__icon",{name:"icon",hash:{},data:i}))+"\n  </a>\n</span>\n"},useData:!0});return t.registerPartial("templates/stub",n),n}),define("templates/helpers/stub",["Handlebars","hbs!templates/stub"],function(e,t){"use strict";function n(e,n,i,s){return t({label:e,name:n,value:i,classes:s||""})}return e.registerHelper("stub",function(t,i,s,o){return new e.SafeString(n(t,i,s,o))}),n}),define("jqueryui/core",["jquery"],function(e){return function(e,t){function n(t,n){var s,o,a,r=t.nodeName.toLowerCase();return"area"===r?(s=t.parentNode,o=s.name,t.href&&o&&"map"===s.nodeName.toLowerCase()?(a=e("img[usemap=#"+o+"]")[0],!!a&&i(a)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var s=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,s,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(o.css("zIndex"),10),!isNaN(s)&&0!==s))return s;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),s=isNaN(i);return(s||i>=0)&&n(t,!s)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function s(t,n,i,s){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?r["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var s,o=e.ui[t].prototype;for(s in i)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([n,i[s]])},call:function(e,t,n){var i,s=e.plugins[t];if(s&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",s=!1;return t[i]>0?!0:(t[i]=1,s=t[i]>0,t[i]=0,s)}})}(e),e}),define("hbs!templates/comboPopup",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="combo__query">\n  <input class="form-control combo__input" placeholder="'+this.escapeExpression((s=null!=(s=t.inputPlaceholder||(null!=e?e.inputPlaceholder:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"inputPlaceholder",hash:{},data:i}):s))+'">\n  <div class="combo__indicator"></div>\n</div>\n\n<div class="combo__results">\n</div>\n\n<div class="combo__no-results">\n</div>\n\n<div class="combo__defaults">\n</div>\n'},useData:!0});return t.registerPartial("templates/comboPopup",n),n}),define("hbs!templates/comboList",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'  <h4 class="m5 combo__label">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</h4>\n"},3:function(e,t,n,i){var s;return'    <li class="combo__item">\n      <a class="l3 combo__link" href="#" data-value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">\n        '+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"\n      </a>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"\n"+(null!=(s=t["if"].call(e,null!=e?e.label:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'\n<ul class="sl combo__list">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+"</ul>\n"},useData:!0});return t.registerPartial("templates/comboList",n),n}),define("hbs!templates/comboNoResults",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e){var t;return"\nSorry, no matches for <q>"+this.escapeExpression(this.lambda(null!=(t=null!=e?e.request:e)?t.term:t,e))+"</q>\n"},useData:!0});return t.registerPartial("templates/comboNoResults",n),n}),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("spinjs",t):e.Spinner=t()}(this,function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var s=["opacity",t,~~(100*e),n,i].join("-"),o=.01+n/i*100,a=Math.max(1-(1-e)/t*(100-o),e),r=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=r&&"-"+r+"-"||"";return p[s]||(h.insertRule("@"+l+"keyframes "+s+"{0%{opacity:"+a+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",h.cssRules.length),p[s]=1),s}function i(e,t){var n,i,s=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<d.length;i++)if(n=d[i]+t,void 0!==s[n])return n;return void 0!==s[t]?t:void 0}function s(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function a(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function r(e,t){return"string"==typeof e?e:e[t%e.length]}function l(e){return"undefined"==typeof this?new l(e):void(this.opts=o(e||{},l.defaults,f))}function u(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}h.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(e,i){function o(){return s(n("group",{coordsize:c+" "+c,coordorigin:-u+" "+-u}),{width:c,height:c})}function a(e,a,l){t(p,t(s(o(),{rotation:360/i.lines*e+"deg",left:~~a}),t(s(n("roundrect",{arcsize:i.corners}),{width:u,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:r(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,u=i.length+i.width,c=2*u,d=2*-(i.width+i.length)+"px",p=s(o(),{position:"absolute",top:d,left:d});if(i.shadow)for(l=1;l<=i.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)a(l);return t(e,p)},l.prototype.opacity=function(e,t,n,i){var s=e.firstChild;i=i.shadow&&i.lines||0,s&&t+i<s.childNodes.length&&(s=s.childNodes[t+i],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=n))}}var c,d=["webkit","Moz","ms","O"],p={},h=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},o(l.prototype,{spin:function(t){this.stop();var n,i,o=this,r=o.opts,l=o.el=s(e(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex}),u=r.radius+r.length+r.width;if(t&&(t.insertBefore(l,t.firstChild||null),i=a(t),n=a(l),s(l,{left:("auto"==r.left?i.x-n.x+(t.offsetWidth>>1):parseInt(r.left,10)+u)+"px",top:("auto"==r.top?i.y-n.y+(t.offsetHeight>>1):parseInt(r.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),o.lines(l,o.opts),!c){var d,p=0,h=(r.lines-1)*(1-r.direction)/2,f=r.fps,m=f/r.speed,g=(1-r.opacity)/(m*r.trail/100),v=m/r.lines;!function _(){p++;for(var e=0;e<r.lines;e++)d=Math.max(1-(p+(r.lines-e)*v)%m*g,r.opacity),o.opacity(l,e*r.direction+h,d,r);o.timeout=o.el&&setTimeout(_,~~(1e3/f))}()}return o},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,o){function a(t,n){return s(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*u+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var l,u=0,d=(o.lines-1)*(1-o.direction)/2;u<o.lines;u++)l=s(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,d+u*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(l,s(a("#000","0 0 4px #000"),{top:"2px"})),t(i,t(l,a(r(o.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var m=s(e("group"),{behavior:"url(#default#VML)"});return!i(m,"transform")&&m.adj?u():c=i(m,"animation"),l}),define("jqueryui/widget",["jquery"],function(e){return function(e,t){var n=0,i=Array.prototype.slice,s=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}s(t)},e.widget=function(t,n,i){var s,o,a,r,l={},u=t.split(".")[0];t=t.split(".")[1],s=u+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[u]=e[u]||{},o=e[u][t],a=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),r=new n,r.options=e.widget.extend({},r.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},s=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=s,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||t:t},l,{constructor:a,namespace:u,widgetName:t,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete o._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(n){for(var s,o,a=i.call(arguments,1),r=0,l=a.length;l>r;r++)for(s in a[r])o=a[r][s],a[r].hasOwnProperty(s)&&o!==t&&(n[s]=e.isPlainObject(o)?e.isPlainObject(n[s])?e.widget.extend({},n[s],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,s){var o=s.prototype.widgetFullName||n;e.fn[n]=function(a){var r="string"==typeof a,l=i.call(arguments,1),u=this;return a=!r&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,this.each(r?function(){var i,s=e.data(this,o);return s?e.isFunction(s[a])&&"_"!==a.charAt(0)?(i=s[a].apply(s,l),i!==s&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+a+"'")}:function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new s(a,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var s,o,a,r=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(r={},s=n.split("."),n=s.shift(),s.length){for(o=r[n]=e.widget.extend({},this.options[n]),a=0;a<s.length-1;a++)o[s[a]]=o[s[a]]||{},o=o[s[a]];if(n=s.pop(),1===arguments.length)return o[n]===t?null:o[n];o[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];r[n]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var s,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=s=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,s=this.widget()),e.each(i,function(i,a){function r(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?s.delegate(c,u,r):n.bind(u,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var s,o,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(s in o)s in n||(n[s]=o[s]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,s,o){"string"==typeof s&&(s={effect:s});var a,r=s?s===!0||"number"==typeof s?n:s.effect||n:t;s=s||{},"number"==typeof s&&(s={duration:s}),a=!e.isEmptyObject(s),s.complete=o,s.delay&&i.delay(s.delay),a&&e.effects&&e.effects.effect[r]?i[t](s):r!==t&&i[r]?i[r](s.duration,s.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(e),e}),define("widgets/filterable",["jquery","lodash","jqueryui/core","jqueryui/widget"],function(e,t){"use strict";e.widget("ted.filterable",{options:{results:null,source:null,max:5},search:function(e){this.source&&this.source({term:e},t.bind(this._response,this))},_abort:function(){this._filterableLastQuery&&(this._filterableLastQuery.abort(),this._filterableLastQuery=null)},_create:function(){this._createSource()},_createSource:function(){var n=this;if(t.isObject(this.options.source)){var i=[];t.forOwn(this.options.source,function(n,s){i.push(e.extend({value:n.value||n.label||s,label:n.label||n.value||n},t.isObject(n)?n:{}))}),this.options.source=i}this.options.source||(this.options.source=t.compact(this.element.find("option").map(function(){var t=e(this),n=t.attr("value");return n?{value:n,label:t.text()}:!1}).toArray())),t.isArray(this.options.source)&&(this.source=function(t,n){n(e.ted.filterable.filter(this.options.source,t.term),t)}),t.isString(this.options.source)&&(this.source=function(t,i){return t.term?(n._abort(),void(n._filterableLastQuery=e.ajax({url:this.options.source,data:{term:t.term},dataType:"json"}).done(function(e){i(e,t)}))):void i()}),t.isFunction(this.options.source)&&(this.source=this.options.source)},_setResults:function(e){this.options.results=t.map(e,function(e){return t.isObject(e)?e:{value:e,label:e}}).slice(0,this.options.max)},_response:function(e){this._setResults(e)},_setOption:function(e,t){this._super(e,t),"source"===e&&this._createSource()}}),e.extend(e.ted.filterable,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){if(n){var i=new RegExp(e.ted.filterable.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)?e:!1})}}})}),define("jqueryui/position",["jquery"],function(e){return function(e,t){function n(e,t,n){return[parseFloat(e[0])*(h.test(e[0])?t/100:1),parseFloat(e[1])*(h.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}function s(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var o,a=Math.max,r=Math.abs,l=Math.round,u=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,h=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(o!==t)return o;var n,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),n=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,n===i&&(i=s[0].clientWidth),s.remove(),o=n-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),s="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,o="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:o?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]),s=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:s,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var o,h,m,g,v,_,b=e(t.of),y=e.position.getWithinInfo(t.within),w=e.position.getScrollInfo(y),k=(t.collision||"flip").split(" "),x={};return _=s(b),b[0].preventDefault&&(t.at="left top"),h=_.width,m=_.height,g=_.offset,v=e.extend({},g),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=u.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=u.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=d.exec(i[0]),n=d.exec(i[1]),x[this]=[e?e[0]:0,n?n[0]:0],t[this]=[p.exec(i[0])[0],p.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===t.at[0]?v.left+=h:"center"===t.at[0]&&(v.left+=h/2),"bottom"===t.at[1]?v.top+=m:"center"===t.at[1]&&(v.top+=m/2),o=n(x.at,h,m),v.left+=o[0],v.top+=o[1],this.each(function(){var s,u,c=e(this),d=c.outerWidth(),p=c.outerHeight(),f=i(this,"marginLeft"),_=i(this,"marginTop"),C=d+f+i(this,"marginRight")+w.width,S=p+_+i(this,"marginBottom")+w.height,D=e.extend({},v),E=n(x.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?D.left-=d:"center"===t.my[0]&&(D.left-=d/2),"bottom"===t.my[1]?D.top-=p:"center"===t.my[1]&&(D.top-=p/2),D.left+=E[0],D.top+=E[1],e.support.offsetFractions||(D.left=l(D.left),D.top=l(D.top)),s={marginLeft:f,marginTop:_},e.each(["left","top"],function(n,i){e.ui.position[k[n]]&&e.ui.position[k[n]][i](D,{targetWidth:h,targetHeight:m,elemWidth:d,elemHeight:p,collisionPosition:s,collisionWidth:C,collisionHeight:S,offset:[o[0]+E[0],o[1]+E[1]],my:t.my,at:t.at,within:y,elem:c})}),t.using&&(u=function(e){var n=g.left-D.left,i=n+h-d,s=g.top-D.top,o=s+m-p,l={target:{element:b,left:g.left,top:g.top,width:h,height:m},element:{element:c,left:D.left,top:D.top,width:d,height:p},horizontal:0>i?"left":n>0?"right":"center",vertical:0>o?"top":s>0?"bottom":"middle"};d>h&&r(n+i)<h&&(l.horizontal="center"),p>m&&r(s+o)<m&&(l.vertical="middle"),l.important=a(r(n),r(i))>a(r(s),r(o))?"horizontal":"vertical",t.using.call(this,e,l)
}),c.offset(e.extend(D,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollLeft:i.offset.left,o=i.width,r=e.left-t.collisionPosition.marginLeft,l=s-r,u=r+t.collisionWidth-o-s;t.collisionWidth>o?l>0&&0>=u?(n=e.left+l+t.collisionWidth-o-s,e.left+=l-n):e.left=u>0&&0>=l?s:l>u?s+o-t.collisionWidth:s:l>0?e.left+=l:u>0?e.left-=u:e.left=a(e.left-r,e.left)},top:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollTop:i.offset.top,o=t.within.height,r=e.top-t.collisionPosition.marginTop,l=s-r,u=r+t.collisionHeight-o-s;t.collisionHeight>o?l>0&&0>=u?(n=e.top+l+t.collisionHeight-o-s,e.top+=l-n):e.top=u>0&&0>=l?s:l>u?s+o-t.collisionHeight:s:l>0?e.top+=l:u>0?e.top-=u:e.top=a(e.top-r,e.top)}},flip:{left:function(e,t){var n,i,s=t.within,o=s.offset.left+s.scrollLeft,a=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,u=e.left-t.collisionPosition.marginLeft,c=u-l,d=u+t.collisionWidth-a-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(n=e.left+p+h+f+t.collisionWidth-a-o,(0>n||n<r(c))&&(e.left+=p+h+f)):d>0&&(i=e.left-t.collisionPosition.marginLeft+p+h+f-l,(i>0||r(i)<d)&&(e.left+=p+h+f))},top:function(e,t){var n,i,s=t.within,o=s.offset.top+s.scrollTop,a=s.height,l=s.isWindow?s.scrollTop:s.offset.top,u=e.top-t.collisionPosition.marginTop,c=u-l,d=u+t.collisionHeight-a-l,p="top"===t.my[1],h=p?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>c?(i=e.top+h+f+m+t.collisionHeight-a-o,e.top+h+f+m>c&&(0>i||i<r(c))&&(e.top+=h+f+m)):d>0&&(n=e.top-t.collisionPosition.marginTop+h+f+m-l,e.top+h+f+m>d&&(n>0||r(n)<d)&&(e.top+=h+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,s,o,a=document.getElementsByTagName("body")[0],r=document.createElement("div");t=document.createElement(a?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},a&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in i)t.style[o]=i[o];t.appendChild(r),n=a||document.documentElement,n.insertBefore(t,n.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",s=e(r).offset().left,e.support.offsetFractions=s>10&&11>s,t.innerHTML="",n.removeChild(t)}()}(e),e}),define("widgets/popup",["jquery","lodash","jqueryui/widget","jqueryui/position"],function(e,t){"use strict";function n(e,t){this.element.removeClass(a).css(e).addClass(s+t.horizontal+" "+s+("center"===t.vertical?"middle":t.vertical))}for(var i=300,s="popup--tailed--",o=["center","left","middle","right","bottom","top"],a="",r=o.length;r--;)a+=s+o[r]+" ";return e.widget("ted.popup",{options:{position:{my:"center bottom-20",at:"center top",of:window,collision:"fit flip"},inverse:!1,tail:!0},_create:function(){this.options.position.using||(this.options.position.using=t.bind(n,this)),this.element.addClass("popup"+(this.options.tail?" popup--tailed":"")+(this.options.inverse?" popup--inverse":" inverse"))},_isOpen:!1,open:function(e){var t=this;t._trigger("beforeOpen",e)!==!1&&(t.position(),t._isOpen=!0,t.element.removeClass("popup--hide").addClass("popup--show"),t._trigger("open"))},close:function(e){var t=this,n=t.element;t._trigger("beforeClose",e)!==!1&&(t._isOpen=!1,n.addClass("popup--hide"),setTimeout(function(){t._isOpen||n.removeClass("popup--show")},i),t._trigger("close"))},position:function(){this.element.addClass("popup--positioning").position(this.options.position).removeClass("popup--positioning")}}),function(t,n){return e(t).popup(n)}}),define("widgets/combo",["jquery","lodash","hbs!templates/comboPopup","hbs!templates/comboList","hbs!templates/comboNoResults","lib/pubSub","spinjs","jqueryui/core","jqueryui/widget","widgets/filterable","widgets/popup","lib/resize"],function(e,t,n,i,s,o,a){"use strict";function r(){this.close()}function l(e,t){e.left=this.opener.position().left,this.popup.css(e),"top"===t.vertical?this.root.removeClass(h).addClass(p):this.root.removeClass(p).addClass(h)}function u(e,t){return{value:t,label:e}}var c="combo",d=c+"--open",p=c+"--dropped-up",h=c+"--dropped-down",f=c+"--with-results",m=c+"--no-results",g=c+"--with-defaults",v=c+"__opener",_=c+"__popup",b=c+"__link",y=b+"--active";e.widget("ted.combo",e.ted.filterable,{options:{defaults:null,defaultsLabel:null,listTempl:null,noResultsTempl:null,inputPlaceholder:null,results:null,source:null,max:5,position:{my:"left top-1px",at:"left bottom",collision:"none none"}},open:function(e){e&&e.preventDefault(),this._createPopup(),this.popup.width(this.opener.outerWidth()-2).popup("open"),this._isOpen=!0,this.root.addClass(d),this.input.focus()},clear:function(e){e&&e.preventDefault();var t=this.element.find('option:not([value]),option[value=""]').prop("selected",!0).text();this.label(t)},close:function(t){this._abort(),!this.popup||!this._isOpen||t&&e(t.target).closest(this.popup).length||t&&e(t.target).closest(this.opener).length||(t&&t.preventDefault(),this.popup.find("a."+y).removeClass(y),this.popup.popup("close"),this._isOpen=!1,this.root.removeClass(d))},collapse:function(){this.close(),this.opener.focus()},label:function(e){this.opener.text(e)},search:function(e){this.spinner||(this.spinner=new a({lines:9,length:2,width:2,radius:4,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:50,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"})),this.spinner.spin(this.indicator.get(0)),this._trigger("search",null,{term:e}),this._superApply(arguments)},_isOpen:!1,_clickItem:function(t){t.preventDefault(),this._select(e(t.target),t)},_create:function(){this.options.listTempl||(this.options.listTempl=i),this.options.noResultsTempl||(this.options.noResultsTempl=s),this.options.inputPlaceholder||(this.options.inputPlaceholder=this.element.data("combo-placeholder")||"Searchâ€¦"),this._createSource(),this._search=t.throttle(t.bind(this._search,this),300),this._createOpener(),this.element.hide(),this.label(this.element.find("option:selected").text()),this._on(this.opener,{click:this.open}),this._on(document.body,{click:this.close}),o("width").subscribe(t.bind(r,this))},_createRoot:function(){this.root||(this.root=e("<span></span>").addClass(c).insertAfter(this.element))},_createOpener:function(){this.opener||(this._createRoot(),this.opener=e('<a href="#"></a>').addClass(this.element.attr("class")+" form-control form-control--dropdown "+v).appendTo(this.root))},_createPopup:function(){if(!this.popup){var i=e.extend({of:this.opener,using:t.bind(l,this)},this.options.position);if(this.options.defaults)t.isArray(this.options.defaults)||(this.options.defaults=t.map(this.options.defaults,u));else{var s=this.element.find("option").map(function(){var n=e(this),i=n.attr("value");return t.isEmpty(i)?null:{label:n.text(),value:i}}).toArray();this.options.defaults=t.compact(s)}null===this.options.defaultsLabel&&(this.options.defaultsLabel=this.element.find("optgroup").attr("label")),this.popup=e("<div></div>").addClass(_).html(n(this.options)).popup({inverse:!0,position:i,tail:!1}).appendTo(this.root),this.input=this.popup.find("input.combo__input"),this.results=this.popup.find("div.combo__results"),this.noResults=this.popup.find("div.combo__no-results"),this.defaults=this.popup.find("div.combo__defaults"),this.indicator=this.popup.find("div.combo__indicator"),this._renderDefaults(),this._on(this.popup,{"click a.combo__link":this._clickItem,"keydown input.combo__input":this._keyDown,"keyup input.combo__input":this._keyUp})}},_keyDown:function(t){var n=e.ui.keyCode;switch(t.keyCode){case n.TAB:t.preventDefault(),this.collapse()}},_keyUp:function(t){var n,i=e.ui.keyCode;switch(t.keyCode){case i.UP:this._move(-1);break;case i.DOWN:this._move(1);break;case i.ENTER:case i.NUMPAD_ENTER:t.preventDefault(),n=this.popup.find("a."+y),n.length&&(this._select(n,t),this.collapse());break;case i.LEFT:case i.RIGHT:break;default:this._search(t)}},_move:function(e){var t,n=this.popup.find("a."+b),i=n.filter("a."+y),s=n.index(i.get(0));n.removeClass(y),t=i.length?0===s&&-1===e?n.last():s===n.length-1&&1===e?n.first():n.eq(s+e):n.first(),t.addClass(y)},_renderDefaults:function(){this.options.defaults&&this.options.defaults.length?(this.defaults&&this.defaults.html(this.options.listTempl({items:this.options.defaults,label:this.options.defaultsLabel})),this.root.addClass(g)):this.root.removeClass(g)},_renderResults:function(e){this.options.results&&this.options.results.length?(this.results.html(this.options.listTempl({items:this.options.results})),this.root.addClass(f).removeClass(m)):e&&e.term?(this.noResults.html(this.options.noResultsTempl({request:e})),this.root.addClass(m).removeClass(f)):this.root.removeClass(f).removeClass(m)},_response:function(e,t){this.spinner.stop(),this._setResults(e),this._renderResults(t)},_search:function(t){this.search(e(t.target).val())},_select:function(e,t){var n=e.data("value"),i=this._getItem(n);this._setItem(i),this.label(i.label),this._trigger("change",t,{item:i,el:e}),this.close()},_getItem:function(e){return e+="",t.find(t.union(this.options.results,this.options.defaults),function(t){return""+t.value===e})},_setItem:function(t){var n=t.value+"",i=t.label+"";this.element.val(n),this.element.val()!==n&&(this._customOption||(this._customOption=e("<option>").appendTo(this.element)),this._customOption.text(i).attr("value",n),this.element.val(n))},_setOption:function(e,n){if(this._super(e,n),"defaults"===e&&this._renderDefaults(),"source"===e){this._createSource();var i=!0;t.isArray(this.options.source)&&(i=!t.where(n,{value:+this.element.val()}).length),i&&this.clear(),this.input&&this.input.val(""),this.results&&(this.options.results=null,this._renderResults())}}})}),define("views/FiltersView",["jquery","lodash","Backbone","templates/helpers/stub","lib/pubSub","jqueryui/core","widgets/combo","lib/resize"],function(e,t,n,i,s){"use strict";function o(e){e.length&&e[0].which&&e[0].preventDefault()}function a(e){m.animate({scrollTop:e.offset().top},200)}function r(e){return t.flatten(t.map(e,function(e,n){return t.isArray(e)?t.map(e,function(e){return i(e.label,n,e.value)}):i(e.label,n,e.value)})).join(" ")}function l(e){e.data("tedCombo")?e.combo("clear"):(e.val(""),e.find('option:not([value]),option[value=""]').filter("option:not([disabled])").prop("selected",!0))}function u(e,t){e.val(t.value),e.data("tedCombo")&&e.combo("label",t.label)}function c(){return s("breakpoint").read()<768}var d="filters",p=d+"--open",h=d+"--stubbed",f=d+"__filter__stubs",m=e("html,body"),g=n.View.extend({events:{"change select.filters__sort__select":"updateModel","keydown input.filters__filter__input":"_keyDown","keyup input.filters__filter__input":"_keyUp","change select.filters__filter__select":"_setFilter","autocompletechange input.filters__filter__autocomplete":"_setFilter","combochange select.filters__filter__combo":"_setFilter","change input.filters__filter__checkbox":"_toggleCheckbox","click .filters__apply":"applyFilters","click .filters__clear":"clearFilters","click a.stub__remove":"_removeStub","click div.filters__opener":"toggleOpen"},applyFilters:function(){o(arguments),this.updateModel()},clearFilters:function(){o(arguments),this.$el.removeClass(p),this.$filters.each(function(){l(e(this))}),this._filters={},this.updateModel(),c()&&a(this.$el)},initialize:function(e){t.assign(this._options,e||{}),this._filters={}},setFilter:function(e){var n=e.name,i=e.value,s=e.label,o=e.isMultiple||!1;if(t.isEmpty(i))o||this.removeFilter(n,i);else{var a={value:i,label:s};if(o){var r=this._filters[n]||[];r.push(a),r=t.uniq(r,"value"),this._filters[n]=r}else this._filters[n]=a}c()?this.renderStubs():this.applyFilters()},removeFilter:function(e,n){var i=!t.isArray(this._filters[e]);return i||(this._filters[e]=t.reject(this._filters[e],function(e){return e.value===n}),i=!this._filters[e].length),i&&delete this._filters[e],c()?void this.renderStubs():void(t.isEmpty(this._filters)?this.clearFilters():this.applyFilters())},render:function(){var n,i=this,o=i._options.sources||{};return i.$filters=i.$el.find("input.filters__filter__input, select.filters__filter__select, select.filters__filter__combo, input.filters__filter__autocomplete"),i.$stubs=i.$el.find("div.filters__active__stubs"),i.$filterStubs=i.$filters.after("<div class="+f+"></div>").next("div."+f),i.$filters.filter("select.filters__filter__combo").each(function(){var t=e(this),n=t.attr("name");t.combo({source:o[n]||null})}),s("breakpoint").subscribe(function(e){var s=768>e;n!==s&&(n=s,i._setFieldsFromFilters(),s||t.isEmpty(this._filters)||this.applyFilters())}),i._setFilters(),this.listenTo(this.model,"change",this._updatedModel),i},renderStubs:function(){var e=this._filters,n=!t.isEmpty(this._filters),i=this,s=i.$stubs.find("a.filters__clear").remove();return i.$stubs.empty(),i.$filterStubs.empty(),i.$el[n?"addClass":"removeClass"](h),n?(t.forOwn(i._filters,function(e,n){var s={};t.isArray(e)&&(s[n]=e,i.$filters.filter("[name="+n+"]").nextAll("div."+f).html(r(s)))}),void i.$stubs.append(r(e)).append(s)):void i.$stubs.append(s)},toggleOpen:function(){o(arguments),this.$el.toggleClass(p)},updateModel:function(){var n=t.cloneDeep(this._filters),i=e("select.filters__sort__select").find("option:selected").attr("value");i&&(n.sort=i);var s=this.model.toJSON();t.extend(n,t.pick(s,this._options.stubless)),this.model.clear({silent:t.isEmpty(s)||!t.isEmpty(n)}).set(n)},_options:{stubless:[]},_keyDown:function(t){var n=e.ui.keyCode;switch(t.keyCode){case n.TAB:this._setFilter(t)}},_keyUp:function(t){var n=e.ui.keyCode;switch(t.keyCode){case n.ENTER:case n.NUMPAD_ENTER:t.preventDefault(),this._setFilter(t)}},_removeStub:function(t){o(arguments);var n=e(t.target).closest("span.stub");this.removeFilter(n.data("name"),n.data("value"))},_setFieldsFromFilters:function(){var n=s("breakpoint").read()<768,i=this;i.$filters.each(function(){var s=e(this),o=i._filters[s.attr("name")];n&&o&&!t.isArray(o)?u(s,o):l(s)})},_toggleCheckbox:function(t){var n=e(t.target),i=n.closest("label"),s=n.attr("name"),o=n.attr("value");n.is(":checked")?this._filters[s]={value:o,label:i.text().trim()}:this.removeFilter(s,o),c()?this.renderStubs():this.applyFilters()},_setFilter:function(t){var n=e(t.target),i=n.find("option:selected"),s=n.attr("name"),o=!!n.data("filter-multiple"),a=i.text(),r=i.attr("value");i.length||(a=r=n.val()),i.hasClass("modalized-select__custom-option")&&i.remove(),(!c()||o)&&l(n),this.setFilter({name:s,value:r,label:a,isMultiple:o})},_setFilters:function(){var n,i={};n=this.$filters.filter("select[data-filter-multiple=true]").map(function(){return this.name}).toArray(),this.$stubs.find("span.stub").each(function(){var s,o=e(this),a=o.data("name"),r=o.data("value");s={label:o.find("span.stub__label").text(),value:r},t.contains(n,a)?(i[a]=i[a]||[],i[a].push(s)):i[a]=s}),this._filters=i,this.renderStubs();var s=this.model.toJSON();t.extend(i,t.pick(s,this._options.stubless)),this.model.set(i)},_updatedModel:function(){this._filters=t.omit(this.model.toJSON(),t.union(["sort"],this._options.stubless)),this._setFieldsFromFilters(),this.renderStubs()}});return g}),define("Modernizr",[],function(){"use strict";return window.Modernizr}),define("views/ResultsView",["jquery","lodash","Modernizr","Backbone","spinjs"],function(e,t,n,i,s){"use strict";function o(){return window.location.pathname+window.location.search}var a="results",r=a+"--loading",l=i.View.extend({events:{"click div.pagination a":"clickPage"},initialize:function(i){t.assign(this,i||{}),this._beforeSend=t.bind(this._beforeSend,this),this._popState=t.bind(this._popState,this),this.filtersModel&&this.listenTo(this.filtersModel,"change",this._updatedModel),n.history&&window.history.replaceState(this._getState(),null,o()),e(window).on("popstate",this._popState)},clickPage:function(t){t.preventDefault(),window.scroll(0,this.$el.offset().top-60),this.fetch({beforeSend:this._beforeSend,url:e(t.target).attr("href")})},endLoadingState:function(){this.getSpinner().stop(),this.$el.removeClass(r)},fetch:function(n){return this.$el.empty().addClass(r),this.getSpinner().spin(this.$el.get(0)),e.ajax(n).always(t.bind(this.endLoadingState,this)).then(t.bind(this.renderResult,this),t.bind(this.renderError,this))},fetchFresh:function(){var e=this.filtersModel.toValues(),t=window.location.pathname;return this.fetch({beforeSend:this._beforeSend,data:e,url:t})},getSpinner:function(){return this._spinner||(this._spinner=new s({className:"spinner spinner--centered"})),this._spinner},render:function(e){this.$el.html(e)},renderError:function(){this.render("<p class=p1>There was an error.</p>")},renderResult:function(t){this.render(e(t).find("#"+this.$el.attr("id")).html())},_suppressRefresh:!1,_beforeSend:function(e,t){n.history&&t.url!==o()&&window.history.pushState(this._getState(),null,t.url)},_getState:function(){return{filters:this.filtersModel.toJSON()}},_popState:function(e){var t=e.originalEvent.state;t&&t.filters&&(this._suppressRefresh=!0,this.filtersModel.clear().set(t.filters),this._suppressRefresh=!1,this.fetch({url:window.location.href}))},_updatedModel:function(){this._suppressRefresh||this.fetchFresh()}});return l}),define("templates/helpers/t",["Handlebars"],function(e){"use strict";e.registerHelper("t",function(e){return e})}),define("hbs!templates/modalDefault",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n  </a>\n  <h3 class="modal__head__title">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+"</h3>\n</div>\n"},useData:!0});return t.registerPartial("templates/modalDefault",n),n}),define("lib/focus-zone",["jquery","lodash","jqueryui/core"],function(e,t){"use strict";function n(t){this.$el=e(t)}function i(e){e.preventDefault()}var s=e(window);return n.__reset=function(){t.assign(n,{__active:void 0,__isListening:!1,__zones:[]})},n.__addZone=function(e){n.__zones.push(e),n.__setActive(),n.__startListening()},n.__removeZone=function(e){n.__zones=t.without(n.__zones,e),n.__setActive(),n.__stopListening()},n.__setActive=function(){n.__active=t.last(n.__zones)},n.__startListening=function(){n.__isListening||n.__active&&(n.__startListeningInner(),n.__isListening=!0)},n.__startListeningInner=function(){s.on("keydown",n.__keyDown)},n.__stopListening=function(){n.__isListening&&(n.__active||(n.__stopListeningInner(),n.__isListening=!1))},n.__stopListeningInner=function(){s.off("keydown",n.__keyDown)},n.__keyDown=function(s){var o=n.__active;if(o&&s.keyCode===e.ui.keyCode.TAB){var a=s.target,r=o.$el,l=r.find(":tabbable"),u=l.filter(":first"),c=l.filter(":last");a!==c[0]&&a!==r[0]||s.shiftKey?a!==u[0]&&a!==r[0]||!s.shiftKey?-1===t.indexOf(l,a)&&(u.focus(),i(s)):(c.focus(),i(s)):(u.focus(),i(s))}},t.assign(n.prototype,{activate:function(){return this._recordFocus(),n.__addZone(this),this},deactivate:function(){return n.__removeZone(this),this._restoreFocus(),this},_recordFocus:function(){this.$focus=e(":focus")},_restoreFocus:function(){this.$focus&&this.$focus.length&&this.$focus.focus()}}),n.__reset(),n}),define("widgets/modal",["jquery","lodash","hbs!templates/modalDefault","lib/pubSub","lib/focus-zone","jqueryui/widget","lib/resize"],function(e,t,n,i,s){"use strict";function o(){d||(c=e(window),l=e(document.body),u=e("html"))}var a,r,l,u,c,d=0,p="modal-backdrop--show",h="modal--show",f="modal-open",m="modal__content",g=0;return r=["<div class=modal>","<div class=modal__outer>","<div class=modal__inner>"].join(""),i("breakpoint").subscribe(function(e){a=768>e}),e.widget("ted.modal",{options:{align:"middle",autoOpen:!0},_create:function(){var t=this;o(),this.options.title&&this.element.prepend(n(this.options)),this.modal=this.element.addClass(m).css("display","").wrap(r).closest("div.modal"),this.modal.addClass("modal--align-"+this.options.align);var i=e("<div class=modal-backdrop>");this.backdrop=i;var u=e("<div class=modal-wrapper>");this.wrapper=u,u.append(this.backdrop).append(this.modal),this.focusZone=new s(this.modal),this.wrapper.on("click",function(n){return a?!0:e(n.target).closest("div.modal__content").length?!0:(n.preventDefault(),void t.close())}),l.append(this.wrapper),this._on({"click a.modal__close":function(e){e.preventDefault(),t.close()},keyup:function(n){n.preventDefault(),n.keyCode===e.ui.keyCode.ESCAPE&&t.close()}}),this.options.autoOpen&&t.open()},_destroy:function(){var e=this;t.defer(function(){e.wrapper.remove()})},open:function(){var e=this;return this._hasOpened?(e.backdrop.addClass(p),e.openedAt={y:c.scrollTop()},g++||u.addClass(f),a&&window.scrollTo(0,0),e.modal.addClass(h),e.focusZone.activate(),this.element.attr("tabindex",0),this.element.focus(),void e._trigger("open")):void window.setTimeout(function(){e._hasOpened||(e._hasOpened=!0,e.open())},10)},close:function(){this.modal.removeClass(h),--g||u.removeClass(f),this.openedAt&&window.scrollTo(0,this.openedAt.y),this.backdrop.removeClass(p),this.element.attr("tabindex",-1),this.focusZone.deactivate(),this._trigger("close")}}),function(t,n){return e(t).modal(n)}}),define("widgets/selectModal",["jquery","spinjs","hbs!templates/modalDefault","widgets/modal"],function(e,t,n){"use strict";e.widget("ted.selectModal",{modal:null,content:null,options:{loading:!0,title:null,triggerValue:"...",modalAlignment:"middle"},_customOption:null,_isOpen:!1,_loading:null,_spinner:null,open:function(){this.modal||this._createModal(),this.modal.modal("open")},close:function(){this.modal&&this.modal.modal("close")},val:function(e,t){this._val(e,t||e),this.close(),this.element.trigger("change")},html:function(e){this.content||this._createModal(),this.content.html(e),this.loading(!1)},loading:function(e){this.options.loading=e,this.modal&&(this._isOpen&&e?this._startSpinner():this._stopSpinner(),this.modal[e?"addClass":"removeClass"]("select-modal--loading"))},_create:function(){var e=this;e.element.addClass("modalized-select"),e.options.title||(e.options.title=e._getDefault().text()),this._on({change:function(t){e.element.val()===e.options.triggerValue?(t.preventDefault(),t.stopImmediatePropagation(),e._getDefault().prop("selected",!0),e.open()):e._trigger("change",t)}})},_createModal:function(){var t=this,i=e("<div class=select-modal></div>");t.modal=i,i.html(n({title:t.options.title})+"<div class=select-modal__loading></div><div class=select-modal__content></div>"),t.content=t.modal.find("div.select-modal__content"),t._loading=t.modal.find("div.select-modal__loading").get(0),t._on(t.modal,{"click a.select-modal__link":function(n){var i=e(n.target);n.preventDefault(),t.val(i.data("value"),e.trim(i.text()))},modalopen:function(e){t._isOpen=!0,t.loading(t.options.loading),t._trigger("open",e)},modalclose:function(e){t._isOpen=!1,t._stopSpinner(),t._trigger("close",e)}}),t.modal.modal({align:t.options.modalAlignment,autoOpen:!1})},_getDefault:function(){return this.element.find('option:not([value]),option[value=""]').filter("option:not([disabled])").first()},_startSpinner:function(){this._spinner||(this._spinner=new t({className:"spinner spinner--centered"})),this._spinner.spin(this._loading)},_stopSpinner:function(){this._spinner&&this._spinner.stop()},_val:function(t,n){t=String(t),this.element.val(t);var i=String(this.element.val());if(i!==t){if(!this._customOption||this._customOption.closest("select").get(0)!==this.element.get(0)){var s=this.element.find('option[value="'+this.options.triggerValue+'"]'),o=e("<option class=modalized-select__custom-option></option>");this._customOption=o,s.before(this._customOption)}this._customOption.attr("value",t).text(n),this.element.val(t)}}})}),define("views/SelectModalView",["jquery","Backbone","widgets/selectModal"],function(e,t){"use strict";var n=t.View.extend({events:{selectmodalopen:"onModalOpened"},modalAlignment:"middle",template:null,url:null,$modal:null,initialize:function(){this.collection=new t.Collection,this.collection.url=this.url,this.listenTo(this.collection,"reset",this.renderModalContents)},onModalOpened:function(){this._fetchPromise?this.renderModalContents():(this.$modal=this.$el.data("tedSelectModal").modal,this._fetchPromise=this.collection.fetch({reset:!0}))},render:function(){this.$el.selectModal({modalAlignment:this.modalAlignment})},renderModalContents:function(){this.$el.selectModal("html",this.template(this.templateData()))},templateData:function(){return{collection:this.collection.toJSON()}},_fetchPromise:null});return n}),define("hbs!templates/topicSelect",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s,o;return'    <li class="topic-select__range '+(null!=(s=t["if"].call(e,null!=e?e.isActive:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+'">\n      <a class="topic-select__range__link" data-index="'+this.escapeExpression((o=null!=(o=t.index||i&&i.index)?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"index",hash:{},data:i}):o))+'" href="#">'+this.escapeExpression((o=null!=(o=t.label||(null!=e?e.label:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"label",hash:{},data:i}):o))+"</a>\n    </li>\n"},2:function(){return"topic-select__range--active"},4:function(e,t,n,i){var s;return'    <li class="topic-select__topic">\n      <a class="select-modal__link topic-select__topic__link" href="#" data-value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</a>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<ul class="sl topic-select__ranges">\n'+(null!=(s=t.each.call(e,null!=e?e.ranges:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'</ul>\n\n<ul class="sl topic-select__topics">\n'+(null!=(s=t.each.call(e,null!=(s=null!=e?e.active:e)?s.collection:s,{name:"each",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?s:"")+"</ul>\n"},useData:!0});return t.registerPartial("templates/topicSelect",n),n}),define("utils/alphaSplit",["lodash"],function(e){"use strict";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ#".split(""),n=e.map(t,function(e){return{index:e,collection:[]}}),i=e.indexOf(t,"#");return function(s,o,a){var r,l,u,c=e.cloneDeep(n);s=e.toArray(s),o=e.createCallback(o,a);for(var d=-1,p=s.length;++d<p;)r=o(s[d],d,s),l=r[0].toUpperCase(),u=e.indexOf(t,l),-1===u&&(u=i),c[u].collection.push(s[d]);return c}}),define("utils/spread",[],function(){"use strict";return function(e,t,n){n=n||{};var i,s,o,a=n.tolerance||0,r=n.callback||function(e){return+(e.length||e)},l=[],u=e.length;t=t||e.length;var c=0;for(i=-1;++i<u;)s=e[i],o=r(s),c+=o;var d=Math.floor(c/t)+a,p=[],h=0;for(i=-1;++i<u;)s=e[i],o=r(s),!h||d>=h+o?(h+=o,p.push(s)):(l.push(p),h=o,p=[s]);return l.push(p),l}}),define("views/TopicSelectView",["jquery","lodash","views/SelectModalView","hbs!templates/topicSelect","utils/alphaSplit","utils/spread"],function(e,t,n,i,s,o){"use strict";var a=n.extend({modalAlignment:"top",template:i,url:"/topics/combo?models=Talks",addModalEvents:function(){this.$modal.addClass("topic-select"),this.$modal.on("click","a.topic-select__range__link",t.bind(this.onChooseRange,this))},onChooseRange:function(t){t.preventDefault(),t.stopPropagation();var n=+e(t.target).data("index");this._activeRange=n,this.renderModalContents()},refreshRanges:function(){var e=this.collection.toJSON(),n=s(e,"label"),i=o(n,9,{callback:function(e){return e.collection.length},tolerance:10}),a=t.map(i,function(e){var n=e[0].index,i=e[e.length-1].index,s=n+"â€“"+i;return n===i&&(s=n),"#"===i&&(s=n+"â€“Z"),{label:s,collection:t.reduce(e,function(e,n){return t.union(e,n.collection)},[])}});this._ranges=a},templateData:function(){this._ranges||(this.addModalEvents(),this.refreshRanges());var e=t.cloneDeep(this._ranges),n=e[this._activeRange];return n.isActive=!0,{ranges:e,active:n}},_activeRange:0,_ranges:null});return a}),define("hbs!templates/languageSelect",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'    <li class="language-select__language">\n      <a class="select-modal__link language-select__language__link" href="#" data-value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</a>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<ul class="sl language-select__languages">\n'+(null!=(s=t.each.call(e,null!=e?e.languages:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"</ul>\n"},useData:!0});return t.registerPartial("templates/languageSelect",n),n}),define("views/LanguageSelectView",["jquery","lodash","views/SelectModalView","hbs!templates/languageSelect"],function(e,t,n,i){"use strict";var s=n.prototype,o=n.extend({template:i,url:"/languages/combo.json?per_page=1000",onModalOpened:function(){s.onModalOpened.call(this),this.$modal.addClass("language-select")},templateData:function(){return{languages:this.collection.toJSON()}}});return o}),define("hbs!templates/eventSelect",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s,o;return'      <option value="'+this.escapeExpression((o=null!=(o=t.year||(null!=e?e.year:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"year",hash:{},data:i}):o))+'" '+(null!=(s=t["if"].call(e,null!=e?e.isActive:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+">"+this.escapeExpression((o=null!=(o=t.year||(null!=e?e.year:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"year",hash:{},data:i}):o))+"</option>\n"},2:function(){return"selected"},4:function(e,t,n,i){var s;return'    <li class="event-select__event">\n      <a class="select-modal__link event-select__event__link" href="#" data-value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</a>\n    </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="event-select__years">\n  <label class="event-select__years__label">Event year:</label>\n  <select class="form-control form-control--dropdown event-select__years__input">\n'+(null!=(s=t.each.call(e,null!=e?e.years:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'  </select>\n</div>\n\n<ul class="sl event-select__events">\n'+(null!=(s=t.each.call(e,null!=e?e.events:e,{name:"each",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?s:"")+"</ul>\n"},useData:!0});return t.registerPartial("templates/eventSelect",n),n}),define("views/EventSelectView",["jquery","lodash","views/SelectModalView","hbs!templates/eventSelect"],function(e,t,n,i){"use strict";var s=n.prototype,o=n.extend({modalAlignment:"top",template:i,url:"/talks/events",addModalEvents:function(){this.$modal.addClass("event-select"),this.$modal.on("change","select.event-select__years__input",t.bind(this.onChooseYear,this))},onChooseYear:function(t){this._activeYear=e(t.target).val(),this.renderModalContents()
},onModalOpened:function(){s.onModalOpened.call(this)},templateData:function(){this._activeYear||this.addModalEvents();var e=t.keys(this.collection.groupBy(function(e){return e.get("year")})).reverse(),n=String(this._activeYear||e[0]);this._activeYear=n,e=t.map(e,function(e){return e=String(e),{year:e,isActive:e===n}});var i=t.map(this.collection.where({year:n}),function(e){return e.toJSON()});return{years:e,events:i,year:n}},_activeYear:!1});return o}),define("talks/browse",["jquery","lodash","Backbone","deferLink","lib/ga","models/Filters","views/FiltersView","views/ResultsView","views/TopicSelectView","views/LanguageSelectView","views/EventSelectView","exports"],function(e,t,n,i,s,o,a,r,l,u,c,d){"use strict";function p(e,t){return'<option value="'+e+'">'+t+"</option>"}function h(){y=new o,w=new a(t.extend({el:document.getElementById("filters"),model:y},b)),w.render();var e="talks-filters--expanded",n=w.$el.find("button.js-filters-more");n.on("click",function(t){t.preventDefault(),n.text(w.$el.toggleClass(e).hasClass(e)?"Less":"More")}),y.on("change:rating",m),t.forEach([{name:"topics",values:[]},{name:"event",values:[]},{name:"language",values:[]},{name:"rating",values:[]}],function(e){y.on("change:"+e.name,function(){var n=y.getValue(e.name);if(n){if(t.isArray(n)){var i=t.difference(n,e.values);if(e.values=n,!i.length)return;n=i.pop()}s.sendEvent("talk.browse","filter",e.name+": "+n)}})}),y.on("change:sort",function(e,t){t&&s.sendEvent("talk.browse","order",t)}),d.filtersModel=y,d.filtersView=w}function f(){var e=new r({el:document.getElementById("browse-results"),filtersModel:d.filtersModel});d.resultsView=e}function m(e,t){v.html((t&&t.value?p(t.value,t.label):"")+_),y.unset("sort")}var g,v,_,b,y,w;d.init=function(n){b=n;var o=e("#topics"),a=e("#languages"),r=e("#events"),d=new l({el:o});d.render();var m=new u({el:a});m.render();var y=new c({el:r});y.render(),_="",t.forIn(b.defaultSorts,function(e,t){_+=p(t,e)}),g=e("#filters-sort"),v=g.find("optgroup"),h(),f(),e("#browse-results").on("click","div.talk-link a",i(function(){return s.sendEvent("talk.browse","click","talk"),50}))}}),define("global/floodlight",["jquery","exports"],function(e,t){"use strict";t.close=function(){window.localStorage.setItem("floodlight","hide"),e("#floodlight").slideUp(240)},t.clear=function(){try{window.localStorage.removeItem("floodlight")}catch(e){}}}),define("global/links",["jquery","deferLink","lib/ga"],function(e,t,n){"use strict";function i(e){if(e.match(location.origin))return!1;for(var t=-1;++t<r;)if(e.match(a[t].re))return a[t]}function s(t,n,i){t=e.extend({},l,t);for(var s in t)t.hasOwnProperty(s)&&e.isFunction(t[s])&&(t[s]=t[s].call(n,i));return t}function o(e){var o=i(this.href);return o?(n.send(s(o,this,e)),t.call(this,e)):!0}var a=[{re:/^https?:\/\/(?:.*\.)tedprize\.(org|com)/,eventCategory:"link.outbound.tedPrize"},{re:/^https?:\/\/ed\.ted\.com/,eventCategory:"link.outbound.tedEd"},{re:/^https?:\/\/tedfellows\.posterous\.com/,eventCategory:"link.outbound.fellowsBlog"},{re:/^https?:\/\/(?:.*\.)universalsubtitles\.org/,eventCategory:"link.outbound.translatorDashboard"},{re:/^https?:\/\/(?:.*\.)feedburner\.com/,eventCategory:"link.outbound.feedburner"},{re:/^https?:\/\//}],r=a.length,l={hitType:"event",eventCategory:"link.outbound.other",eventAction:"click",eventLabel:function(){return this.href}};return{init:function(){e("body").on("click","a[href]",o)}}}),define("Mailcheck",["exports"],function(){var e={domainThreshold:2,secondLevelThreshold:2,topLevelThreshold:2,defaultDomains:["msn.com","bellsouth.net","telus.net","comcast.net","optusnet.com.au","earthlink.net","qq.com","sky.com","icloud.com","mac.com","sympatico.ca","googlemail.com","att.net","xtra.co.nz","web.de","cox.net","gmail.com","ymail.com","aim.com","rogers.com","verizon.net","rocketmail.com","google.com","optonline.net","sbcglobal.net","aol.com","me.com","btinternet.com","charter.net","shaw.ca"],defaultSecondLevelDomains:["yahoo","hotmail","mail","live","outlook","gmx"],defaultTopLevelDomains:["com","com.au","com.tw","ca","co.nz","co.uk","de","fr","it","ru","net","org","edu","gov","jp","nl","kr","se","eu","ie","co.il","us","at","be","dk","hk","es","gr","ch","no","cz","in","net","net.au","info","biz","mil","co.jp","sg","hu"],run:function(t){t.domains=t.domains||e.defaultDomains,t.secondLevelDomains=t.secondLevelDomains||e.defaultSecondLevelDomains,t.topLevelDomains=t.topLevelDomains||e.defaultTopLevelDomains,t.distanceFunction=t.distanceFunction||e.sift3Distance;var n=function(e){return e},i=t.suggested||n,s=t.empty||n,o=e.suggest(e.encodeEmail(t.email),t.domains,t.secondLevelDomains,t.topLevelDomains,t.distanceFunction);return o?i(o):s()},suggest:function(e,t,n,i,s){e=e.toLowerCase();var o=this.splitEmail(e);if(n&&i&&-1!==n.indexOf(o.secondLevelDomain)&&-1!==i.indexOf(o.topLevelDomain))return!1;var a=this.findClosestDomain(o.domain,t,s,this.domainThreshold);if(a)return a==o.domain?!1:{address:o.address,domain:a,full:o.address+"@"+a};var r=this.findClosestDomain(o.secondLevelDomain,n,s,this.secondLevelThreshold),l=this.findClosestDomain(o.topLevelDomain,i,s,this.topLevelThreshold);if(o.domain){var a=o.domain,u=!1;if(r&&r!=o.secondLevelDomain&&(a=a.replace(o.secondLevelDomain,r),u=!0),l&&l!=o.topLevelDomain&&(a=a.replace(o.topLevelDomain,l),u=!0),1==u)return{address:o.address,domain:a,full:o.address+"@"+a}}return!1},findClosestDomain:function(e,t,n,i){i=i||this.topLevelThreshold;var s,o=99,a=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var r=0;r<t.length;r++){if(e===t[r])return e;s=n(e,t[r]),o>s&&(o=s,a=t[r])}return i>=o&&null!==a?a:!1},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,i=0,s=0,o=0,a=5;n+i<e.length&&n+s<t.length;){if(e.charAt(n+i)==t.charAt(n+s))o++;else{i=0,s=0;for(var r=0;a>r;r++){if(n+r<e.length&&e.charAt(n+r)==t.charAt(n)){i=r;break}if(n+r<t.length&&e.charAt(n)==t.charAt(n+r)){s=r;break}}}n++}return(e.length+t.length)/2-o},splitEmail:function(e){var t=e.trim().split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var i=t.pop(),s=i.split("."),o="",a="";if(0==s.length)return!1;if(1==s.length)a=s[0];else{o=s[0];for(var n=1;n<s.length;n++)a+=s[n]+".";a=a.substring(0,a.length-1)}return{topLevelDomain:a,secondLevelDomain:o,domain:i,address:t.join("@")}},encodeEmail:function(e){var t=encodeURI(e);return t=t.replace("%20"," ").replace("%25","%").replace("%5E","^").replace("%60","`").replace("%7B","{").replace("%7C","|").replace("%7D","}")}};return"undefined"!=typeof module&&module.exports&&(module.exports=e),"function"==typeof define&&define.amd&&define("mailcheck",[],function(){return e}),"undefined"!=typeof window&&window.jQuery&&!function(t){t.fn.mailcheck=function(t){var n=this;if(t.suggested){var i=t.suggested;t.suggested=function(e){i(n,e)}}if(t.empty){var s=t.empty;t.empty=function(){s.call(null,n)}}t.email=this.val(),e.run(t)}}(jQuery),e}),define("lib/newsletter",["jquery","Mailcheck"],function(e,t){"use strict";function n(t){var n=[];return t.isDaily&&n.push("daily"),t.isWeekly&&n.push("weekly"),t.isFellows&&n.push("fellows"),e.getJSON("//www.ted.com/newsletter/signup.json?callback=?",{newsletterSignup:{email_address:t.email,subscription_list:n}})}function i(t){function i(e){"error"===e.status?l.rejectWith(t,[["uncaught"]]):l.resolveWith(t)}function o(){l.rejectWith(t,[["server"]])}function a(){n(t).then(i,o)}function r(e){l.rejectWith(this,[e])}var l=new e.Deferred;return s(t).then(a,r),l}function s(n){var i=[],s=new e.Deferred;return""===n.email&&i.push("blankemail"),(""+n.email).match(/.+@.+/)||i.push("email"),n.isDaily||n.isWeekly||n.isFellows||i.push("subscription"),t.run({email:n.email,suggested:function(e){if(i.push({type:"suggestion",data:e.full}),1===i.length){var s=n.email.match(/@(.+$)/)[1];t.defaultDomains.push(s)}}}),i.length?s.rejectWith(n,[i]):s.resolveWith(n),s.promise()}return{ajax:n,subscribe:i,validate:s}}),define("global/subscribe",["jquery","lodash","lib/newsletter","lib/ga"],function(e,t,n,i){"use strict";function s(e){m(),i.sendEvent("newsletter","submit","footer"),r={email:d.val(),isDaily:u.is(":checked"),isWeekly:c.is(":checked")},n.subscribe(r).then(o,a),e.preventDefault()}function o(){i.sendEvent("newsletter","success",t.filter([r.isDaily?"daily":!1,r.isWeekly?"weekly":!1]).join(",")),e(h+"-details").slideUp(f),e(h+"-success").slideDown(f)}function a(t){var n,i,s,o=t[0];if(p.slideUp(f),"object"==typeof o?(n=o.type,i=o.data):n=o,s=e(h+"-error-"+n),s.slideDown(f),i){var a=s.find(".newsletter-signup-error__data");a.text(i),a.click(function(e){e.preventDefault(),d.val(i),p.slideUp(f)})}}var r,l,u,c,d,p,h="#newsletter-signup",f="fast",m=t.once(function(){u=e(h+"-daily"),c=e(h+"-weekly"),d=e(h+"-email"),p=l.find("p.footer-newsletter__error")});return{init:function(){l=e(h),l.on("submit",s)}}}),define("hbs!templates/latcherFixture",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'\n<div class="latcher">\n  <a class="latcher__back" href="#">Main</a>\n</div>\n'},useData:!0});return t.registerPartial("templates/latcherFixture",n),n}),define("global/navs",["jquery","lib/ga","lib/pubSub","spinjs","hbs!templates/latcherFixture","lib/resize"],function(e,t,n,i,s){"use strict";function o(){return l||(l=new i({className:"spinner spinner--centered"})),l}function a(t,n){var i=t.data("url");n.drillDown("findNext",i,function(t){if(t)t.element.drillDown("show");else{var a=e(s());o().spin(a.get(0)),a.find("a.latcher__back").on("click",function(){n.drillDown("show")}),n.drillDown("queue",a,{id:i}),a.drillDown("show"),e.ajax({url:i,xhrFields:{withCredentials:!0}}).done(function(t){o().stop(),a.append(e(t).find("#submenu").addClass("submenu--fixture").find("a.submenu__heading__link[href=#]").closest("h3").remove().end().end().find("li."+h).removeClass(h).end())})}})}function r(i){var s=n("breakpoint").read()>=1024,o=e(this),r=o.closest("li.nav__item"),l=r.siblings(),u=r.closest("div.shoji__fixture"),h=r.closest("div.drillDown"),f=r.children(d),m=r.hasClass(p),g=o.data("ga-label");if(!r.hasClass("nav__item--disabled")){if(r[s?"addClass":"toggleClass"](p),l.not(c).removeClass(p),!f.length)return void(h.length&&r.hasClass("nav__item--latch")&&(i.preventDefault(),a(o,h)));!m&&g&&r.hasClass(p)&&t.sendEvent("navigation.menu","open",g),(u.length||!s)&&(l.filter(c).removeClass(p).children(d).stop(!0,!0).animate({height:"hide"},200),f.stop(!0,!0).animate({height:"toggle"},200),i.preventDefault())}}var l,u={},c="li.nav__item--foldable",d="div.nav__folder",p="nav__item--active",h="submenu__item--active";return u.init=function(){e(document).on("click","a.nav__link",r)},u}),define("lib/shoji",["jquery","lodash","Modernizr","lib/pubSub","utils/throwError","lib/resize"],function(e,t,n,i,s){"use strict";function o(t){var n=e(t);return n.hasClass(f)||(n=n.closest("div."+f)),n.length||s("Could not find fixture "+t),n}function a(n,i){var s=e("<div class="+f+">"),o={};return t.defaults(o,i,{at:"left"}),_(),s.addClass(f+"--"+o.at),s.data("at",o.at),s.append(n),s.appendTo(p),s}function r(){return _(),n.csstransforms3d&&h>=320}function l(){_(),e(document.activeElement).blur(),d.removeClass(m+" "+g)}function u(e){var t=o(e);_(),p.children().removeClass(v),t.addClass(v),c(t.data("at"))}function c(e){l(),d.addClass("shoji--opened shoji--"+e)}var d,p,h,f="shoji__fixture",m="shoji--left",g="shoji--right",v=f+"--revealed",_=t.once(function(){d=e("#shoji"),p=e("#shoji-fixtures"),e("#shoji-lattice").on("click",function(){return l(),!1}),i("breakpoint").subscribe(function(e){h=e})});return{_getFixture:o,_init:_,addFixture:a,canSlide:r,concealFixture:l,revealFixture:u,slide:c}}),define("widgets/fixture",["jquery","lodash","lib/shoji","jqueryui/widget"],function(e,t,n){"use strict";var i,s=t.once(function(){i=e("body,html")});return e.widget("ted.fixture",{options:{at:"left",autoReveal:!0,scrollAnimationDuration:200},_create:function(){s(),this.fixture=n.addFixture(this.element.remove(),{at:this.options.at}),this.options.autoReveal&&this.reveal()},reveal:function(){this.options.scrollAnimationDuration&&i.scrollTop()&&i.animate({scrollTop:0},this.options.scrollAnimationDuration),n.revealFixture(this.fixture)},conceal:function(){n.concealFixture()}}),function(t,n){return e(t).fixture(n)}}),define("widgets/drillDown",["jquery","lodash","jqueryui/widget"],function(e,t){"use strict";e.widget("ted.drillDown",{options:{id:null,prev:null,next:null,tense:null},_create:function(){var e=this.options,t=e.prev;e.next||(e.next=[]);var n=e.next.length,i=e.tense;i||(i="present",t&&(i="future"),n&&(i="past")),this.element.addClass("drillDown drillDown--"+i),t?e.prev.after(this.element):n&&e.next[0].element.before(this.element)},next:function(e){return e&&(this.options.next=e),this.options.next},prev:function(e,t){return arguments.length?this.options.prev=this._drify(e,{next:this.element},t):this.options.prev},queue:function(e,t){this.options.next.push(this._drify(e,{prev:this.element},t))},show:function(){var e=this.options;if(e.prev&&e.prev.addClass("drillDown--past"),this._nextEls().addClass("drillDown--future"),this._dShow)this._dShow();else{var n=this.element;this._dShow=function(){n.removeClass("drillDown--past drillDown--future")},t.defer(this._dShow)}},findNext:function(e,t){for(var n,i=this.options.next,s=i.length;s--&&!n;)i[s].options.id===e&&(n=i[s]);return t&&t.call(n,n),n},_drify:function(t,n,i){var s=e(t),o=this.widgetFullName;return s.data(o)||s.drillDown(e.extend(n,i||{})).data(o)},_nextEls:function(){for(var t=e(),n=this.options.next,i=n.length;i--;)t=t.add(n[i].element);return t}})}),define("menuAim",["jquery"],function(e){"use strict";function t(t){var n,i=e(this),s=null,o=[],a=null,r=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t),l=3,u=300,c=200,d=function(e){o.push({x:e.pageX,y:e.pageY}),o.length>l&&o.shift()},p=function(){a&&clearTimeout(a),r.exitMenu(this)&&(s&&r.deactivate(s),s=null)},h=function(){a&&clearTimeout(a),r.enter(this),v(this)},f=function(){r.exit(this)},m=function(){g(this)},g=function(e){e!==s&&(s&&r.deactivate(s),r.activate(e),s=e)},v=function(e){var t=_();null===t?a=setTimeout(function(){g(e)},c):t?a=setTimeout(function(){v(e)},t):g(e)},_=function(){function t(e,t){return(t.y-e.y)/(t.x-e.x)}if(!s||!e(s).is(r.submenuSelector))return null;var a=i.offset(),l={x:a.left,y:a.top-r.tolerance},c={x:a.left+i.outerWidth(),y:l.y},d={x:a.left,y:a.top+i.outerHeight()+r.tolerance},p={x:a.left+i.outerWidth(),y:d.y},h=o[o.length-1],f=o[0];if(!h)return 0;if(f||(f=h),f.x<a.left||f.x>p.x||f.y<a.top||f.y>p.y)return 0;if(n&&h.x===n.x&&h.y===n.y)return 0;var m=c,g=p;"left"===r.submenuDirection?(m=d,g=l):"below"===r.submenuDirection?(m=p,g=d):"above"===r.submenuDirection&&(m=l,g=c);var v=t(h,m),_=t(h,g),b=t(f,m),y=t(f,g);return b>v&&_>y?(n=h,u):(n=null,0)};i.mouseleave(p).find(r.rowSelector).mouseenter(h).mouseleave(f).on("touchend",function(t){s&&e(s).is(r.submenuSelector)||(t.preventDefault(),m.apply(this,Array.prototype.slice.call(arguments,0)))}).click(m),e(document).mousemove(d)}return e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this},e}),define("global/mainNav",["jquery","lodash","lib/shoji","lib/pubSub","lib/ga","hbs!templates/latcherFixture","lib/resize","widgets/fixture","widgets/drillDown","menuAim"],function(e,t,n,i,s,o){"use strict";function a(t){if(t.preventDefault(),n.canSlide())if(u)u.fixture("reveal");else{u=e("#banner-core").clone(),u.find("nav.nav--main").removeClass("nav--main"),u.add("*[id]",u).removeAttr("id"),u.find("li.nav__item--latch a").attr("href",function(){var t=e(this),n=t.attr("href");return t.attr("data-url",n),"#"}),u.show(),u.fixture();var i=e("div.shoji__fixture--left #submenu");if(u.drillDown({tense:i.length?"past":"present"}),!i.length)return;var s=e(o()).append(i.clone().addClass("submenu--fixture"));s.find("a.latcher__back").on("click",function(){u.drillDown("show")}),u.drillDown("queue",s,{tense:"present"})}else e("#main-nav").toggleClass("nav--main--open")}function r(t){1024>t||(i("breakpoint").unsubscribe(r),e("#main-nav").find("ul:first > li > a").each(function(){var t=e(this);e('<span class="nav__link nav__link--placeholder" aria-hidden></span>').text(t.text()).insertAfter(t),t.addClass("nav__link--placeheld")}))}function l(){function n(){l=!0,f.trigger("mouseleave")}function o(){return p.read()>=1024}function a(i){1024>i||(p.unsubscribe(a),f.menuAim({activate:function(t){var n=e(t),i=n.find("a.nav__link"),a=i.data("ga-label");return o()?(a&&!n.hasClass(u)&&s.sendEvent("navigation.menu","open",a),n.addClass(u).removeClass(c),void m.addClass(d)):!1},deactivate:function(t){return o()?(e(t).removeClass(u).removeClass(c),void m.removeClass(d)):!1},exitMenu:function(i){return o()?l?(l=!1,!0):(e(i).find("li."+u).addClass(c),r=t.delay(n,h),!1):!1},enter:function(t){return o()?(e(t).removeClass(c),clearTimeout(r),void(r=null)):!1},submenuDirection:"below"}),m.on("click",n))}var r,l,u="nav__item--active",c="nav__item--deactivating",d="main-nav-screen--active",p=i("breakpoint"),h=250,f=e(this).children("ul"),m=e("#main-nav-screen");i("breakpoint").subscribe(a)}var u,c={};return c.init=function(){i("breakpoint").subscribe(r),e("#main-nav-toggle").on("click",a),e("nav.nav--main").each(l)},c}),define("hbs!templates/login",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div class="login-form">\n  <form class="form-vertical" action="https://auth.ted.com/session" method="post">\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Email:",{name:"t",hash:{},data:i}))+'</span>\n      <input class="form-control" name="user[email]" type="email">\n    </label>\n\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Password:",{name:"t",hash:{},data:i}))+'</span>\n      <input class="form-control" name="user[password]" type="password">\n    </label>\n\n    <div class="form-group">\n      <input class="button button--dark button--wide" type="submit" value="Log in">\n\n      <div>\n        <a class="l3" href="https://auth.ted.com/account/password/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Need help logging in?",{name:"t",hash:{},data:i}))+'</a>\n      </div>\n    </div>\n  </form>\n\n  <div class="login-form__or"></div>\n\n  <div>\n    <a class="button button--wide button--dark button--facebook" href="/users/new?facebook=true">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log in with Facebook",{name:"t",hash:{},data:i}))+"</a>\n  </div>\n\n  <div>\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Don't have a TED account?",{name:"t",hash:{},data:i}))+'\n    <a class="l3" href="/users/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Sign up",{name:"t",hash:{},data:i}))+"</a>\n  </div>\n</div>\n"},useData:!0});return t.registerPartial("templates/login",n),n}),define("widgets/tooltip",["jquery","lodash","jqueryui/widget","widgets/popup"],function(e){"use strict";var t;return e.widget("ted.tooltip",{options:{content:"",interactive:!1,interactiveTolerance:350,position:{},openDelay:0,supportTouch:!0,allowClick:!1},_create:function(){var n;t||(t=e(document.body)),this.element.addClass("tooltip"),this.options.position.of=this.element,this.popupObject=e("<div class=tooltip__popup>").append(this.options.content).popup(this.options).insertAfter(this.element),n=this.element,this.options.interactive&&(n=n.add(this.popupObject)),this._on(n,this._handleEvents),this._on(e("#shoji"),{click:function(t){!this._isOpened||this.options.interactive&&e(t.target).closest(this.popupObject).length||(this._isOpened=!1,this.popupObject.popup("close"))}})},_isHoverClickEnabled:!1,_isFirstTouch:!1,_isTouched:!1,_isMousedOver:!1,_handleEvents:{touchstart:function(){this._isTouched=!0,this._isHoverClickEnabled||(this._isFirstTouch=!0)},mouseover:function(e){var t=this,n=t.options.openDelay||0;(this.options.supportTouch||!this._isTouched)&&(this._isMousedOver=!0,this._isOpened&&(n=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._isMousedOver&&t.openPopup(e)},n))},mouseout:function(e){var t=this,n=this.options.interactiveTolerance||0;this._isMousedOver=!1,this._isOpened||(n=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._isMousedOver||t.closePopup(e)},n)},click:function(t){e(t.target).closest(this.element).length&&((this.options.supportTouch||!this._isTouched)&&(this.openPopup(t),!this._isFirstTouch&&this._isHoverClickEnabled&&this._trigger("hoverclick",t),this._isFirstTouch=!1),this.options.allowClick||(t.preventDefault(),t.stopPropagation()))},popupopen:function(){this._isHoverClickEnabled=!0},popupclose:function(){this._isHoverClickEnabled=!1}},_setOption:function(e,t){"content"===e&&this.popupObject.html(t)},openPopup:function(e){this._isOpened=!0,this.popupObject.popup("open",e)},closePopup:function(e){this.popupObject.popup("close",e),this._off(t,"click"),this._isOpened=!1},popup:function(){return this.popupObject}}),function(t,n){return e(t).tooltip(n)}}),define("global/login",["jquery","lib/shoji","lib/pubSub","hbs!templates/login","lib/resize","widgets/fixture","widgets/tooltip"],function(e,t,n,i){"use strict";function s(s){var o=n("breakpoint").read()>=1024;if(u&&!o&&t.canSlide())return s.preventDefault(),r?void r.fixture("reveal"):void(r=e(i()).fixture({at:"right"}))}function o(e){1024>e||u&&(n("breakpoint").unsubscribe(o),a.tooltip({content:i(),interactive:!0,position:{my:"right bottom-20",at:"right top",of:window,collision:"fit flip"},beforeOpen:function(){return n("breakpoint").read()>=1024}}))}var a,r,l={},u=!1;return l.init=function(){a=e("#login-link"),a.on("click",s),n("breakpoint").subscribe(o)},l}),function(e){"use strict";var t=function(e,n,i){return 1===arguments.length?t.get(e):t.set(e,n,i)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(n,i,s){return s=t._getExtendedOptions(s),s.expires=t._getExpiresDate(i===e?-1:s.expires),t._document.cookie=t._generateCookieString(n,i,s),t},t.expire=function(n,i){return t.set(n,e,i)},t._getExtendedOptions=function(n){return{path:n&&n.path||t.defaults.path,domain:n&&n.domain||t.defaults.domain,expires:n&&n.expires||t.defaults.expires,secure:n&&n.secure!==e?n.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=encodeURIComponent(e),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var i=e+"="+t;return i+=n.path?";path="+n.path:"",i+=n.domain?";domain="+n.domain:"",i+=n.expires?";expires="+n.expires.toGMTString():"",i+=n.secure?";secure":""},t._getCookieObjectFromString=function(n){for(var i={},s=n?n.split("; "):[],o=0;o<s.length;o++){var a=t._getKeyValuePairFromCookieString(s[o]);i[a.key]===e&&(i[a.key]=a.value)}return i},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=0>t?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof define&&define.amd?define("Cookies",[],function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}(),define("lib/currentUserId",["Cookies"],function(e){"use strict";var t="_ted_user_id";return{get:function(){return e.get(t)}}}),define("lib/personalStorage",["lodash","Modernizr","exports","lib/currentUserId"],function(e,t,n,i){"use strict";function s(t,i){var s=e.toArray(arguments);return n.storageAdapter?(s[1]=n.getKey(i),t.apply(n.storageAdapter,s.slice(1))):!1}n.storageAdapter=t.localstorage?window.localStorage:void 0,n.getKey=function(e){var t=i.get();return t||(t="0"),t+"-"+e},n.getItem=e.wrap(function(e){return n.storageAdapter.getItem(e)},s),n.setItem=e.wrap(function(e,t){n.storageAdapter.setItem(e,t)},s),n.removeItem=e.wrap(function(e){n.storageAdapter.removeItem(e)},s)}),define("lib/currentUser",["jquery","lodash","lib/currentUserId","lib/personalStorage"],function(e,t,n,i){"use strict";function s(e){return t.isFinite(e)?+e:null}function o(e){return e?""+e:null}function a(e){return e=t.pick(e,S),t.forOwn(e,function(t,n){e[n]=C[n](t)}),e}function r(e){return e&&JSON.parse(e)}function l(){return a(r(w.storageAdapter.getItem(k)))}function u(){return e.ajax({dataType:"json",url:"/me",data:{c:n.get()+"-"+Math.round(+new Date/1e3/120)},timeout:3e3})}function c(e){u().then(t.bind(d,w,e),t.bind(p,w,e))}function d(e,t){if(!t)return void p(e,t);if(t.unavailable&&t.unavailable.length)for(var n=l(),i=t.unavailable,s=i.length;s--;)t[i[s]]=n[i[s]]||t[i[s]];t.lastDownloaded=(new Date).getTime(),v=a(t),g(e)&&w.storageAdapter.setItem(k,JSON.stringify(v))}function p(e){h(),e.reject()}function h(){v=null,w.storageAdapter.removeItem(k),e(document.documentElement).removeClass("loggedin").addClass("loggedout")}function f(e,t){var n=(new Date).getTime();return e>n-(t||0)}function m(){return w._check(v)}function g(e){var t=m();return t?e.resolve(v):(h(),e.reject()),t}var v,_=function(e){return!!e},b=function(e){return e},y=e.Deferred,w={},k="me",x=!0,C={id:s,profileId:s,firstName:o,lastName:o,avatarUrl:o,hasConferences:_,upcomingConferences:b,isCommentModerator:_,hasEdActivity:_,isTEDxOrganizer:_,lastDownloaded:s},S=t.keys(C);return w.storageAdapter=i,w.getDetails=function(){var e=new y;return v=v||l(),m()||(v=null),v?(e.resolve(v),x&&!f(18e4,v.lastDownloaded)&&(x=!1,c(new y))):n.get()?c(e):e.reject(),e.promise()},w._check=function(e){var i=864e5;return e&&+e.id===+n.get()&&S.length===t.keys(t.pick(e,S)).length&&f(i,e.lastDownloaded)},w._reset=function(){v=void 0,x=!0},w}),define("lib/watchLaterLocal",["exports","jquery","lodash","Modernizr","lib/currentUserId","lib/personalStorage"],function(e,t,n,i,s,o){"use strict";function a(e){return+e.split("|",1).pop()}function r(e){return(e.match(/(\|\d+)+/)||"|")[0]+"|"}function l(t){var n=new u,i=n.promise(),s=e._checkCapability();return s!==!0?(n.reject(s),i):(t.apply(n,Array.prototype.splice.call(arguments,1)),i)}var u=t.Deferred,c="wl",d=null,p=18e4,h=null;e.addPlaylist=function(t){return e._add("playlists",t)},e.addTalk=function(t){return e._add("talks",t)},e.checkPlaylist=function(t){return e._check("playlists",t)},e.checkTalk=function(t){return e._check("talks",t)},e.count=n.wrap(function(){var t=this;e._getCache().then(function(e){t.resolve({total:e.talksCount+e.playlistsCount,talks:e.talksCount,playlists:e.playlistsCount})},function(e){t.reject(e)})},l),e.removePlaylist=function(t){return e._remove("playlists",t)},e.removeTalk=function(t){return e._remove("talks",t)},e.sync=n.wrap(function(){if(h)return h;var i=this;return h=i.promise(),t.get("/saved_items/sync.txt").then(function(t){return t=+new Date+";"+t,(d=e._fromS(t))?(o.setItem(c,t),void i.resolve(d)):void i.reject(new Error("Invalid response"))},function(){i.reject(new Error("Rejected by server"))}).always(n.delay(function(){h=null},p)),h},l),e._add=n.wrap(function(t,n){var i=this;e._check(t,n).then(function(s){s||(d[t+"List"]+=n+"|",d[t+"Count"]++,o.setItem(c,e._toS(d))),i.resolve(d)},function(e){i.reject(e)})},l),e._check=n.wrap(function(t,n){var i=this;e._getCache().then(function(e){i.resolve(-1!==e[t+"List"].indexOf("|"+n+"|"))},function(e){i.reject(e)})},l),e._checkCapability=function(){return i.localstorage?s.get()?!0:new Error("Not logged in"):new Error("No localStorage")},e._getCache=function(){var t=new u,n=t.promise();return d?(t.resolve(d),n):(d=e._fromS(o.getItem(c)),d?(t.resolve(d),+new Date-+d.lastSync>p&&e.sync()):e.sync().then(function(){t.resolve(d)},function(e){t.reject(e)}),n)},e._remove=n.wrap(function(t,n){var i=this;e._check(t,n).then(function(s){s&&(d[t+"List"]=d[t+"List"].replace("|"+n+"|","|"),d[t+"Count"]--,o.setItem(c,e._toS(d))),i.resolve(d)},function(e){i.reject(e)})},l),e._reset=function(){d=null,h=null},e._fromS=function(e){if(!e)return null;if(!e.match(/^\d+;\d+(\|\d+)*;\d+(\|\d+)*$/))return null;var t=e.split(";");return{lastSync:+t[0],talksCount:a(t[1]),talksList:r(t[1]),playlistsCount:a(t[2]),playlistsList:r(t[2])}},e._toS=function(e){return e?[e.lastSync,e.talksCount+e.talksList.slice(0,-1),e.playlistsCount+e.playlistsList.slice(0,-1)].join(";"):null}}),define("utils/monogram",["jquery"],function(e){"use strict";return function(t){return(t=e.trim(t))?(t=t.split(",")[0],t=t.replace(/\s[a-z]\w+\s/g," "),t=t.replace(/\s\w+\.$/,""),t=t.replace(/\s[A-Z]+$/,""),t=t.replace(/[^\s\w]+([\w])/g,"$1"),t=e.trim(t).toUpperCase().split(/\s+/),t[0][0]+(t.length>1?t[t.length-1][0]:"")):""}}),define("hbs!templates/accountFixture",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return null!=(s=t["if"].call(e,null!=e?e.items:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.program(10,i,0),data:i}))?s:""},2:function(e,t,n,i){var s,o;return'          <li class="nav__item nav__item--foldable '+(null!=(s=t["if"].call(e,null!=e?e.open:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+'">\n            <a class="nav__link" href="#">'+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"name",hash:{},data:i}):o))+'</a>\n            <div class="nav__folder" '+(null!=(s=t["if"].call(e,null!=e?e.open:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+'>\n              <ul class="nav__menu">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?s:"")+"              </ul>\n            </div>\n          </li>\n"},3:function(){return"nav__item--active"},5:function(){return'style="display:block"'},7:function(e,t,n,i){var s,o;return'                  <li class="nav__item">\n                    <a class="nav__link" href="'+this.escapeExpression((o=null!=(o=t.url||(null!=e?e.url:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"url",hash:{},data:i}):o))+'" '+(null!=(s=t["if"].call(e,null!=e?e.external:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+">"+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"name",hash:{},data:i}):o))+"</a>\n                  </li>\n"},8:function(){return'target="_blank"'},10:function(e,t,n,i){var s,o;return'          <li class="nav__item '+(null!=(s=t["if"].call(e,null!=e?e.latch:e,{name:"if",hash:{},fn:this.program(11,i,0),inverse:this.noop,data:i}))?s:"")+'">\n            <a class="nav__link" href="'+this.escapeExpression((o=null!=(o=t.url||(null!=e?e.url:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"url",hash:{},data:i}):o))+'" '+(null!=(s=t["if"].call(e,null!=e?e.external:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+">"+this.escapeExpression((o=null!=(o=t.name||(null!=e?e.name:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"name",hash:{},data:i}):o))+"</a>\n          </li>\n"},11:function(){return"nav__item--latch"
},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="account__fixture">\n  <div class="account__fixture__welcome">\n    <h2 class="h6">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Hi ",{name:"t",hash:{},data:i}))+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.firstName:s,e))+",</h2>\n    <div>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This is your stuff.",{name:"t",hash:{},data:i}))+'</div>\n  </div>\n\n  <nav class="nav">\n    <ul class="nav__menu">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"    </ul>\n  </nav>\n</div>\n"},useData:!0});return t.registerPartial("templates/accountFixture",n),n}),define("hbs!templates/accountPoparoo",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(){return"account__poparoo__later--populated"},3:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="/profiles/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.profileId:s,e))+'/tedx-event-management">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"TEDx Events",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},5:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.conferences:s,e))+'">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Conferences",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},7:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.tedEdHistory:s,e))+'" target="_blank">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Your activity on TED-Ed",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,o;return'\n<div class="account__poparoo">\n  <h2>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Hi ",{name:"t",hash:{},data:i}))+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.firstName:s,e))+",</h2>\n  <div>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This is your stuff.",{name:"t",hash:{},data:i}))+'</div>\n\n  <ul class="account__poparoo__menu">\n    <li class="account__poparoo__item" id="account-talks">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedTalks:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Saved talks",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(s=t["if"].call(e,null!=e?e.savedTalksCount:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedTalks:s,e))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((o=null!=(o=t.savedTalksCount||(null!=e?e.savedTalksCount:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"savedTalksCount",hash:{},data:i}):o))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item" id="account-playlists">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedPlaylists:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Saved playlists",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(s=t["if"].call(e,null!=e?e.savedPlaylistsCount:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedPlaylists:s,e))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((o=null!=(o=t.savedPlaylistsCount||(null!=e?e.savedPlaylistsCount:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"savedPlaylistsCount",hash:{},data:i}):o))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.favoriteTalks:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Favorite talks",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.favoritePlaylists:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Favorite playlists",{name:"t",hash:{},data:i}))+"\n      </a>\n    </li>\n\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.isTEDxOrganizer:s,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.hasConferences:s,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.hasEdActivity:s,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?s:"")+'\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.settings:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Settings",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.profile:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Your profile",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n  </ul>\n\n  <a class="account__poparoo__leave" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.logOut:s,e))+'">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log out",{name:"t",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0});return t.registerPartial("templates/accountPoparoo",n),n}),define("transit",["jquery"],function(e){return function(e){function t(e){if(e in d.style)return e;var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1);if(e in d.style)return e;for(var i=0;i<t.length;++i){var s=t[i]+n;if(s in d.style)return s}}function n(){return d.style[p.transform]="",d.style[p.transform]="rotateY(90deg)",""!==d.style[p.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function s(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function o(t){var n=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),-1===e.inArray(t,n)&&n.push(t)}),n}function a(t,n,i,s){var a=o(t);e.cssEase[i]&&(i=e.cssEase[i]);var r=""+c(n)+" "+i;parseInt(s,10)>0&&(r+=" "+c(s));var l=[];return e.each(a,function(e,t){l.push(t+" "+r)}),l.join(", ")}function r(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=p.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var s=e(n).css("transit:transform");s.setFromString(t,i),e(n).css({"transit:transform":s})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function u(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function c(t){var n=t;return e.fx.speeds[n]&&(n=e.fx.speeds[n]),u(n,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var d=document.createElement("div"),p={},h=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;p.transition=t("transition"),p.transitionDelay=t("transitionDelay"),p.transform=t("transform"),p.transformOrigin=t("transformOrigin"),p.transform3d=n();var f={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},m=p.transitionEnd=f[p.transition]||null;for(var g in p)p.hasOwnProperty(g)&&"undefined"==typeof e.support[g]&&(e.support[g]=p[g]);d=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var s=n;s instanceof i||(s=new i(s)),t.style[p.transform]="WebkitTransform"!==p.transform||h?s.toString():s.toString(!0),e(t).data("transform",s)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[p.transformOrigin]},set:function(e,t){e.style[p.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[p.transition]},set:function(e,t){e.style[p.transition]=t}}),r("scale"),r("translate"),r("rotate"),r("rotateX"),r("rotateY"),r("rotate3d"),r("perspective"),r("skewX"),r("skewY"),r("x",!0),r("y",!0),i.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=u(e,"deg")},rotateX:function(e){this.rotateX=u(e,"deg")},rotateY:function(e){this.rotateY=u(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=u(e,"deg")},skewY:function(e){this.skewY=u(e,"deg")},perspective:function(e){this.perspective=u(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=u(e,"px")),null!==t&&void 0!==t&&(this._translateY=u(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=u(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!p.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&t.push(e&&"scale"===n?n+"3d("+this[n]+",1)":e&&"translate"===n?n+"3d("+this[n]+",0)":n+"("+this[n]+")")}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,o){var r=this,l=0,u=!0;"function"==typeof n&&(o=n,n=void 0),"function"==typeof i&&(o=i,i=void 0),"undefined"!=typeof t.easing&&(i=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(n=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(o=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(u=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=c(n);var d=a(t,n,i,l),h=e.transit.enabled&&p.transition,f=h?parseInt(n,10)+parseInt(l,10):0;if(0===f){var g=function(e){r.css(t),o&&o.apply(r),e&&e()};return s(r,u,g),r}var v={},_=function(n){var i=!1,s=function(){i&&r.unbind(m,s),f>0&&r.each(function(){this.style[p.transition]=v[this]||null}),"function"==typeof o&&o.apply(r),"function"==typeof n&&n()};f>0&&m&&e.transit.useTransitionEnd?(i=!0,r.bind(m,s)):window.setTimeout(s,f),r.each(function(){f>0&&(this.style[p.transition]=d),e(this).css(t)})},b=function(e){var t=0;"MozTransition"===p.transition&&25>t&&(t=25),window.setTimeout(function(){_(e)},t)};return s(r,u,b),this},e.transit.getTransitionValue=a}(e),e}),define("plugins/addClassFor",["jquery"],function(e){"use strict";e.fn.extend({addClassFor:function(e,t){var n=this;return window.setTimeout(function(){n.removeClass(e)},t),n.addClass(e)}})}),define("global/account",["jquery","lodash","lib/shoji","lib/pubSub","lib/currentUser","lib/personalStorage","lib/watchLaterLocal","utils/monogram","hbs!templates/accountFixture","hbs!templates/accountPoparoo","hbs!templates/latcherFixture","lib/resize","transit","widgets/fixture","plugins/addClassFor"],function(e,t,n,i,s,o,a,r,l,u,c){"use strict";function d(t){var s=i("breakpoint").read()>=1024;if(n.canSlide()&&(t.preventDefault(),!s)){if(b)return void b.fixture("reveal");b=e(l({items:S(w),user:w})).fixture({at:"right"}),b.find("li.nav__item--latch a").attr("href",function(){var t=e(this),n=t.attr("href");return t.attr("data-url",n),"#"});var o=e("div.shoji__fixture--right #submenu");if(b.drillDown({tense:o.length?"past":"present"}),o.length){o.find("h3.submenu__heading").remove();var a=e(c()).append(o.clone().addClass("submenu--fixture"));a.find("a.latcher__back").on("click",function(){b.drillDown("show")}),b.drillDown("queue",a,{tense:"present"})}}}function p(e){if(!(1024>e)){i("breakpoint").unsubscribe(p);var t=v.parent().find("div.nav__folder").html(u({itemUrls:C,user:w,savedTalksCount:!1,savedPlaylistsCount:!1}));y=t.find("a."+x),f()}}function h(){_||(_=e("#account-link").find("img.banner__account__image")),_.transition({opacity:0}).transition({opacity:1}).transition({opacity:0}).transition({opacity:1})}function f(){a.count().done(D)}function m(e,t){e.find("a.account__poparoo__later")[t?"addClass":"removeClass"]("account__poparoo__later--populated").find("span").text(t)}function g(t){var n;w=t,E(),f(),w.avatarUrl?(n=e("<img class=banner__account__image id=account-image>"),n.attr({alt:"",src:w.avatarUrl}),e("#account-image").replaceWith(n)):e("#account-image").text(r(w.firstName+" "+w.lastName))}var v,_,b,y,w,k={},x="account__poparoo__later",C={savedTalks:"/dashboard/saved_talks",savedPlaylists:"/dashboard/saved_playlists",favoriteTalks:"/dashboard/favorite_talks",favoritePlaylists:"/dashboard/favorite_playlists",watchHistory:"/dashboard/history",conferences:"/dashboard/conferences",tedEdHistory:"http://ed.ted.com/activity/lessons",settings:TED.settingsUrl,profile:"/profile",logOut:TED.signOutUrl},S=function(e){var t=[];if(t.push({name:"Talks",open:!0,items:[{name:"Saved talks",url:C.savedTalks},{name:"Saved playlists",url:C.savedPlaylists},{name:"Favorite talks",url:C.favoriteTalks},{name:"Favorite playlists",url:C.favoritePlaylists},{name:"Talks you've watched",url:C.watchHistory}]}),e&&e.isTEDxOrganizer&&t.push({name:"TEDx Events",url:"/profiles/"+e.profileId+"/tedx-event-management"}),e&&e.hasConferences){var n={name:"Conferences",open:!1,items:[]};e.upcomingConferences&&e.upcomingConferences.reduce(function(e,t){return e.push({name:t.name,url:"/dashboard/conferences/"+t.slug}),e},n.items),n.items.push({name:"Badge",url:"/dashboard/conferences/badge"}),n.items.push({name:"Contact us",url:"/dashboard/conferences/contact"}),t.push(n)}return e&&e.hasEdActivity&&t.push({name:"Your TED-Ed activity",url:C.tedEdHistory,external:!0}),t.push({latch:!0,name:"Settings",url:TED.settingsUrl}),t.push({name:"Your profile",url:"/profile"}),t.push({name:"Log out",url:TED.signOutUrl}),t},D=function(){var t,n,i;return function(s){var o,a=s.total,r=a>0;if(a!==t){var l;n&&s.talks!==n&&(o="talks",l=s.talks>n),i&&s.playlists!==i&&(o="playlists",l=s.playlists>i),o&&e("#account-"+o)[l?"addClass":"removeClass"]("account__poparoo__item--active"),s.talks!==n&&m(e("#account-talks"),s.talks),s.playlists!==i&&m(e("#account-playlists"),s.playlists);var u=e("#account-badge");u.text(s.total>99?99:s.total)[r?"addClass":"removeClass"]("badge--visible"),r&&null!==t&&s.total>t&&u.addClassFor("badge--notify",600),n=s.talks,i=s.playlists,t=a}}}(),E=t.once(function(){v=e("#account-link"),v.on("click",d),i("breakpoint").subscribe(p),i("favorite.add").subscribe(h),i("watchLater.add").subscribe(f),i("watchLater.remove").subscribe(f)});return k.init=t.once(function(){i("auth.login").subscribe(g),s.getDetails().done(g)}),k}),define("global/uconf",["jquery","Cookies"],function(e,t){"use strict";var n="#";return{init:function(i,s){e(n+s).on("click",function(s){s.preventDefault(),e(n+i).slideUp("fast"),t.expire("_uconf",{domain:"ted.com",path:"/"})})}}}),define("global/keyboard",["jquery","exports","jqueryui/core"],function(e,t){"use strict";t._keyDowned=!1,t._keyDown=function(n){var i;n.keyCode!==e.ui.keyCode.SPACE||t._keyDowned||n.isPropagationStopped()||n.isDefaultPrevented()||!(i=e(n.target)).is("a[role=button]")||(n.preventDefault(),i.trigger("click",n)),t._keyDowned=!0},t._keyUp=function(){t._keyDowned=!1},t.init=function(){e(window).on({keydown:t._keyDown,keyup:t._keyUp})}}),define("utils/query_param",[],function(){"use strict";return function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}}),define("widgets/ad",["lodash","jquery","jqueryui/widget"],function(e,t){"use strict";t.widget("ted.ad",{_rendered:!1,$image:null,$text:null,$link:null,blocked:function(){this.element.hide()},refreshJsonAd:function(){if(this.options.blocked)return void this.blocked();if(this._rendered||(this._addAdClass(),this.element.children().addClass("ad__prefill"),this.options.ad.houseAd||this._getAppreciationText().appendTo(this.element),this.$link=t('<a class="ad__unit" href="#" rel="nofollow" target="_blank">').appendTo(this.element),this.$image=t("<img>").appendTo(this.$link),this._rendered=!0),!this.options.ad)return void this.element.hide();var e=this._getRenderDetails();this.$link.attr("href",e.click),this.$image.attr({src:e.currentCreative.url,width:e.dimensions.width,height:e.dimensions.height}),this.element[this.options.ad.hasDisplay===!1?"hide":"show"](),this._impress()},refreshHtmlAd:function(){this._addAdClass(),this._getAppreciationText().prependTo(this.element)},_init:function(){var e=String(this.options.mode);this._rendered=!1,"json"===e?this.refreshJsonAd():"html"===e&&this.refreshHtmlAd()},_fireImpression:function(e){var t=new Image;t.src=e},_impress:function(){this._fireImpression(this.options.ad.impression),e.forEach(this.options.ad.thirdPartyImpressions,this._fireImpression)},_getCreative:function(){var t=e.filter(this.options.ad.creative,function(e){return""!==e.url}),n=Math.max(window.devicePixelRatio||1,1);return e.reduce(t,function(e,t){return t.density<=n?t:e||t},{})},_getRenderDetails:function(){return e.extend({currentCreative:this._getCreative()},this.options.ad)},_getAppreciationText:function(){return this.$text=t('<div class="ad__text">TED Talks are free thanks to support from</div>'),this.$text},_addAdClass:function(){this.element.addClass("ad")}})}),define("hbs!templates/sponsorshipBug",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'\n<a class="sponsorship-bug__link media" href="#" rel="nofollow" target="_blank">\n  <div class="sponsorship-bug__image media__image media__image--alt">\n    <img src="" alt="">\n  </div>\n  <div class="sponsorship-bug__message media__message">\n    TED Talks are free<br>\n    thanks to support from\n  </div>\n</a>\n'},useData:!0});return t.registerPartial("templates/sponsorshipBug",n),n}),define("templates/helpers/assetUrl",["Handlebars"],function(e){"use strict";function t(e){return TED.assetHost+e}return e.registerHelper("assetUrl",t),t}),define("hbs!templates/sponsorshipBugBlocked",["hbs","hbs/handlebars","templates/helpers/assetUrl"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<a class="sponsorship-bug__nag" href="http://support.ted.com/customer/portal/articles/1532436-how-can-i-support-ted-by-modifying-my-ad-blocker-settings" target="_blank">\n  <img class="sponsorship-bug__nag__image" src="'+this.escapeExpression((t.assetUrl||e&&e.assetUrl||t.helperMissing).call(e,"/temp/ad-blocker-bug.png",{name:"assetUrl",hash:{},data:i}))+'" alt="Show your support by unblocking ted.com from ad blockers">\n</a>\n'},useData:!0});return t.registerPartial("templates/sponsorshipBugBlocked",n),n}),define("widgets/sponsorshipBug",["jquery","hbs!templates/sponsorshipBug","hbs!templates/sponsorshipBugBlocked","widgets/ad"],function(e,t,n){"use strict";e.widget("ted.sponsorshipBug",e.ted.ad,{blocked:function(){this.element.html(n()),this.element.show(),this._rendered=!1},refreshJsonAd:function(){return this.options.blocked?this.blocked():(this._rendered||(this.element.children().addClass("sponsorship-bug__prefill"),this.element.append(t()),this.$image=this.element.find("img"),this.$link=this.element.find("a.sponsorship-bug__link"),this._rendered=!0),void this._super())},_init:function(){this.element.addClass("sponsorship-bug"),this._super()}})}),define("lib/ads",["jquery","lodash","utils/query_param","exports","widgets/ad","widgets/sponsorshipBug"],function(e,t,n,i){"use strict";function s(t){var n=String(t.type),i=d[t.type];"master"===n?p.deferred.resolve(t):void 0===i?window.console&&console.log&&(console.log("Unknown ad type"),console.log(t)):e(i.id)[i.widget]({ad:t,mode:"json"})}function o(n){t.forEach(p.companionAdSlots,function(t){if(t.gptSlot.setTargeting(t.key,n.target),t.displayed){var s=e("#"+t.containerId);s.data("tedAd")?s.ad("destroy"):s.data("sponsorshipBug")&&s.sponsorshipBug("destroy"),i.refreshAd(t.gptSlot)}else i.displayAd(t.containerId);t.displayed=!0}),u(n.impression)}function a(e){i.player.player("sendAds",{postroll:r(e.postrollURL),preroll:r(e.prerollURL)})}function r(e){return e.replace("{adUnit}",p.slot.adUnit)}function l(t){var n=i.player=t;if(n){var r=i.playerMode=String(n.player("mode"));if("hls"===r)n.on({playerad:function(e,t){s(t.ad)}});else{p.deferred.done(o),n.on({playeradblock:function(){var t=d.bug;e(t.id)[t.widget]({blocked:!0})}});var l=!0;n.on({playertalk:function(e,t){var s=String(n.player("talks")[0].id),o=String(t.id);l&&s===o?(l=!1,"flash"===r&&p.deferred.done(a)):i.refreshMasterAd({targeting:t.targeting}),l=!1}})}}}function u(e){var t=new Image;t.src=e}function c(){t.forEach(p.slot.targeting,function(e,n){p.slot.gptSlot.setTargeting(n,t.isArray(e)?e.join(","):e)});var e=n("dfptest");e&&p.slot.gptSlot.setTargeting("dfptest",e)}var d={bug:{id:"#sponsorship-bug-placeholder",widget:"sponsorshipBug"},companion:{id:"#ad-unit",widget:"ad"},"companion-mobile":{id:"#ad-unit-mobile",widget:"ad"},devil:{id:"#devil-ad",widget:"ad"},onPage:{id:"#ad-unit",widget:"ad"}},p={companionAdSlots:[],deferred:e.Deferred(),slot:{adUnit:null,containerId:null,gptSlot:null,targeting:{}}};i._masterAd=p,i.player=null,window.googletag=window.googletag||{cmd:[]},i.slotRenderEndedHandler=function(n){var i=t.find(p.companionAdSlots,function(e){return e.gptSlot===n.slot});if(!n.isEmpty&&i){var s=String(i.containerId);if("ad-unit"===s){var o=e("#ad-unit"),a=o.data("tedAd");a||o.ad({mode:"html"})}}},i.displayMasterAd=function(e){p.slot.containerId=e.containerId,p.slot.adUnit=e.adUnit,window.googletag.cmd.push(function(){p.slot.gptSlot=googletag.defineOutOfPageSlot(p.slot.adUnit,p.slot.containerId).addService(googletag.pubads()),t.assign(p.slot.targeting,e.targeting),c(),i.displayAd(p.slot.containerId)})},i.refreshMasterAd=function(n){"hls"!==i.playerMode&&(p.deferred=e.Deferred(),p.deferred.done(o),"flash"===i.playerMode&&p.deferred.done(a),p.slot.gptSlot.clearTargeting(),t.forEach(p.companionAdSlots,function(e){e.gptSlot.clearTargeting()}),t.assign(p.slot.targeting,n.targeting),c(),i.refreshAd(p.slot.gptSlot))},i.displayAd=function(t){e(function(){window.googletag.cmd.push(function(){googletag.display(t)})})},i.refreshAd=function(e){window.googletag.cmd.push(function(){googletag.pubads().refresh([e])})},i.createCompanionSlot=function(e){window.googletag.cmd.push(function(){var t=googletag.defineSlot(e.adUnit,e.size,e.containerId).addService(googletag.pubads());p.companionAdSlots.push({containerId:e.containerId,gptSlot:t,key:e.key})})},i.initPlayer=l,i.gptAd=function(e){s(e.ad)},window.googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",i.slotRenderEndedHandler)})}),define("lib/browserDetect",["exports"],function(e){"use strict";function t(e){for(var t=0;t<e.length;t++){var n=e[t].string,s=e[t].prop;if(i=e[t].versionSearch||e[t].identity,n){if(-1!==n.indexOf(e[t].subString))return e[t].identity}else if(s)return e[t].identity}}function n(e){var t=e.indexOf(i);if(-1!==t)return parseFloat(e.substring(t+i.length+1))}var i,s=window.navigator,o=[{string:s.userAgent,subString:"Chrome",identity:"Chrome"},{string:s.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:s.userAgent,subString:"Firefox",identity:"Firefox"},{string:s.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:s.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}];e.browser=t(o)||"Unknown Browser",e.version=n(window.navigator.userAgent)||n(window.navigator.appVersion)||"Unknown Version"}),define("utils/ted",[],function(){"use strict";var e=function(){var e=window.navigator,t=e?e.userAgent.toLowerCase():"";if(-1!==t.indexOf("chrome"))return!1;var n=t.match(/macintosh.*os x.*applewebkit.*version\/([\d]+).*safari/);return n?+n[1]<7?!1:!0:!1};return function(t){return window.TED?"playerPath"===t?e()?window.TED.playerPathLocal:window.TED.playerPathRemote:window.TED[t]:""}}),define("lib/errorCollector",["jquery","lodash","lib/browserDetect","lib/currentUserId","utils/ted","exports"],function(e,t,n,i,s,o){"use strict";o.post=t.throttle(function(t){e.post("/error_collector.php",{message:t})},5e3),o.log=function(t,a){o.post(e.extend({message:t,context:"js",uri:window.location.href,client_name:n.browser,client_version:n.version,elapsed_seconds:Math.floor((+new Date-s("startTime"))/1e3),profile_id:i.get()||"N/A",user_agent:window.navigator?window.navigator.userAgent:"Unknown User Agent"},a||{}))}}),define("global/errors",["lib/errorCollector"],function(e){"use strict";window.onerror=function(t,n,i){i&&n.match(/^https?:\/\/(?:.*\.)?(?:ted|tedcdn)\.com\//)&&(!n.match(/\.js/)&&5>i||e.log(t,{file:n,line:i}))}}),define("hbs!templates/authPromptModal",["hbs","hbs/handlebars","templates/helpers/icon"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="auth-prompt__section auth-prompt__header">\n  <h2 class="auth-prompt__header__title">\n    Log in to\n    TED\n  </h2>\n\n  <a href="#" class="modal__close auth-prompt__close">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n</div>\n\n<div class="auth-prompt__section auth-prompt__options">\n  <form class="auth-prompt__option auth-prompt__option--standard">\n    <div class="auth-prompt__message">\n      Your email or password was incorrect.\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Email</label>\n      <input class="form-control auth-prompt__email" name="user[email]" type="email">\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Password</label>\n      <input class="form-control auth-prompt__password" name="user[password]" type="password">\n    </div>\n\n    <div class="m3">\n      <label>\n        <input class="auth-prompt__remember" type="checkbox" checked name="user[remember_me]">\n        <span class="form-label" style="display:inline; margin-left: 2px;">\n          Remember me\n        </span>\n      </label>\n    </div>\n\n    <div>\n      <button class="button button--dark auth-prompt__login">Log in</button>\n      <a class="l3 auth-prompt__halp" href="'+this.escapeExpression((s=null!=(s=t.signInHelpUrl||(null!=e?e.signInHelpUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"signInHelpUrl",hash:{},data:i}):s))+'" target="_blank">Need help logging in?</a>\n    </div>\n  </form>\n\n  <div class="auth-prompt__option auth-prompt__option--social">\n    <button class="button button--wide button--dark button--labeled button--facebook auth-prompt__facebook">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"facebook","","button__icon",{name:"icon",hash:{},data:i}))+'\n      <span class="button__label">Log in with Facebook</span>\n    </button>\n  </div>\n</div>\n\n<div class="auth-prompt__section auth-prompt__footer">\n  <span class="auth-prompt__footer__question">Don\'t have an account yet?</span>\n  <a class="l3" href="'+this.escapeExpression((s=null!=(s=t.signUpUrl||(null!=e?e.signUpUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"signUpUrl",hash:{},data:i}):s))+'" target="_blank">Sign up</a>\n</div>\n\n<div class="auth-prompt__thinking"></div>\n'},useData:!0});return t.registerPartial("templates/authPromptModal",n),n}),define("views/AuthPromptView",["lodash","Modernizr","Backbone","lib/auth","hbs!templates/authPromptModal","utils/ted","spinjs","widgets/modal"],function(e,t,n,i,s,o,a){"use strict";function r(){i||(i=require("lib/auth"))}var l=n.View.extend({template:s,events:{"click button.auth-prompt__facebook":"facebook","click button.auth-prompt__login":"login","submit form.auth-prompt__option--standard":"login"},close:function(){this.$el.modal("close")},open:function(){this.$el.removeClass("auth-prompt--error"),this.$el.modal("open"),this.$email.focus()},login:function(e){e&&e.preventDefault(),this._startThinking(),r(),i.login(this.$email.val(),this.$password.val(),this.$remember.val()).then(this._loginSuccess,this._loginFailure).always(this._stopThinking),this.$password.val("")},facebook:function(e){e&&e.preventDefault(),this._startThinking(),r(),i.facebook().then(this._facebookSuccess,this._facebookFailure).always(this._stopThinking)},initialize:function(){var e=this;this._loginSuccess=function(){e.close(),e.trigger("login.success")},this._facebookSuccess=this._loginSuccess,this._loginFailure=function(t){t&&t.responseJSON&&e.$el.find(".auth-prompt__message").html(t.responseJSON.error),e.$el.addClass("auth-prompt--error"),e.trigger("login.failure")},this._facebookFailure=function(){e.trigger("login.failure")},this._stopThinking=function(){e.$thinkers.prop("disabled",!1),e.$el.removeClass("auth-prompt--thinking"),e._spinner&&e._spinner.stop()}},render:function(){var e=this;return this.$el.addClass("auth-prompt").html(e.template({signInHelpUrl:o("signInHelpUrl"),signUpUrl:o("signUpUrl")})).modal({autoOpen:!1}).on("modalclose",function(){e.trigger("close")}).on("modalopen",function(){e.trigger("open")}),this.$email=this.$el.find("input.auth-prompt__email"),this.$password=this.$el.find("input.auth-prompt__password"),this.$remember=this.$el.find("input.auth-prompt__remember"),this.$thinkers=this.$el.find(["form.auth-prompt__option--standard","button.auth-prompt__login","button.auth-prompt__facebook"].join(", ")).add(this.$email).add(this.$password),this
},_startThinking:function(){this.$thinkers.prop("disabled",!0),this.$el.addClass("auth-prompt--thinking"),this._spinner||(this._spinner=new a({className:"spinner spinner--centered"})),this._spinner.spin(this.el)}});return l}),define("hbs!templates/authError",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Error",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Sorry, an error occurred. Please log in and try again.",{name:"t",hash:{},data:i}))+'</p>\n  <p><a class="l3" href="/session/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log in",{name:"t",hash:{},data:i}))+"</a></p>\n</div>\n"},useData:!0});return t.registerPartial("templates/authError",n),n}),define("utils/callback",["lodash"],function(e){"use strict";var t=Number(new Date),n="tedc"+t,i=0;return function(t){var s=n+ ++i,o=this;return window[s]=function(){t.apply(o,e.toArray(arguments)),delete window[s]},s}}),define("utils/iframep",["jquery","utils/callback"],function(e,t){"use strict";return function(n){function i(){"pending"===o.state&&(o.reject(),delete window[a])}function s(){var e=l.contentDocument||l.contentWindow&&l.contentWindow.document;window[a]&&window.setTimeout("complete"===e.readyState?i:s,300)}var o=new e.Deferred,a=t(function(e){o.resolve(e)});n=n.replace("callback=?","callback="+a);var r=e("<iframe></iframe>").css({display:"none",width:0,height:0}).appendTo(document.body),l=r.get(0);return r.ready(s).attr("src",n),o.always(function(){r.remove()}),window.setTimeout(i,5e3),o.promise()}}),define("utils/origin",[],function(){"use strict";return window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}),define("lib/auth",["jquery","lodash","lib/currentUser","lib/errorCollector","Modernizr","views/AuthPromptView","hbs!templates/authError","utils/callback","utils/iframep","utils/origin","lib/pubSub","utils/ted","exports"],function(e,t,n,i,s,o,a,r,l,u,c,d,p){"use strict";function h(e){e.done(function(e){c("auth.login").publish(e)})}function f(){w?w.open():e(a()).modal()}function m(){if(!C)throw new Error("lib/auth: please check auth.capable() to ensure client support before using auth methods.");if(!p.capable())throw f(),new Error("lib/auth: this client is not capable of using auth methods.")}function g(){return l("/session/check?callback=?").done(v)}function v(t){e("head").append(_("csrf-param",t.csrf.param)+_("csrf-token",t.csrf.token))}function _(e,t){return'<meta name="'+e+'" content="'+t+'">'}function b(e,t){return function(n){e.reject(n),p._reportError(t)}}function y(){o||(o=require("views/AuthPromptView"))}var w,k,x,C=!1,S=window.console;p._openPrompt=function(){x||(y(),x=new o,x.on("close",function(){t.defer(function(){k&&"pending"!==k.state()&&k.reject()})}).on("login.success",function(){p._resolveDetails(k).fail(f)}).render()),x.open()},p._reportError=function(e){var t="Auth error: "+e;i.log(t),S&&S.log&&S.log(t)},p._reset=function(){C=!1,w=void 0,k=void 0,x=void 0},p._resolveDetails=function(e){return n.getDetails().done(function(t){e.resolve(t)})},p.capable=function(){return C=!0,s.cors},p.facebook=function(){function t(e){e&&e.csrf&&v(e),"pending"===n.state()&&(h(n),p._resolveDetails(n).fail(b(n,"unable to corroborate Facebook authentication")),s&&s.close())}m();var n=new e.Deferred,i=r(t),s=window.open("/users/new?facebook=true&referer="+encodeURIComponent(u+"/session/check?callback="+i),"authfb",["scrollbars=1","resizable=1","height=480","width=640"].join(",")),o=0,a=300,l=1e4,c=window.setInterval(function(){o++,(s&&s.closed||!s&&o*a>l)&&(t(),window[i]&&delete window[i],window.clearInterval(c),c=null)},a);return n.promise()},p.login=function(t,n,i){m();var s=new e.Deferred;return p._resolveDetails(s).then(function(e){s.resolve(e)},function(){e.ajax({url:d("authHost")+"/session/new.json",timeout:3e3,type:"GET",xhrFields:{withCredentials:!0}}).then(function(o){h(s),e.ajax({url:d("authHost")+"/session.json",timeout:3e3,type:"POST",data:{authenticity_token:o.authenticity_token,user:{email:t,password:n,remember_me:i}},xhrFields:{withCredentials:!0}}).then(function(){g().then(function(){p._resolveDetails(s).fail(b(s,"unable to corroborate authentication"))},b(s,"session check timed out"))},b(s,"credentials rejected"))},b(s,"could not obtain token"))}),s.promise()},p.logout=function(){m()},p.prompt=function(){m();var t=new e.Deferred;return k=t,p._resolveDetails(t).fail(p._openPrompt),t.promise()},c("auth.login").subscribe(function(){e(document.documentElement).addClass("loggedin").removeClass("loggedout")}),e(function(){e(document).on("click","a.auth-login",function(e){p.capable()&&(e.preventDefault(),p.prompt())})})}),define("utils/is_mobile",[],function(){"use strict";function e(e){return!!t.ua.match(e)}function t(){return t.isIOS()||t.isAndroid()}var n=/Android/g,i=/(iPad|iPhone|iPod)/g;return t.isIOS=function(){return e(i)},t.isAndroid=function(){return e(n)},t.ua=window.navigator&&window.navigator.userAgent||"",t}),define("lib/instaplay",["jquery","utils/is_mobile","exports"],function(e,t,n){"use strict";var i="instaplay",s=50,o=15e3;n.capable=function(){return!t()&&this._storage()},n.set=function(t,i){var s=n._getStore()||{history:[]};i=e.extend({clearHistory:!0},i||{}),s.url=t,s.time=+new Date,i.clearHistory&&(s.history=[]),n._setStore(s)},n.check=function(e){var t=n._getStore();return t&&-1!==e.indexOf(t.url)&&+new Date-t.time<o?(t.history=t.history.slice(0,s-1),t.history.push(e),n._setStore(t),!0):(n._clearStore(),!1)},n.history=function(){var e=n._getStore();return e?e.history:[]},n.recentMatches=function(e){var t=n.history(),i=t.length,s=[];if(i)for(var o=0;i>o&&t[o].match(e);o++)s.push(t[o]);return s},n._getStore=function(){var e=n._storage();if(e){var t=e.getItem(i);if(t&&(t=window.JSON.parse(t),t&&t.url&&t.history&&t.time))return t}},n._setStore=function(e){var t=n._storage();t&&t.setItem(i,window.JSON.stringify(e))},n._clearStore=function(){var e=n._storage();e&&e.removeItem(i)},n._storage=function(){try{var e=window.sessionStorage,t=i+"-test",n="1";if(e.setItem(t,n),e.getItem(t)===n)return e.removeItem(t),e}catch(s){}return null},e(function(){e(document).on("click","a.instaplay-link",function(){n.set(e(this).attr("href"))})})}),require(["jquery","lodash","dq","global/floodlight","global/links","global/subscribe","global/navs","global/mainNav","global/login","global/account","global/uconf","global/keyboard","lib/ads","global/errors","lib/auth","lib/instaplay","jqueryujs"],function(e,t,n,i,s,o,a,r,l,u,c,d,p){"use strict";t.defer(function(){s.init(),o.init(),a.init(),r.init(),l.init(),u.init(),d.init()}),n({q:_g,modules:{ads:p,floodlight:i,uconf:c}})}),define("global",function(){}),define("talks",["lodash","dq","talks/browse","global"],function(e,t,n){"use strict";e.defer(t,{modules:{browse:n}})})}();
//# sourceMappingURL=talks.js
//# sourceMappingURL=talks.js.map