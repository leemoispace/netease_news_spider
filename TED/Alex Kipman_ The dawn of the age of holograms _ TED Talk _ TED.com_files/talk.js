!function(){define("deferLink",["jquery"],function(e){"use strict";function t(e){return function(t){return n.call(this,t,e)}}function n(t,n){function i(){var e=+s.data(r)-1;s.data(r,e),0>=e&&!s.data(u)&&(c.location.href=d)}var s="A"===this.nodeName?e(this):e(t.target).closest("a"),d=s.attr("href"),h=s.attr("target"),p=s.length&&d&&1===t.which&&!t.metaKey&&!t.shiftKey,f=n;if(e.isFunction(n)&&(f=n.call(this,t),f===!1))return!1;p&&t.isDefaultPrevented()&&!s.data(r)&&(p=!1),p&&h&&"_self"!==h&&(p=!1),p&&o&&s.is("[download]")&&(p=!1),p&&s.hasClass(a)&&(p=!1);var m=+(s.data(r)||0);p&&(s.data(r,m+1),f.when?("resolved"===f.state()&&i(),f.done(i)):e.isNumeric(f)?c.setTimeout(i,f):(p=!1,s.data(r,m))),p&&!m&&(t.preventDefault(),s.data(l,!0))}function i(i){return i.when||e.isNumeric(i)||e.isFunction(i)?t(i):void n.call(this,i,s)}var s=50,a="no-defer",o="download"in document.createElement("a"),r="defer-link-pends",l="defer-link-preventable",u="defer-link-prevented",c=window,d=e.Event.prototype.preventDefault;return e.Event.prototype.preventDefault=function(){var t=e(this.target);return t.data(l)&&t.data(u,!0),d.apply(this,Array.prototype.slice.call(arguments))},i}),define("utils/applyAll",["jquery"],function(e){"use strict";function t(n,i,s){var a,o;for(a=0,o=i.length;o>a;a++)e.isArray(i[a])?t(n,i[a],s):i[a].apply(n,s)}return t}),define("utils/throwError",[],function(){"use strict";return function(e){throw new Error("Error in TED: "+e)}}),define("lib/pubSub",["jquery","utils/applyAll","utils/throwError"],function(e,t,n){"use strict";function i(e){var i={publish:e.fire,subscribe:e.add,unsubscribe:e.remove},s=null;e.add(function(e){s=e}),i.read=function(){return s};var a;return i.publishUnique=function(){if(!window.JSON)return n("JSON object not available. You may need to shim it on this client."),!1;var t=Array.prototype.slice.call(arguments,0),i=JSON.stringify(t);i!==a&&(e.fire.apply(e,t),a=i)},i.once=function(){function n(){t(e,i,arguments),e.remove(n)}var i=arguments;return e.add(n)},i.future=function(){function n(){a&&t(e,s,arguments)}var i,s=arguments,a=!1;return i=e.add(n),a=!0,i},i}function s(t){var n,s=t&&a[t];return s||(n=e.Callbacks("memory"),s=i(n),t&&(a[t]=s)),s}var a={};return s._reset=function(){a={}},s}),define("lib/resize",["jquery","lodash","lib/pubSub"],function(e,t,n){"use strict";function i(e){for(var t,i=h;i--;)!t&&e>=d[i].at&&(t=d[i].its);n("sizeGroup").publishUnique(t)}function s(){var e=0,t=c;if(a=window.innerHeight,o=window.innerWidth||document.documentElement.clientWidth,u)e=l;else for(;t--;)!e&&o>=r[t]&&(e=r[t]);n("breakpoint").publishUnique(e),n("height").publishUnique(a),n("width").publishUnique(o)}var a,o,r=[320,480,600,768,1024,1200],l=1024,u=e("html").is(".oldie"),c=r.length,d=[{at:0,its:"oh"},{at:480,its:"xs"},{at:768,its:"sm"},{at:1024,its:"lg"}],h=d.length;return e(window).on("resize",t.throttle(s,100)),s(),n("breakpoint").subscribe(i),n}),define("lib/ga",["jquery","lodash","deferLink","lib/pubSub","lib/resize"],function(e,t,n,i){"use strict";function s(){(u[u.GoogleAnalyticsObject]||e.noop).apply(u,l.slice.call(arguments))}function a(){var e=l.slice.call(arguments),i=this;return function(a){return i.apply(s,e),t.has(a,"originalEvent")&&t.has(this,"nodeName")&&"click"===a.type?n.call(this,a):void 0}}function o(){var e,t=0;i("breakpoint").subscribe(function(n){s("set","dimension1",n),t++&&s.sendEvent("breakpoint","change",e+"|"+n,t),e=n})}function r(t){var n=e(this),i="ga-";t=e.extend(t||{},{category:n.data(i+"category"),action:n.data(i+"action"),label:n.data(i+"label")}),s.sendEvent(t.category,t.action,t.label)}var l=[],u=window;return t.assign(s,{send:t.partial(s,"send"),set:t.partial(s,"set"),sendEvent:t.partial(s,"send","event"),sendSocial:t.partial(s,"send","social")},function(e,t){return t.recall=a,t}),o(),s.send("pageview"),e(function(){e(document).on("click","a.ga-link",n(function(){return r.call(this,{action:"click",category:"site.link",label:this.href}),50}))}),s}),function(){function e(e){this._value=e}function t(e,t,n,i){var s,a,o=Math.pow(10,t);return a=(n(e*o)/o).toFixed(t),i&&(s=new RegExp("0{1,"+i+"}$"),a=a.replace(s,"")),a}function n(e,t,n){var i;return i=t.indexOf("$")>-1?s(e,t,n):t.indexOf("%")>-1?a(e,t,n):t.indexOf(":")>-1?o(e,t):l(e._value,t,n)}function i(e,t){var n,i,s,a,o,l=t,u=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1;if(t.indexOf(":")>-1)e._value=r(t);else if(t===f)e._value=0;else{for("."!==h[p].delimiters.decimal&&(t=t.replace(/\./g,"").replace(h[p].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+h[p].abbreviations.thousand+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+h[p].abbreviations.million+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),s=new RegExp("[^a-zA-Z]"+h[p].abbreviations.billion+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),a=new RegExp("[^a-zA-Z]"+h[p].abbreviations.trillion+"(?:\\)|(\\"+h[p].currency.symbol+")?(?:\\))?)?$"),o=0;o<=u.length&&!(c=t.indexOf(u[o])>-1?Math.pow(1024,o+1):!1);o++);e._value=(c?c:1)*(l.match(n)?Math.pow(10,3):1)*(l.match(i)?Math.pow(10,6):1)*(l.match(s)?Math.pow(10,9):1)*(l.match(a)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=c?Math.ceil(e._value):e._value}return e._value}function s(e,t,n){var i,s=t.indexOf("$")<=1?!0:!1,a="";return t.indexOf(" $")>-1?(a=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(a=" ",t=t.replace("$ ","")):t=t.replace("$",""),i=l(e._value,t,n),s?i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),i.splice(1,0,h[p].currency.symbol+a),i=i.join("")):i=h[p].currency.symbol+a+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,a+h[p].currency.symbol),i=i.join("")):i=i+a+h[p].currency.symbol,i}function a(e,t,n){var i,s="",a=100*e._value;return t.indexOf(" %")>-1?(s=" ",t=t.replace(" %","")):t=t.replace("%",""),i=l(a,t,n),i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,s+"%"),i=i.join("")):i=i+s+"%",i}function o(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),i=Math.round(e._value-60*t*60-60*n);return t+":"+(10>n?"0"+n:n)+":"+(10>i?"0"+i:i)}function r(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function l(e,n,i){var s,a,o,r,l,u,c=!1,d=!1,m=!1,g="",_="",v="",b=Math.abs(e),y=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],w="",k=!1;if(0===e&&null!==f)return f;if(n.indexOf("(")>-1?(c=!0,n=n.slice(1,-1)):n.indexOf("+")>-1&&(d=!0,n=n.replace(/\+/g,"")),n.indexOf("a")>-1&&(n.indexOf(" a")>-1?(g=" ",n=n.replace(" a","")):n=n.replace("a",""),b>=Math.pow(10,12)?(g+=h[p].abbreviations.trillion,e/=Math.pow(10,12)):b<Math.pow(10,12)&&b>=Math.pow(10,9)?(g+=h[p].abbreviations.billion,e/=Math.pow(10,9)):b<Math.pow(10,9)&&b>=Math.pow(10,6)?(g+=h[p].abbreviations.million,e/=Math.pow(10,6)):b<Math.pow(10,6)&&b>=Math.pow(10,3)&&(g+=h[p].abbreviations.thousand,e/=Math.pow(10,3))),n.indexOf("b")>-1)for(n.indexOf(" b")>-1?(_=" ",n=n.replace(" b","")):n=n.replace("b",""),o=0;o<=y.length;o++)if(s=Math.pow(1024,o),a=Math.pow(1024,o+1),e>=s&&a>e){_+=y[o],s>0&&(e/=s);break}return n.indexOf("o")>-1&&(n.indexOf(" o")>-1?(v=" ",n=n.replace(" o","")):n=n.replace("o",""),v+=h[p].ordinal(e)),n.indexOf("[.]")>-1&&(m=!0,n=n.replace("[.]",".")),r=e.toString().split(".")[0],l=n.split(".")[1],u=n.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),w=t(e,l[0].length+l[1].length,i,l[1].length)):w=t(e,l.length,i),r=w.split(".")[0],w=w.split(".")[1].length?h[p].delimiters.decimal+w.split(".")[1]:"",m&&0===Number(w.slice(1))&&(w="")):r=t(e,null,i),r.indexOf("-")>-1&&(r=r.slice(1),k=!0),u>-1&&(r=r.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h[p].delimiters.thousands)),0===n.indexOf(".")&&(r=""),(c&&k?"(":"")+(!c&&k?"-":"")+(!k&&d?"+":"")+r+w+(v?v:"")+(g?g:"")+(_?_:"")+(c&&k?")":"")}function u(e,t){h[e]=t}var c,d="1.5.2",h={},p="en",f=null,m="0,0",g="undefined"!=typeof module&&module.exports;c=function(t){return c.isNumeral(t)?t=t.value():0===t||"undefined"==typeof t?t=0:Number(t)||(t=c.fn.unformat(t)),new e(Number(t))},c.version=d,c.isNumeral=function(t){return t instanceof e},c.language=function(e,t){if(!e)return p;if(e&&!t){if(!h[e])throw new Error("Unknown language : "+e);p=e}return(t||!h[e])&&u(e,t),c},c.languageData=function(e){if(!e)return h[p];if(!h[e])throw new Error("Unknown language : "+e);return h[e]},c.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),c.zeroFormat=function(e){f="string"==typeof e?e:null},c.defaultFormat=function(e){m="string"==typeof e?e:"0.0"},c.fn=e.prototype={clone:function(){return c(this)},format:function(e,t){return n(this,e?e:m,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:i(this,e?e:m)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){return this._value=this._value+Number(e),this},subtract:function(e){return this._value=this._value-Number(e),this},multiply:function(e){return this._value=this._value*Number(e),this},divide:function(e){return this._value=this._value/Number(e),this},difference:function(e){var t=this._value-Number(e);return 0>t&&(t=-t),t}},g&&(module.exports=c),"undefined"==typeof ender&&(this.numeral=c),"function"==typeof define&&define.amd&&define("numeral",[],function(){return c})}.call(this),define("abby-tests/sponsorship-2/sponsorship",["jquery","lib/ga","numeral","exports"],function(e,t,n,i){"use strict";function s(){return h?"complete":"incomplete"}function a(e){e.preventDefault(),t.sendEvent("talk.sponsorship.banner","close",s()),u.slideUp(300);try{localStorage.setItem("hideSponsorship",!0)}catch(n){}}function o(t){var n=e(t.target);t.preventDefault(),l(n.data("amount"))}function r(t){var i=e(t.target),s=n(i.data("amount")).format("0"),a=n(i.data("effect")).format("0,0");c=c||u.find("span.Sponsorship__message__amount"),d=d||u.find("span.Sponsorship__message__effect"),c.text("$"+s),d.text(a)}function l(e){e=parseInt(e,10),t.sendEvent("talk.sponsorship.pay","click",e),h=!0,u.find("input.Sponsorship__amount").val(n(e).format("0.00")),u.find("form").submit()}var u,c,d,h=!1;i.init=function(){u=e("#sponsorship"),u.find("button.Sponsorship__selection").on("click",o).on("mouseenter",r).removeAttr("disabled"),u.find("a.Sponsorship__close").on("click",a),u.is(":visible")||u.slideDown(400)}}),define("utils/is_mobile",[],function(){"use strict";function e(e){return!!t.ua.match(e)}function t(){return t.isIOS()||t.isAndroid()}var n=/Android/g,i=/(iPad|iPhone|iPod)/g;return t.isIOS=function(){return e(i)},t.isAndroid=function(){return e(n)},t.ua=window.navigator&&window.navigator.userAgent||"",t}),define("lib/instaplay",["jquery","utils/is_mobile","exports"],function(e,t,n){"use strict";var i="instaplay",s=50,a=15e3;n.capable=function(){return!t()&&this._storage()},n.set=function(t,i){var s=n._getStore()||{history:[]};i=e.extend({clearHistory:!0},i||{}),s.url=t,s.time=+new Date,i.clearHistory&&(s.history=[]),n._setStore(s)},n.check=function(e){var t=n._getStore();return t&&-1!==e.indexOf(t.url)&&+new Date-t.time<a?(t.history=t.history.slice(0,s-1),t.history.push(e),n._setStore(t),!0):(n._clearStore(),!1)},n.history=function(){var e=n._getStore();return e?e.history:[]},n.recentMatches=function(e){var t=n.history(),i=t.length,s=[];if(i)for(var a=0;i>a&&t[a].match(e);a++)s.push(t[a]);return s},n._getStore=function(){var e=n._storage();if(e){var t=e.getItem(i);if(t&&(t=window.JSON.parse(t),t&&t.url&&t.history&&t.time))return t}},n._setStore=function(e){var t=n._storage();t&&t.setItem(i,window.JSON.stringify(e))},n._clearStore=function(){var e=n._storage();e&&e.removeItem(i)},n._storage=function(){try{var e=window.sessionStorage,t=i+"-test",n="1";if(e.setItem(t,n),e.getItem(t)===n)return e.removeItem(t),e}catch(s){}return null},e(function(){e(document).on("click","a.instaplay-link",function(){n.set(e(this).attr("href"))})})}),define("hbs/underscore",{}),function(window){var JSON=window.JSON||{};!function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,s,a,o,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,n=0;a>n;n+=1)o[n]=str(n,l)||"null";return s=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+r+"]":"["+o.join(",")+"]",gap=r,s}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],s=str(i,l),s&&o.push(quote(i)+(gap?": ":":")+s));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(s=str(i,l),s&&o.push(quote(i)+(gap?": ":":")+s));return s=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+r+"}":"{"+o.join(",")+"}",gap=r,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=walk(s,n),void 0!==i?s[n]=i:delete s[n]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("utils/formatDuration",[],function(){"use strict";function e(e){return(e>9?"":"0")+e}return function(t){var n=t%60|0,i=t/3600|0,s=t%3600/60|0;return(i?i+":"+e(s):s)+":"+e(n)}}),define("templates/helpers/formatDuration",["Handlebars","utils/formatDuration"],function(e,t){"use strict";e.registerHelper("formatDuration",t)}),define("hbs!templates/thumb",["hbs","hbs/handlebars","templates/helpers/formatDuration"],function(e,t){var n=t.template({1:function(e,t,n,i){return'    <span class="thumb__duration">\n      '+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=e?e.playDuration:e,{name:"formatDuration",hash:{},data:i}))+"\n    </span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,a;return'\n<span class="thumb thumb--'+this.escapeExpression((a=null!=(a=t.ratio||(null!=e?e.ratio:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"ratio",hash:{},data:i}):a))+" "+this.escapeExpression((a=null!=(a=t.cropClass||(null!=e?e.cropClass:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"cropClass",hash:{},data:i}):a))+'">\n  <span class="thumb__sizer"><span class="thumb__tugger"><img src="'+this.escapeExpression((a=null!=(a=t.src||(null!=e?e.src:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"src",hash:{},data:i}):a))+'" class="thumb__image" alt=""><span class="thumb__aligner"></span></span></span>\n\n'+(null!=(s=t["if"].call(e,null!=e?e.playDuration:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"</span>\n"},useData:!0});return t.registerPartial("templates/thumb",n),n}),define("templates/helpers/thumb",["Handlebars","hbs!templates/thumb"],function(e,t){"use strict";e.registerHelper("thumb",function(n,i,s){var a=s&&s>0?s:!1;return i=i||"video",new e.SafeString(t({cropClass:"video"===i?"thumb--crop-top":"",src:n,ratio:i,playDuration:a,playIcon:!a}))})}),define("hbs!templates/talk-countdown-checker",["hbs","hbs/handlebars","templates/helpers/thumb","templates/helpers/formatDuration"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'            <div class="col">\n              <a class="ga-link undec" href="/talks/'+this.escapeExpression((s=null!=(s=t.slug||(null!=e?e.slug:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"slug",hash:{},data:i}):s))+'" data-ga-category="talk.relatedTalk">\n                <div class="m4">'+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,null!=e?e.image:e,{name:"thumb",hash:{},data:i}))+'</div>\n\n                <div class="small hide-sm">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+'</div>\n                <div class="show-sm">\n                  <div class="h12 show-sm m5">'+this.escapeExpression((s=null!=(s=t.speaker||(null!=e?e.speaker:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"speaker",hash:{},data:i}):s))+'</div>\n                  <div class="h9 m5">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+'</div>\n                  <div class="show-sm">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=e?e.duration:e,{name:"formatDuration",hash:{},data:i}))+"</div>\n                </div>\n              </a>\n            </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="talk-end-card Talk-countdown-checker inverse">\n  <div class="vc">\n    <div class="vc__wrap">\n      <div class="container">\n\n        <h2 class="h4 m2 show-sm">Recommended talks:</h2>\n        <div class="row row-oh-3up row-skinny row-lg-wide">\n          <div class="col">\n            <a class="ga-link undec" href="/talks/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.slug:s,e))+'" data-ga-category="talk.relatedTalk">\n              <div class="m4">'+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.image:s,{name:"thumb",hash:{},data:i}))+'</div>\n\n              <div class="small hide-sm">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.title:s,e))+'</div>\n              <div class="show-sm">\n                <div class="h12 show-sm m5">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.speaker:s,e))+'</div>\n                <div class="h9 m5">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.title:s,e))+'</div>\n                <div class="show-sm">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.duration:s,{name:"formatDuration",hash:{},data:i}))+"</div>\n              </div>\n            </a>\n          </div>\n\n"+(null!=(s=t.each.call(e,null!=e?e.relatedTalks:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"        </div>\n\n      </div>\n    </div>\n  </div>\n</div>\n"},useData:!0});return t.registerPartial("templates/talk-countdown-checker",n),n}),define("hbs!templates/talk-countdown-timer",["hbs","hbs/handlebars","templates/helpers/thumb","templates/helpers/formatDuration"],function(e,t){var n=t.template({1:function(e,t,n,i){var s,a;return'            <div class="col col-oh-6 col-lg-4 '+(null!=(s=t.unless.call(e,i&&i.index,{name:"unless",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+'">\n              <a class="ga-link undec Talk-countdown-timer__talk" href="/talks/'+this.escapeExpression((a=null!=(a=t.slug||(null!=e?e.slug:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"slug",hash:{},data:i}):a))+'" data-ga-category="talk.countdownTalk">\n                <div class="m3">'+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,null!=e?e.image:e,{name:"thumb",hash:{},data:i}))+'</div>\n                <div class="h12 Talk-countdown-timer__talk__speaker show-sm">'+this.escapeExpression((a=null!=(a=t.speaker||(null!=e?e.speaker:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"speaker",hash:{},data:i}):a))+'</div>\n                <div class="Talk-countdown-timer__talk__title">'+this.escapeExpression((a=null!=(a=t.title||(null!=e?e.title:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"title",hash:{},data:i}):a))+'</div>\n                <div class="Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=e?e.duration:e,{name:"formatDuration",hash:{},data:i}))+"</div>\n              </a>\n            </div>\n"},2:function(){return"col-lg-offset-1"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="talk-end-card Talk-countdown-timer inverse">\n\n  <div class="container Talk-countdown-timer__container Talk-countdown-timer__container--running">\n    <div class="row row-skinny row-lg-wide">\n      <div class="col col-sm-4">\n        <div class="Talk-countdown-timer__heading">\n          Playing next in\n          <span class="Talk-countdown-timer__remaining">10</span>\n\n          <a class="Talk-countdown-timer__cancel undec" href="#">Cancel</a>\n        </div>\n\n        <div class="Talk-countdown-timer__progress Talk-countdown-timer__progress--top show-lg">\n          <div class="Talk-countdown-timer__progress__meter" style="width:100%"></div>\n        </div>\n      </div>\n    </div>\n\n    <div class="row row-skinny row-lg-wide m3">\n      <div class="col col-oh-4">\n        <a class="ga-link undec" href="/talks/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.slug:s,e))+'" data-ga-category="talk.countdownTalk">\n          '+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.image:s,{name:"thumb",hash:{},data:i}))+'\n        </a>\n      </div>\n\n      <div class="col col-oh-8">\n        <a class="ga-link undec Talk-countdown-timer__talk Talk-countdown-timer__talk--next" href="/talks/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.slug:s,e))+'" data-ga-category="talk.countdownTalk">\n          <div class="h12 m5 Talk-countdown-timer__talk__speaker">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.speaker:s,e))+'</div>\n          <div class="h6 m4 Talk-countdown-timer__talk__title">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.title:s,e))+'</div>\n          <div class="h11 Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.duration:s,{name:"formatDuration",hash:{},data:i}))+'</div>\n        </a>\n      </div>\n    </div>\n\n    <div class="Talk-countdown-timer__progress hide-lg">\n      <div class="Talk-countdown-timer__progress__meter" style="width:100%"></div>\n    </div>\n  </div>\n\n  <div class="container Talk-countdown-timer__container Talk-countdown-timer__container--canceled">\n    <h2 class="Talk-countdown-timer__heading hide-lg">Related talks</h2>\n\n    <div class="row row-skinny row-lg-wide">\n      <div class="col col-oh-4">\n        <h2 class="Talk-countdown-timer__heading show-lg">Up next</h2>\n\n        <a class="ga-link undec Talk-countdown-timer__talk" href="/talks/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.slug:s,e))+'" data-ga-category="talk.countdownTalk">\n          <div class="m3">'+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.image:s,{name:"thumb",hash:{},data:i}))+'</div>\n          <div class="h12 Talk-countdown-timer__talk__speaker show-sm">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.speaker:s,e))+'</div>\n          <div class="Talk-countdown-timer__talk__title">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.nextTalk:e)?s.title:s,e))+'</div>\n          <div class="Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=(s=null!=e?e.nextTalk:e)?s.duration:s,{name:"formatDuration",hash:{},data:i}))+'</div>\n        </a>\n      </div>\n\n      <div class="col col-oh-8">\n        <div class="row row-skinny row-lg-wide show-lg">\n          <div class="col col-lg-offset-1">\n            <h2 class="Talk-countdown-timer__heading">More related talks</h2>\n          </div>\n        </div>\n\n        <div class="row row-skinny row-lg-wide">\n'+(null!=(s=t.each.call(e,null!=e?e.relatedTalks:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n"},useData:!0});return t.registerPartial("templates/talk-countdown-timer",n),n}),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;!function(e,t){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(n){return t(n,e)}):t(e.jQuery,e)}(this,function(n,i){var s,a,o,r,l,u,c,d,h,p,f,m,g,_,v,b;return s=n(i),d=e.call(i,"ontouchstart")>=0,r={horizontal:{},vertical:{}},l=1,c={},u="waypoints-context-id",f="resize.waypoints",m="scroll.waypoints",g=1,_="waypoints-waypoint-ids",v="waypoint",b="waypoints",a=function(){function e(e){var t=this;this.$element=e,this.element=e[0],this.didResize=!1,this.didScroll=!1,this.id="context"+l++,this.oldScroll={x:e.scrollLeft(),y:e.scrollTop()},this.waypoints={horizontal:{},vertical:{}},this.element[u]=this.id,c[this.id]=this,e.bind(m,function(){var e;return t.didScroll||d?void 0:(t.didScroll=!0,e=function(){return t.doScroll(),t.didScroll=!1},i.setTimeout(e,n[b].settings.scrollThrottle))}),e.bind(f,function(){var e;return t.didResize?void 0:(t.didResize=!0,e=function(){return n[b]("refresh"),t.didResize=!1},i.setTimeout(e,n[b].settings.resizeThrottle))})}return e.prototype.doScroll=function(){var e,t=this;return e={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!d||e.vertical.oldScroll&&e.vertical.newScroll||n[b]("refresh"),n.each(e,function(e,i){var s,a,o;return o=[],a=i.newScroll>i.oldScroll,s=a?i.forward:i.backward,n.each(t.waypoints[e],function(e,t){var n,s;return i.oldScroll<(n=t.offset)&&n<=i.newScroll?o.push(t):i.newScroll<(s=t.offset)&&s<=i.oldScroll?o.push(t):void 0}),o.sort(function(e,t){return e.offset-t.offset}),a||o.reverse(),n.each(o,function(e,t){return t.options.continuous||e===o.length-1?t.trigger([s]):void 0})}),this.oldScroll={x:e.horizontal.newScroll,y:e.vertical.newScroll}},e.prototype.refresh=function(){var e,t,i,s=this;return i=n.isWindow(this.element),t=this.$element.offset(),this.doScroll(),e={horizontal:{contextOffset:i?0:t.left,contextScroll:i?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:i?0:t.top,contextScroll:i?0:this.oldScroll.y,contextDimension:i?n[b]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},n.each(e,function(e,t){return n.each(s.waypoints[e],function(e,i){var s,a,o,r,l;return s=i.options.offset,o=i.offset,a=n.isWindow(i.element)?0:i.$element.offset()[t.offsetProp],n.isFunction(s)?s=s.apply(i.element):"string"==typeof s&&(s=parseFloat(s),i.options.offset.indexOf("%")>-1&&(s=Math.ceil(t.contextDimension*s/100))),i.offset=a-t.contextOffset+t.contextScroll-s,i.options.onlyOnScroll&&null!=o||!i.enabled?void 0:null!==o&&o<(r=t.oldScroll)&&r<=i.offset?i.trigger([t.backward]):null!==o&&o>(l=t.oldScroll)&&l>=i.offset?i.trigger([t.forward]):null===o&&t.oldScroll>=i.offset?i.trigger([t.forward]):void 0})})},e.prototype.checkEmpty=function(){return n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([f,m].join(" ")),delete c[this.id]):void 0},e}(),o=function(){function e(e,t,i){var s,a;i=n.extend({},n.fn[v].defaults,i),"bottom-in-view"===i.offset&&(i.offset=function(){var e;return e=n[b]("viewportHeight"),n.isWindow(t.element)||(e=t.$element.height()),e-n(this).outerHeight()}),this.$element=e,this.element=e[0],this.axis=i.horizontal?"horizontal":"vertical",this.callback=i.handler,this.context=t,this.enabled=i.enabled,this.id="waypoints"+g++,this.offset=null,this.options=i,t.waypoints[this.axis][this.id]=this,r[this.axis][this.id]=this,s=null!=(a=this.element[_])?a:[],s.push(this.id),this.element[_]=s}return e.prototype.trigger=function(e){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,e),this.options.triggerOnce?this.destroy():void 0):void 0},e.prototype.disable=function(){return this.enabled=!1},e.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},e.prototype.destroy=function(){return delete r[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},e.getWaypointsByElement=function(e){var t,i;return(i=e[_])?(t=n.extend({},r.horizontal,r.vertical),n.map(i,function(e){return t[e]})):[]},e}(),p={init:function(e,t){var i;return null==t&&(t={}),null==(i=t.handler)&&(t.handler=e),this.each(function(){var e,i,s,r;return e=n(this),s=null!=(r=t.context)?r:n.fn[v].defaults.context,n.isWindow(s)||(s=e.closest(s)),s=n(s),i=c[s[0][u]],i||(i=new a(s)),new o(e,i,t)}),n[b]("refresh"),this},disable:function(){return p._invoke.call(this,"disable")},enable:function(){return p._invoke.call(this,"enable")},destroy:function(){return p._invoke.call(this,"destroy")},prev:function(e,t){return p._traverse.call(this,e,t,function(e,t,n){return t>0?e.push(n[t-1]):void 0})},next:function(e,t){return p._traverse.call(this,e,t,function(e,t,n){return t<n.length-1?e.push(n[t+1]):void 0})},_traverse:function(e,t,s){var a,o;return null==e&&(e="vertical"),null==t&&(t=i),o=h.aggregate(t),a=[],this.each(function(){var t;return t=n.inArray(this,o[e]),s(a,t,o[e])}),this.pushStack(a)},_invoke:function(e){return this.each(function(){var t;return t=o.getWaypointsByElement(this),n.each(t,function(t,n){return n[e](),!0})}),this}},n.fn[v]=function(){var e,i;return i=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],p[i]?p[i].apply(this,e):n.isFunction(i)?p.init.apply(this,arguments):n.isPlainObject(i)?p.init.apply(this,[null,i]):n.error(i?"The "+i+" method does not exist in jQuery Waypoints.":"jQuery Waypoints needs a callback function or handler option.")},n.fn[v].defaults={context:i,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},h={refresh:function(){return n.each(c,function(e,t){return t.refresh()
})},viewportHeight:function(){var e;return null!=(e=i.innerHeight)?e:s.height()},aggregate:function(e){var t,i,s;return t=r,e&&(t=null!=(s=c[n(e)[0][u]])?s.waypoints:void 0),t?(i={horizontal:[],vertical:[]},n.each(i,function(e,s){return n.each(t[e],function(e,t){return s.push(t)}),s.sort(function(e,t){return e.offset-t.offset}),i[e]=n.map(s,function(e){return e.element}),i[e]=n.unique(i[e])}),i):[]},above:function(e){return null==e&&(e=i),h._filter(e,"vertical",function(e,t){return t.offset<=e.oldScroll.y})},below:function(e){return null==e&&(e=i),h._filter(e,"vertical",function(e,t){return t.offset>e.oldScroll.y})},left:function(e){return null==e&&(e=i),h._filter(e,"horizontal",function(e,t){return t.offset<=e.oldScroll.x})},right:function(e){return null==e&&(e=i),h._filter(e,"horizontal",function(e,t){return t.offset>e.oldScroll.x})},enable:function(){return h._invoke("enable")},disable:function(){return h._invoke("disable")},destroy:function(){return h._invoke("destroy")},extendFn:function(e,t){return p[e]=t},_invoke:function(e){var t;return t=n.extend({},r.vertical,r.horizontal),n.each(t,function(t,n){return n[e](),!0})},_filter:function(e,t,i){var s,a;return(s=c[n(e)[0][u]])?(a=[],n.each(s.waypoints[t],function(e,t){return i(s,t)?a.push(t):void 0}),a.sort(function(e,t){return e.offset-t.offset}),n.map(a,function(e){return e.element})):[]}},n[b]=function(){var e,n;return n=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],h[n]?h[n].apply(null,e):h.aggregate.call(null,n)},n[b].settings={resizeThrottle:100,scrollThrottle:30},s.load(function(){return n[b]("refresh")})})}.call(this),define("talk/countdown",["jquery","lodash","lib/ga","lib/instaplay","hbs!templates/talk-countdown-checker","hbs!templates/talk-countdown-timer","exports","waypoints"],function(e,t,n,i,s,a,o){"use strict";o.countdownPeriod=1e4,o.maxInstaplays=3,o.checkerTemplate=s,o.timerTemplate=t.wrap(a,function(e,t){return r.renderedTimer=!0,e(t)});var r=o._cache={};o.startCountdown=function(){r.renderedTimer&&(o._initCountdown(),r.targetDate||(r.targetDate=new Date(+new Date+o.countdownPeriod)))},o.pauseCountdown=function(){r.targetDate=null},o.cancelCountdown=function(){r.targetDate=null,r.intervalId&&window.clearInterval(r.intervalId),r.$timer.addClass("Talk-countdown-timer--canceled")},o.countdownInterval=function(){if(r.targetDate){var e=r.targetDate-new Date;0>=e?(o.countdownStep(0),o.countdownReached()):o.countdownStep(e)}},o.countdownStep=function(e){r.$meter.css({width:e/o.countdownPeriod*100+"%"}),r.$remaining.text(e>0?Math.round(e/1e3):"0")},o.countdownReached=function(){r.targetDate=null;var e=r.$timer.find("a.Talk-countdown-timer__talk--next").attr("href");n.sendEvent("talk.countdownTalk","force",e),i.set(e,{clearHistory:!1}),window.location.href=e},o.hasMaxed=function(){return i.recentMatches(/\/talks\//).length>=o.maxInstaplays},o.getNext=function(e){if(e&&e.length){var t=i.recentMatches(/\/talks\//);if(!t.length)return e[0];for(var n=0,s=e.length;s>n;n++){for(var a=e[n],o=new RegExp("/talks/"+a.slug),r=!0,l=0,u=t.length;u>l;l++)r=r&&!t[l].match(o);if(r)return a}}},o.template=function(e){return o.hasMaxed()?o.checkerTemplate(e):o.timerTemplate(e)},o._initCountdown=function(){if(!r.initedCounter){r.initedCounter=!0;var t=e("div.Talk-countdown-timer");r.$timer=t,r.$remaining=t.find("span.Talk-countdown-timer__remaining"),r.$meter=t.find("div.Talk-countdown-timer__progress__meter"),r.$remaining.waypoint(function(e){"up"===e?o.startCountdown():o.pauseCountdown()}),r.intervalId=window.setInterval(o.countdownInterval,100),t.find("a.Talk-countdown-timer__cancel").click(function(e){e.preventDefault(),o.cancelCountdown()})}}}),define("utils/query_param",[],function(){"use strict";return function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}}),define("hbs!templates/talkArticle",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="talk-article">\n  <div class="container">\n    <div class="talk-article__container">\n    </div>\n  </div>\n</div>\n'},useData:!0});return t.registerPartial("templates/talkArticle",n),n}),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("spinjs",t):e.Spinner=t()}(this,function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var s=["opacity",t,~~(100*e),n,i].join("-"),a=.01+n/i*100,o=Math.max(1-(1-e)/t*(100-a),e),r=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=r&&"-"+r+"-"||"";return h[s]||(p.insertRule("@"+l+"keyframes "+s+"{0%{opacity:"+o+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+t)%100+"%{opacity:"+e+"}100%{opacity:"+o+"}}",p.cssRules.length),h[s]=1),s}function i(e,t){var n,i,s=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<d.length;i++)if(n=d[i]+t,void 0!==s[n])return n;return void 0!==s[t]?t:void 0}function s(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function a(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function o(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function r(e,t){return"string"==typeof e?e:e[t%e.length]}function l(e){return"undefined"==typeof this?new l(e):void(this.opts=a(e||{},l.defaults,f))}function u(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}p.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(e,i){function a(){return s(n("group",{coordsize:c+" "+c,coordorigin:-u+" "+-u}),{width:c,height:c})}function o(e,o,l){t(h,t(s(a(),{rotation:360/i.lines*e+"deg",left:~~o}),t(s(n("roundrect",{arcsize:i.corners}),{width:u,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:r(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,u=i.length+i.width,c=2*u,d=2*-(i.width+i.length)+"px",h=s(a(),{position:"absolute",top:d,left:d});if(i.shadow)for(l=1;l<=i.lines;l++)o(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)o(l);return t(e,h)},l.prototype.opacity=function(e,t,n,i){var s=e.firstChild;i=i.shadow&&i.lines||0,s&&t+i<s.childNodes.length&&(s=s.childNodes[t+i],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=n))}}var c,d=["webkit","Moz","ms","O"],h={},p=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},a(l.prototype,{spin:function(t){this.stop();var n,i,a=this,r=a.opts,l=a.el=s(e(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex}),u=r.radius+r.length+r.width;if(t&&(t.insertBefore(l,t.firstChild||null),i=o(t),n=o(l),s(l,{left:("auto"==r.left?i.x-n.x+(t.offsetWidth>>1):parseInt(r.left,10)+u)+"px",top:("auto"==r.top?i.y-n.y+(t.offsetHeight>>1):parseInt(r.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),a.lines(l,a.opts),!c){var d,h=0,p=(r.lines-1)*(1-r.direction)/2,f=r.fps,m=f/r.speed,g=(1-r.opacity)/(m*r.trail/100),_=m/r.lines;!function v(){h++;for(var e=0;e<r.lines;e++)d=Math.max(1-(h+(r.lines-e)*_)%m*g,r.opacity),a.opacity(l,e*r.direction+p,d,r);a.timeout=a.el&&setTimeout(v,~~(1e3/f))}()}return a},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,a){function o(t,n){return s(e(),{position:"absolute",width:a.length+a.width+"px",height:a.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/a.lines*u+a.rotate)+"deg) translate("+a.radius+"px,0)",borderRadius:(a.corners*a.width>>1)+"px"})}for(var l,u=0,d=(a.lines-1)*(1-a.direction)/2;u<a.lines;u++)l=s(e(),{position:"absolute",top:1+~(a.width/2)+"px",transform:a.hwaccel?"translate3d(0,0,0)":"",opacity:a.opacity,animation:c&&n(a.opacity,a.trail,d+u*a.direction,a.lines)+" "+1/a.speed+"s linear infinite"}),a.shadow&&t(l,s(o("#000","0 0 4px #000"),{top:"2px"})),t(i,t(l,o(r(a.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var m=s(e("group"),{behavior:"url(#default#VML)"});return!i(m,"transform")&&m.adj?u():c=i(m,"animation"),l}),define("jqueryui/widget",["jquery"],function(e){return function(e,t){var n=0,i=Array.prototype.slice,s=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(a){}s(t)},e.widget=function(t,n,i){var s,a,o,r,l={},u=t.split(".")[0];t=t.split(".")[1],s=u+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[u]=e[u]||{},a=e[u][t],o=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,a,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),r=new n,r.options=e.widget.extend({},r.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},s=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,a=this._superApply;return this._super=e,this._superApply=s,t=i.apply(this,arguments),this._super=n,this._superApply=a,t}}()):void(l[t]=i)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},l,{constructor:o,namespace:u,widgetName:t,widgetFullName:s}),a?(e.each(a._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete a._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var s,a,o=i.call(arguments,1),r=0,l=o.length;l>r;r++)for(s in o[r])a=o[r][s],o[r].hasOwnProperty(s)&&a!==t&&(n[s]=e.isPlainObject(a)?e.isPlainObject(n[s])?e.widget.extend({},n[s],a):e.widget.extend({},a):a);return n},e.widget.bridge=function(n,s){var a=s.prototype.widgetFullName||n;e.fn[n]=function(o){var r="string"==typeof o,l=i.call(arguments,1),u=this;return o=!r&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,this.each(r?function(){var i,s=e.data(this,a);return s?e.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,l),i!==s&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")}:function(){var t=e.data(this,a);t?t.option(o||{})._init():e.data(this,a,new s(o,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var s,a,o,r=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(r={},s=n.split("."),n=s.shift(),s.length){for(a=r[n]=e.widget.extend({},this.options[n]),o=0;o<s.length-1;o++)a[s[o]]=a[s[o]]||{},a=a[s[o]];if(n=s.pop(),1===arguments.length)return a[n]===t?null:a[n];a[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];r[n]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var s,a=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=s=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,s=this.widget()),e.each(i,function(i,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),u=l[1]+a.eventNamespace,c=l[2];c?s.delegate(c,u,r):n.bind(u,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var s,a,o=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],a=n.originalEvent)for(s in a)s in n||(n[s]=a[s]);return this.element.trigger(n,i),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,s,a){"string"==typeof s&&(s={effect:s});var o,r=s?s===!0||"number"==typeof s?n:s.effect||n:t;s=s||{},"number"==typeof s&&(s={duration:s}),o=!e.isEmptyObject(s),s.complete=a,s.delay&&i.delay(s.delay),o&&e.effects&&e.effects.effect[r]?i[t](s):r!==t&&i[r]?i[r](s.duration,s.easing,a):i.queue(function(n){e(this)[t](),a&&a.call(i[0]),n()})}})}(e),e}),define("transit",["jquery"],function(e){return function(e){function t(e){if(e in d.style)return e;var t=["Moz","Webkit","O","ms"],n=e.charAt(0).toUpperCase()+e.substr(1);if(e in d.style)return e;for(var i=0;i<t.length;++i){var s=t[i]+n;if(s in d.style)return s}}function n(){return d.style[h.transform]="",d.style[h.transform]="rotateY(90deg)",""!==d.style[h.transform]}function i(e){return"string"==typeof e&&this.parse(e),this}function s(e,t,n){t===!0?e.queue(n):t?e.queue(t,n):n()}function a(t){var n=[];return e.each(t,function(t){t=e.camelCase(t),t=e.transit.propertyMap[t]||e.cssProps[t]||t,t=l(t),-1===e.inArray(t,n)&&n.push(t)}),n}function o(t,n,i,s){var o=a(t);e.cssEase[i]&&(i=e.cssEase[i]);var r=""+c(n)+" "+i;parseInt(s,10)>0&&(r+=" "+c(s));var l=[];return e.each(o,function(e,t){l.push(t+" "+r)}),l.join(", ")}function r(t,n){n||(e.cssNumber[t]=!0),e.transit.propertyMap[t]=h.transform,e.cssHooks[t]={get:function(n){var i=e(n).css("transit:transform");return i.get(t)},set:function(n,i){var s=e(n).css("transit:transform");s.setFromString(t,i),e(n).css({"transit:transform":s})}}}function l(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function u(e,t){return"string"!=typeof e||e.match(/^[\-0-9\.]+$/)?""+e+t:e}function c(t){var n=t;return e.fx.speeds[n]&&(n=e.fx.speeds[n]),u(n,"ms")}e.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var d=document.createElement("div"),h={},p=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;h.transition=t("transition"),h.transitionDelay=t("transitionDelay"),h.transform=t("transform"),h.transformOrigin=t("transformOrigin"),h.transform3d=n();var f={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},m=h.transitionEnd=f[h.transition]||null;for(var g in h)h.hasOwnProperty(g)&&"undefined"==typeof e.support[g]&&(e.support[g]=h[g]);d=null,e.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},e.cssHooks["transit:transform"]={get:function(t){return e(t).data("transform")||new i},set:function(t,n){var s=n;s instanceof i||(s=new i(s)),t.style[h.transform]="WebkitTransform"!==h.transform||p?s.toString():s.toString(!0),e(t).data("transform",s)}},e.cssHooks.transform={set:e.cssHooks["transit:transform"].set},e.fn.jquery<"1.8"&&(e.cssHooks.transformOrigin={get:function(e){return e.style[h.transformOrigin]},set:function(e,t){e.style[h.transformOrigin]=t}},e.cssHooks.transition={get:function(e){return e.style[h.transition]},set:function(e,t){e.style[h.transition]=t}}),r("scale"),r("translate"),r("rotate"),r("rotateX"),r("rotateY"),r("rotate3d"),r("perspective"),r("skewX"),r("skewY"),r("x",!0),r("y",!0),i.prototype={setFromString:function(e,t){var n="string"==typeof t?t.split(","):t.constructor===Array?t:[t];n.unshift(e),i.prototype.set.apply(this,n)},set:function(e){var t=Array.prototype.slice.apply(arguments,[1]);this.setter[e]?this.setter[e].apply(this,t):this[e]=t.join(",")},get:function(e){return this.getter[e]?this.getter[e].apply(this):this[e]||0},setter:{rotate:function(e){this.rotate=u(e,"deg")},rotateX:function(e){this.rotateX=u(e,"deg")},rotateY:function(e){this.rotateY=u(e,"deg")},scale:function(e,t){void 0===t&&(t=e),this.scale=e+","+t},skewX:function(e){this.skewX=u(e,"deg")},skewY:function(e){this.skewY=u(e,"deg")},perspective:function(e){this.perspective=u(e,"px")},x:function(e){this.set("translate",e,null)},y:function(e){this.set("translate",null,e)},translate:function(e,t){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==e&&void 0!==e&&(this._translateX=u(e,"px")),null!==t&&void 0!==t&&(this._translateY=u(t,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var e=(this.scale||"1,1").split(",");return e[0]&&(e[0]=parseFloat(e[0])),e[1]&&(e[1]=parseFloat(e[1])),e[0]===e[1]?e[0]:e},rotate3d:function(){for(var e=(this.rotate3d||"0,0,0,0deg").split(","),t=0;3>=t;++t)e[t]&&(e[t]=parseFloat(e[t]));return e[3]&&(e[3]=u(e[3],"deg")),e}},parse:function(e){var t=this;e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(e,n,i){t.setFromString(n,i)})},toString:function(e){var t=[];for(var n in this)if(this.hasOwnProperty(n)){if(!h.transform3d&&("rotateX"===n||"rotateY"===n||"perspective"===n||"transformOrigin"===n))continue;"_"!==n[0]&&t.push(e&&"scale"===n?n+"3d("+this[n]+",1)":e&&"translate"===n?n+"3d("+this[n]+",0)":n+"("+this[n]+")")}return t.join(" ")}},e.fn.transition=e.fn.transit=function(t,n,i,a){var r=this,l=0,u=!0;"function"==typeof n&&(a=n,n=void 0),"function"==typeof i&&(a=i,i=void 0),"undefined"!=typeof t.easing&&(i=t.easing,delete t.easing),"undefined"!=typeof t.duration&&(n=t.duration,delete t.duration),"undefined"!=typeof t.complete&&(a=t.complete,delete t.complete),"undefined"!=typeof t.queue&&(u=t.queue,delete t.queue),"undefined"!=typeof t.delay&&(l=t.delay,delete t.delay),"undefined"==typeof n&&(n=e.fx.speeds._default),"undefined"==typeof i&&(i=e.cssEase._default),n=c(n);var d=o(t,n,i,l),p=e.transit.enabled&&h.transition,f=p?parseInt(n,10)+parseInt(l,10):0;if(0===f){var g=function(e){r.css(t),a&&a.apply(r),e&&e()};return s(r,u,g),r}var _={},v=function(n){var i=!1,s=function(){i&&r.unbind(m,s),f>0&&r.each(function(){this.style[h.transition]=_[this]||null}),"function"==typeof a&&a.apply(r),"function"==typeof n&&n()};f>0&&m&&e.transit.useTransitionEnd?(i=!0,r.bind(m,s)):window.setTimeout(s,f),r.each(function(){f>0&&(this.style[h.transition]=d),e(this).css(t)})},b=function(e){var t=0;"MozTransition"===h.transition&&25>t&&(t=25),window.setTimeout(function(){v(e)},t)};return s(r,u,b),this},e.transit.getTransitionValue=o}(e),e}),define("widgets/talkArticle",["jquery","lodash","jqueryui/widget","transit"],function(e,t){"use strict";function n(){a.show(),a.removeClass(c)}function i(){a.hide()}var s,a,o,r,l,u=300,c="talk-article--main--collapsed",d=t.once(function(){s=e("#talk-pusher"),a=e("#talk"),o=e("body,html"),r=e("#player-hero"),l=r.find("div.player-hero__banner")});return e.widget("ted.talkArticle",{options:{autoShow:!0},_create:function(){var e=this;d(),this.element.hide(),a.after(this.element),this._on("a.talk-article__return__link",{click:function(t){t.preventDefault(),e.hide()}}),this.options.autoShow&&this.show()},show:function(){this.element.fadeIn(u),a.addClass(c),s.transition({duration:u,marginTop:0-a.outerHeight(),complete:i}),o.animate({scrollTop:l.offset().top+l.outerHeight()},u),this._trigger("show")},hide:function(){this.element.fadeOut(u),a.show(),s.transition({duration:u,marginTop:0,complete:n}),this._trigger("hide")}}),function(t,n){return e(t).talkArticle(n)}}),define("widgets/talkArticleLink",["jquery","lodash","hbs!templates/talkArticle","spinjs","widgets/talkArticle"],function(e,t,n,i){"use strict";var s="talk-article-link",a="talk-article-link--loading";return e.widget("ted.talkArticleLink",{options:{articleUrl:null,returnUrl:window.location.href,unpopped:!1},_create:function(){var e=this;this.options.articleUrl||(this.options.articleUrl=this.element.attr("href")),this.element.addClass(s),this._on(this.element,this._handleEvents),this._on(window,{popstate:function(){e.options.unpopped&&(e.options.unpopped=!1,e.article.talkArticle("hide"))}})},_handleEvents:{click:function(e){e.preventDefault(),this.showArticle()}},_onShow:function(){this._trigger("show")},_onHide:function(){window.history&&history.pushState&&this.options.unpopped&&(this.options.unpopped=!1,history.back()),this._trigger("hide")},article:null,loadUrl:function(s){var o=this;o.article&&o.article.remove();var r=e(n());r.addClass("talk-article--loading"),o.article=r,o.article.talkArticle({show:t.bind(o._onShow,o),hide:t.bind(o._onHide,o)}),this.article.talkArticle("show"),this._spinner||(this._spinner=new i),this._spinner.spin(o.article.find("div.talk-article__container")[0]),this.options.articleUrl=s,this.element.addClass(a),s+=(s.match(/\?/)?"&":"?")+"talkarticle=true",e.get(s).then(t.bind(this.loadHtml,this))},loadHtml:function(n){var i=!0,s=this;window.history&&window.history.pushState&&!s.options.unpopped&&(i=!1),s.article&&(this._spinner.stop(),s.article.remove()),s.article=e(n).find("div.talk-article"),s.article.talkArticle({autoShow:i,show:t.bind(s._onShow,s),hide:t.bind(s._onHide,s)}),s.element.removeClass(a)},showArticle:function(){var e=this;e.element.hasClass(a)||(this.article?this.article.talkArticle("show"):this.loadUrl(this.options.articleUrl),window.history&&history.pushState&&(history.pushState(null,null,this.options.articleUrl),this.options.unpopped=!0))}}),function(t,n){return e(t).talkArticle(n)}}),define("talk/transcript",["jquery","lodash","lib/ga","widgets/talkArticleLink"],function(e,t,n){"use strict";function i(e){var n,i;return n=t.findIndex(v,function(t){return i=t===e,i||t>e}),1>n&&!i?!1:g.eq(n-(i?0:1))}function s(t){_=t,p=e("#open-transcript"),d(),p.talkArticleLink({show:r}),p.on("click",function(){n.sendEvent("talk.transcript","show","talk details")}),e("#hero-transcript-link").on("click",function(e){e.preventDefault(),p.data("ted-talkArticleLink").showArticle(),n.sendEvent("talk.transcript","show","hero")}),e("#player-hero").on("click","a.controls__transcript",function(e){e.preventDefault(),p.data("ted-talkArticleLink").showArticle(),n.sendEvent("talk.transcript","show","controls")})}function a(){h||(h=e("div.talk-transcript").first()),g=h.find("span.talk-transcript__fragment"),v=g.map(function(t,n){return+e(n).data("time")}).toArray(),h.on("click","span.talk-transcript__fragment",l),k.player&&k.player.on("playercurrenttime",function(e,t){u(t.currentTime)}),u()}function o(){h&&h.parent().length||(h=p.data("ted-talkArticleLink").article,a())}function r(){o()}function l(){var t=+e(this).data("time"),i=Math.floor((_.offset+t)/1e3);k.player&&(k.player.player("seek",i),n.sendEvent("player","seek","transcript",i)),window.history&&history.pushState&&history.pushState(null,null,location.href.split("#")[0]+"#t-"+t)}function u(e){e||(e=w),c(1e3*e-_.offset),w=e}function c(e){var t=i(e);t&&t!==f&&(f&&(f.removeClass(b),m.removeClass(y)),f=t.addClass(b),m=t.closest("p.talk-transcript__para").addClass(y))}function d(){e(document).on("change","select.talk-transcript__language",function(){var t=e(this),n="/talks/"+t.data("slug")+"/transcript?language="+t.val();p?p.talkArticleLink("loadUrl",n):location.href=n})}var h,p,f,m,g,_,v,b="talk-transcript__fragment--current",y="talk-transcript__para--current",w=0,k={player:null};return k.initArticle=a,k.initLanguages=t.once(d),k.initLink=s,k}),define("widgets/ad",["lodash","jquery","jqueryui/widget"],function(e,t){"use strict";t.widget("ted.ad",{_rendered:!1,$image:null,$text:null,$link:null,blocked:function(){this.element.hide()},refreshJsonAd:function(){if(this.options.blocked)return void this.blocked();if(this._rendered||(this._addAdClass(),this.element.children().addClass("ad__prefill"),this.options.ad.houseAd||this._getAppreciationText().appendTo(this.element),this.$link=t('<a class="ad__unit" href="#" rel="nofollow" target="_blank">').appendTo(this.element),this.$image=t("<img>").appendTo(this.$link),this._rendered=!0),!this.options.ad)return void this.element.hide();var e=this._getRenderDetails();this.$link.attr("href",e.click),this.$image.attr({src:e.currentCreative.url,width:e.dimensions.width,height:e.dimensions.height}),this.element[this.options.ad.hasDisplay===!1?"hide":"show"](),this._impress()},refreshHtmlAd:function(){this._addAdClass(),this._getAppreciationText().prependTo(this.element)},_init:function(){var e=String(this.options.mode);this._rendered=!1,"json"===e?this.refreshJsonAd():"html"===e&&this.refreshHtmlAd()},_fireImpression:function(e){var t=new Image;t.src=e},_impress:function(){this._fireImpression(this.options.ad.impression),e.forEach(this.options.ad.thirdPartyImpressions,this._fireImpression)},_getCreative:function(){var t=e.filter(this.options.ad.creative,function(e){return""!==e.url}),n=Math.max(window.devicePixelRatio||1,1);return e.reduce(t,function(e,t){return t.density<=n?t:e||t},{})},_getRenderDetails:function(){return e.extend({currentCreative:this._getCreative()},this.options.ad)},_getAppreciationText:function(){return this.$text=t('<div class="ad__text">TED Talks are free thanks to support from</div>'),this.$text},_addAdClass:function(){this.element.addClass("ad")}})}),define("hbs!templates/sponsorshipBug",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'\n<a class="sponsorship-bug__link media" href="#" rel="nofollow" target="_blank">\n  <div class="sponsorship-bug__image media__image media__image--alt">\n    <img src="" alt="">\n  </div>\n  <div class="sponsorship-bug__message media__message">\n    TED Talks are free<br>\n    thanks to support from\n  </div>\n</a>\n'},useData:!0});return t.registerPartial("templates/sponsorshipBug",n),n}),define("templates/helpers/assetUrl",["Handlebars"],function(e){"use strict";function t(e){return TED.assetHost+e}return e.registerHelper("assetUrl",t),t}),define("hbs!templates/sponsorshipBugBlocked",["hbs","hbs/handlebars","templates/helpers/assetUrl"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<a class="sponsorship-bug__nag" href="http://support.ted.com/customer/portal/articles/1532436-how-can-i-support-ted-by-modifying-my-ad-blocker-settings" target="_blank">\n  <img class="sponsorship-bug__nag__image" src="'+this.escapeExpression((t.assetUrl||e&&e.assetUrl||t.helperMissing).call(e,"/temp/ad-blocker-bug.png",{name:"assetUrl",hash:{},data:i}))+'" alt="Show your support by unblocking ted.com from ad blockers">\n</a>\n'},useData:!0});return t.registerPartial("templates/sponsorshipBugBlocked",n),n}),define("widgets/sponsorshipBug",["jquery","hbs!templates/sponsorshipBug","hbs!templates/sponsorshipBugBlocked","widgets/ad"],function(e,t,n){"use strict";e.widget("ted.sponsorshipBug",e.ted.ad,{blocked:function(){this.element.html(n()),this.element.show(),this._rendered=!1},refreshJsonAd:function(){return this.options.blocked?this.blocked():(this._rendered||(this.element.children().addClass("sponsorship-bug__prefill"),this.element.append(t()),this.$image=this.element.find("img"),this.$link=this.element.find("a.sponsorship-bug__link"),this._rendered=!0),void this._super())},_init:function(){this.element.addClass("sponsorship-bug"),this._super()}})}),define("lib/ads",["jquery","lodash","utils/query_param","exports","widgets/ad","widgets/sponsorshipBug"],function(e,t,n,i){"use strict";function s(t){var n=String(t.type),i=d[t.type];"master"===n?h.deferred.resolve(t):void 0===i?window.console&&console.log&&(console.log("Unknown ad type"),console.log(t)):e(i.id)[i.widget]({ad:t,mode:"json"})}function a(n){t.forEach(h.companionAdSlots,function(t){if(t.gptSlot.setTargeting(t.key,n.target),t.displayed){var s=e("#"+t.containerId);s.data("tedAd")?s.ad("destroy"):s.data("sponsorshipBug")&&s.sponsorshipBug("destroy"),i.refreshAd(t.gptSlot)}else i.displayAd(t.containerId);t.displayed=!0}),u(n.impression)}function o(e){i.player.player("sendAds",{postroll:r(e.postrollURL),preroll:r(e.prerollURL)})}function r(e){return e.replace("{adUnit}",h.slot.adUnit)}function l(t){var n=i.player=t;if(n){var r=i.playerMode=String(n.player("mode"));if("hls"===r)n.on({playerad:function(e,t){s(t.ad)}});else{h.deferred.done(a),n.on({playeradblock:function(){var t=d.bug;e(t.id)[t.widget]({blocked:!0})}});var l=!0;n.on({playertalk:function(e,t){var s=String(n.player("talks")[0].id),a=String(t.id);
l&&s===a?(l=!1,"flash"===r&&h.deferred.done(o)):i.refreshMasterAd({targeting:t.targeting}),l=!1}})}}}function u(e){var t=new Image;t.src=e}function c(){t.forEach(h.slot.targeting,function(e,n){h.slot.gptSlot.setTargeting(n,t.isArray(e)?e.join(","):e)});var e=n("dfptest");e&&h.slot.gptSlot.setTargeting("dfptest",e)}var d={bug:{id:"#sponsorship-bug-placeholder",widget:"sponsorshipBug"},companion:{id:"#ad-unit",widget:"ad"},"companion-mobile":{id:"#ad-unit-mobile",widget:"ad"},devil:{id:"#devil-ad",widget:"ad"},onPage:{id:"#ad-unit",widget:"ad"}},h={companionAdSlots:[],deferred:e.Deferred(),slot:{adUnit:null,containerId:null,gptSlot:null,targeting:{}}};i._masterAd=h,i.player=null,window.googletag=window.googletag||{cmd:[]},i.slotRenderEndedHandler=function(n){var i=t.find(h.companionAdSlots,function(e){return e.gptSlot===n.slot});if(!n.isEmpty&&i){var s=String(i.containerId);if("ad-unit"===s){var a=e("#ad-unit"),o=a.data("tedAd");o||a.ad({mode:"html"})}}},i.displayMasterAd=function(e){h.slot.containerId=e.containerId,h.slot.adUnit=e.adUnit,window.googletag.cmd.push(function(){h.slot.gptSlot=googletag.defineOutOfPageSlot(h.slot.adUnit,h.slot.containerId).addService(googletag.pubads()),t.assign(h.slot.targeting,e.targeting),c(),i.displayAd(h.slot.containerId)})},i.refreshMasterAd=function(n){"hls"!==i.playerMode&&(h.deferred=e.Deferred(),h.deferred.done(a),"flash"===i.playerMode&&h.deferred.done(o),h.slot.gptSlot.clearTargeting(),t.forEach(h.companionAdSlots,function(e){e.gptSlot.clearTargeting()}),t.assign(h.slot.targeting,n.targeting),c(),i.refreshAd(h.slot.gptSlot))},i.displayAd=function(t){e(function(){window.googletag.cmd.push(function(){googletag.display(t)})})},i.refreshAd=function(e){window.googletag.cmd.push(function(){googletag.pubads().refresh([e])})},i.createCompanionSlot=function(e){window.googletag.cmd.push(function(){var t=googletag.defineSlot(e.adUnit,e.size,e.containerId).addService(googletag.pubads());h.companionAdSlots.push({containerId:e.containerId,gptSlot:t,key:e.key})})},i.initPlayer=l,i.gptAd=function(e){s(e.ad)},window.googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",i.slotRenderEndedHandler)})}),define("flot",["jquery"],function(e){return function(e){e.color={},e.color.make=function(t,n,i,s){var a={};return a.r=t||0,a.g=n||0,a.b=i||0,a.a=null!=s?s:1,a.add=function(e,t){for(var n=0;n<e.length;++n)a[e.charAt(n)]+=t;return a.normalize()},a.scale=function(e,t){for(var n=0;n<e.length;++n)a[e.charAt(n)]*=t;return a.normalize()},a.toString=function(){return a.a>=1?"rgb("+[a.r,a.g,a.b].join(",")+")":"rgba("+[a.r,a.g,a.b,a.a].join(",")+")"},a.normalize=function(){function e(e,t,n){return e>t?e:t>n?n:t}return a.r=e(0,parseInt(a.r),255),a.g=e(0,parseInt(a.g),255),a.b=e(0,parseInt(a.b),255),a.a=e(0,a.a,1),a},a.clone=function(){return e.color.make(a.r,a.b,a.g,a.a)},a.normalize()},e.color.extract=function(t,n){var i;do{if(i=t.css(n).toLowerCase(),""!=i&&"transparent"!=i)break;t=t.parent()}while(t.length&&!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==i&&(i="transparent"),e.color.parse(i)},e.color.parse=function(n){var i,s=e.color.make;if(i=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return s(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10));if(i=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return s(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),parseFloat(i[4]));if(i=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return s(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]));if(i=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return s(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]),parseFloat(i[4]));if(i=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return s(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16));if(i=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return s(parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16));var a=e.trim(n).toLowerCase();return"transparent"==a?s(255,255,255,0):(i=t[a]||[0,0,0],s(i[0],i[1],i[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(e),function(e){function t(t,n){var i=n.children("."+t)[0];if(null==i&&(i=document.createElement("canvas"),i.className=t,e(i).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n),!i.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");i=window.G_vmlCanvasManager.initElement(i)}this.element=i;var s=this.context=i.getContext("2d"),a=window.devicePixelRatio||1,o=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1;this.pixelRatio=a/o,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={}}function n(n,s,a,o){function r(e,t){t=[gt].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function l(){for(var n={Canvas:t},i=0;i<o.length;++i){var s=o[i];s.init(gt,n),s.options&&e.extend(!0,st,s.options)}}function u(t){e.extend(!0,st,t),t&&t.colors&&(st.colors=t.colors),null==st.xaxis.color&&(st.xaxis.color=e.color.parse(st.grid.color).scale("a",.22).toString()),null==st.yaxis.color&&(st.yaxis.color=e.color.parse(st.grid.color).scale("a",.22).toString()),null==st.xaxis.tickColor&&(st.xaxis.tickColor=st.grid.tickColor||st.xaxis.color),null==st.yaxis.tickColor&&(st.yaxis.tickColor=st.grid.tickColor||st.yaxis.color),null==st.grid.borderColor&&(st.grid.borderColor=st.grid.color),null==st.grid.tickColor&&(st.grid.tickColor=e.color.parse(st.grid.color).scale("a",.22).toString());var i,s,a,o=n.css("font-size"),l=o?+o.replace("px",""):13,u={style:n.css("font-style"),size:Math.round(.8*l),variant:n.css("font-variant"),weight:n.css("font-weight"),family:n.css("font-family")};for(a=st.xaxes.length||1,i=0;a>i;++i)s=st.xaxes[i],s&&!s.tickColor&&(s.tickColor=s.color),s=e.extend(!0,{},st.xaxis,s),st.xaxes[i]=s,s.font&&(s.font=e.extend({},u,s.font),s.font.color||(s.font.color=s.color),s.font.lineHeight||(s.font.lineHeight=Math.round(1.15*s.font.size)));for(a=st.yaxes.length||1,i=0;a>i;++i)s=st.yaxes[i],s&&!s.tickColor&&(s.tickColor=s.color),s=e.extend(!0,{},st.yaxis,s),st.yaxes[i]=s,s.font&&(s.font=e.extend({},u,s.font),s.font.color||(s.font.color=s.color),s.font.lineHeight||(s.font.lineHeight=Math.round(1.15*s.font.size)));for(st.xaxis.noTicks&&null==st.xaxis.ticks&&(st.xaxis.ticks=st.xaxis.noTicks),st.yaxis.noTicks&&null==st.yaxis.ticks&&(st.yaxis.ticks=st.yaxis.noTicks),st.x2axis&&(st.xaxes[1]=e.extend(!0,{},st.xaxis,st.x2axis),st.xaxes[1].position="top"),st.y2axis&&(st.yaxes[1]=e.extend(!0,{},st.yaxis,st.y2axis),st.yaxes[1].position="right"),st.grid.coloredAreas&&(st.grid.markings=st.grid.coloredAreas),st.grid.coloredAreasColor&&(st.grid.markingsColor=st.grid.coloredAreasColor),st.lines&&e.extend(!0,st.series.lines,st.lines),st.points&&e.extend(!0,st.series.points,st.points),st.bars&&e.extend(!0,st.series.bars,st.bars),null!=st.shadowSize&&(st.series.shadowSize=st.shadowSize),null!=st.highlightColor&&(st.series.highlightColor=st.highlightColor),i=0;i<st.xaxes.length;++i)g(ct,i+1).options=st.xaxes[i];for(i=0;i<st.yaxes.length;++i)g(dt,i+1).options=st.yaxes[i];for(var c in mt)st.hooks[c]&&st.hooks[c].length&&(mt[c]=mt[c].concat(st.hooks[c]));r(mt.processOptions,[st])}function c(e){it=d(e),_(),v()}function d(t){for(var n=[],i=0;i<t.length;++i){var s=e.extend(!0,{},st.series);null!=t[i].data?(s.data=t[i].data,delete t[i].data,e.extend(!0,s,t[i]),t[i].data=s.data):s.data=t[i],n.push(s)}return n}function h(e,t){var n=e[t+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function p(){return e.grep(ct.concat(dt),function(e){return e})}function f(e){var t,n,i={};for(t=0;t<ct.length;++t)n=ct[t],n&&n.used&&(i["x"+n.n]=n.c2p(e.left));for(t=0;t<dt.length;++t)n=dt[t],n&&n.used&&(i["y"+n.n]=n.c2p(e.top));return void 0!==i.x1&&(i.x=i.x1),void 0!==i.y1&&(i.y=i.y1),i}function m(e){var t,n,i,s={};for(t=0;t<ct.length;++t)if(n=ct[t],n&&n.used&&(i="x"+n.n,null==e[i]&&1==n.n&&(i="x"),null!=e[i])){s.left=n.p2c(e[i]);break}for(t=0;t<dt.length;++t)if(n=dt[t],n&&n.used&&(i="y"+n.n,null==e[i]&&1==n.n&&(i="y"),null!=e[i])){s.top=n.p2c(e[i]);break}return s}function g(t,n){return t[n-1]||(t[n-1]={n:n,direction:t==ct?"x":"y",options:e.extend(!0,{},t==ct?st.xaxis:st.yaxis)}),t[n-1]}function _(){var t,n=it.length,i=-1;for(t=0;t<it.length;++t){var s=it[t].color;null!=s&&(n--,"number"==typeof s&&s>i&&(i=s))}i>=n&&(n=i+1);var a,o=[],r=st.colors,l=r.length,u=0;for(t=0;n>t;t++)a=e.color.parse(r[t%l]||"#666"),t%l==0&&t&&(u=u>=0?.5>u?-u-.2:0:-u),o[t]=a.scale("rgb",1+u);var c,d=0;for(t=0;t<it.length;++t){if(c=it[t],null==c.color?(c.color=o[d].toString(),++d):"number"==typeof c.color&&(c.color=o[c.color].toString()),null==c.lines.show){var p,f=!0;for(p in c)if(c[p]&&c[p].show){f=!1;break}f&&(c.lines.show=!0)}null==c.lines.zero&&(c.lines.zero=!!c.lines.fill),c.xaxis=g(ct,h(c,"x")),c.yaxis=g(dt,h(c,"y"))}}function v(){function t(e,t,n){t<e.datamin&&t!=-v&&(e.datamin=t),n>e.datamax&&n!=v&&(e.datamax=n)}var n,i,s,a,o,l,u,c,d,h,f,m,g=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,v=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=g,t.datamax=_,t.used=!1}),n=0;n<it.length;++n)o=it[n],o.datapoints={points:[]},r(mt.processRawData,[o,o.data,o.datapoints]);for(n=0;n<it.length;++n){if(o=it[n],f=o.data,m=o.datapoints.format,!m){if(m=[],m.push({x:!0,number:!0,required:!0}),m.push({y:!0,number:!0,required:!0}),o.bars.show||o.lines.show&&o.lines.fill){var b=!!(o.bars.show&&o.bars.zero||o.lines.show&&o.lines.zero);m.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:b}),o.bars.horizontal&&(delete m[m.length-1].y,m[m.length-1].x=!0)}o.datapoints.format=m}if(null==o.datapoints.pointsize){o.datapoints.pointsize=m.length,u=o.datapoints.pointsize,l=o.datapoints.points;var y=o.lines.show&&o.lines.steps;for(o.xaxis.used=o.yaxis.used=!0,i=s=0;i<f.length;++i,s+=u){h=f[i];var w=null==h;if(!w)for(a=0;u>a;++a)c=h[a],d=m[a],d&&(d.number&&null!=c&&(c=+c,isNaN(c)?c=null:1/0==c?c=v:c==-1/0&&(c=-v)),null==c&&(d.required&&(w=!0),null!=d.defaultValue&&(c=d.defaultValue))),l[s+a]=c;if(w)for(a=0;u>a;++a)c=l[s+a],null!=c&&(d=m[a],d.autoscale!==!1&&(d.x&&t(o.xaxis,c,c),d.y&&t(o.yaxis,c,c))),l[s+a]=null;else if(y&&s>0&&null!=l[s-u]&&l[s-u]!=l[s]&&l[s-u+1]!=l[s+1]){for(a=0;u>a;++a)l[s+u+a]=l[s+a];l[s+1]=l[s-u+1],s+=u}}}}for(n=0;n<it.length;++n)o=it[n],r(mt.processDatapoints,[o,o.datapoints]);for(n=0;n<it.length;++n){o=it[n],l=o.datapoints.points,u=o.datapoints.pointsize,m=o.datapoints.format;var k=g,x=g,E=_,T=_;for(i=0;i<l.length;i+=u)if(null!=l[i])for(a=0;u>a;++a)c=l[i+a],d=m[a],d&&d.autoscale!==!1&&c!=v&&c!=-v&&(d.x&&(k>c&&(k=c),c>E&&(E=c)),d.y&&(x>c&&(x=c),c>T&&(T=c)));if(o.bars.show){var C;switch(o.bars.align){case"left":C=0;break;case"right":C=-o.bars.barWidth;break;default:C=-o.bars.barWidth/2}o.bars.horizontal?(x+=C,T+=C+o.bars.barWidth):(k+=C,E+=C+o.bars.barWidth)}t(o.xaxis,k,E),t(o.yaxis,x,T)}e.each(p(),function(e,t){t.datamin==g&&(t.datamin=null),t.datamax==_&&(t.datamax=null)})}function b(){n.css("padding",0).children().filter(function(){return!e(this).hasClass("flot-overlay")&&!e(this).hasClass("flot-base")}).remove(),"static"==n.css("position")&&n.css("position","relative"),at=new t("flot-base",n),ot=new t("flot-overlay",n),lt=at.context,ut=ot.context,rt=e(ot.element).unbind();var i=n.data("plot");i&&(i.shutdown(),ot.clear()),n.data("plot",gt)}function y(){st.grid.hoverable&&(rt.mousemove(B),rt.bind("mouseleave",Y)),st.grid.clickable&&rt.click(V),r(mt.bindEvents,[rt])}function w(){vt&&clearTimeout(vt),rt.unbind("mousemove",B),rt.unbind("mouseleave",Y),rt.unbind("click",V),r(mt.shutdown,[rt])}function k(e){function t(e){return e}var n,i,s=e.options.transform||t,a=e.options.inverseTransform;"x"==e.direction?(n=e.scale=pt/Math.abs(s(e.max)-s(e.min)),i=Math.min(s(e.max),s(e.min))):(n=e.scale=ft/Math.abs(s(e.max)-s(e.min)),n=-n,i=Math.max(s(e.max),s(e.min))),e.p2c=s==t?function(e){return(e-i)*n}:function(e){return(s(e)-i)*n},e.c2p=a?function(e){return a(i+e/n)}:function(e){return i+e/n}}function x(e){for(var t=e.options,n=e.ticks||[],i=t.labelWidth||0,s=t.labelHeight||0,a=i||("x"==e.direction?Math.floor(at.width/(n.length||1)):null),o=e.direction+"Axis "+e.direction+e.n+"Axis",r="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+o,l=t.font||"flot-tick-label tickLabel",u=0;u<n.length;++u){var c=n[u];if(c.label){var d=at.getTextInfo(r,c.label,l,null,a);i=Math.max(i,d.width),s=Math.max(s,d.height)}}e.labelWidth=t.labelWidth||i,e.labelHeight=t.labelHeight||s}function E(t){var n=t.labelWidth,i=t.labelHeight,s=t.options.position,a="x"===t.direction,o=t.options.tickLength,r=st.grid.axisMargin,l=st.grid.labelMargin,u=!0,c=!0,d=!0,h=!1;e.each(a?ct:dt,function(e,n){n&&n.reserveSpace&&(n===t?h=!0:n.options.position===s&&(h?c=!1:u=!1),h||(d=!1))}),c&&(r=0),null==o&&(o=d?"full":5),isNaN(+o)||(l+=+o),a?(i+=l,"bottom"==s?(ht.bottom+=i+r,t.box={top:at.height-ht.bottom,height:i}):(t.box={top:ht.top+r,height:i},ht.top+=i+r)):(n+=l,"left"==s?(t.box={left:ht.left+r,width:n},ht.left+=n+r):(ht.right+=n+r,t.box={left:at.width-ht.right,width:n})),t.position=s,t.tickLength=o,t.box.padding=l,t.innermost=u}function T(e){"x"==e.direction?(e.box.left=ht.left-e.labelWidth/2,e.box.width=at.width-ht.left-ht.right+e.labelWidth):(e.box.top=ht.top-e.labelHeight/2,e.box.height=at.height-ht.bottom-ht.top+e.labelHeight)}function C(){var t,n=st.grid.minBorderMargin;if(null==n)for(n=0,t=0;t<it.length;++t)n=Math.max(n,2*(it[t].points.radius+it[t].points.lineWidth/2));var i={left:n,right:n,top:n,bottom:n};e.each(p(),function(e,t){if(t.reserveSpace&&t.ticks&&t.ticks.length){var n=t.ticks[t.ticks.length-1];"x"===t.direction?(i.left=Math.max(i.left,t.labelWidth/2),n.v<=t.max&&(i.right=Math.max(i.right,t.labelWidth/2))):(i.bottom=Math.max(i.bottom,t.labelHeight/2),n.v<=t.max&&(i.top=Math.max(i.top,t.labelHeight/2)))}}),ht.left=Math.ceil(Math.max(i.left,ht.left)),ht.right=Math.ceil(Math.max(i.right,ht.right)),ht.top=Math.ceil(Math.max(i.top,ht.top)),ht.bottom=Math.ceil(Math.max(i.bottom,ht.bottom))}function S(){var t,n=p(),i=st.grid.show;for(var s in ht){var a=st.grid.margin||0;ht[s]="number"==typeof a?a:a[s]||0}r(mt.processOffset,[ht]);for(var s in ht)ht[s]+="object"==typeof st.grid.borderWidth?i?st.grid.borderWidth[s]:0:i?st.grid.borderWidth:0;if(e.each(n,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,D(t)}),i){var o=e.grep(n,function(e){return e.reserveSpace});for(e.each(o,function(e,t){M(t),P(t),I(t,t.ticks),x(t)}),t=o.length-1;t>=0;--t)E(o[t]);C(),e.each(o,function(e,t){T(t)})}pt=at.width-ht.left-ht.right,ft=at.height-ht.bottom-ht.top,e.each(n,function(e,t){k(t)}),i&&N(),H()}function D(e){var t=e.options,n=+(null!=t.min?t.min:e.datamin),i=+(null!=t.max?t.max:e.datamax),s=i-n;if(0==s){var a=0==i?1:.01;null==t.min&&(n-=a),(null==t.max||null!=t.min)&&(i+=a)}else{var o=t.autoscaleMargin;null!=o&&(null==t.min&&(n-=s*o,0>n&&null!=e.datamin&&e.datamin>=0&&(n=0)),null==t.max&&(i+=s*o,i>0&&null!=e.datamax&&e.datamax<=0&&(i=0)))}e.min=n,e.max=i}function M(t){var n,s=t.options;n="number"==typeof s.ticks&&s.ticks>0?s.ticks:.3*Math.sqrt("x"==t.direction?at.width:at.height);var a=(t.max-t.min)/n,o=-Math.floor(Math.log(a)/Math.LN10),r=s.tickDecimals;null!=r&&o>r&&(o=r);var l,u=Math.pow(10,-o),c=a/u;if(1.5>c?l=1:3>c?(l=2,c>2.25&&(null==r||r>=o+1)&&(l=2.5,++o)):l=7.5>c?5:10,l*=u,null!=s.minTickSize&&l<s.minTickSize&&(l=s.minTickSize),t.delta=a,t.tickDecimals=Math.max(0,null!=r?r:o),t.tickSize=s.tickSize||l,"time"==s.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,n=[],s=i(e.min,e.tickSize),a=0,o=Number.NaN;do t=o,o=s+a*e.tickSize,n.push(o),++a;while(o<e.max&&o!=t);return n},t.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1,i=""+Math.round(e*n)/n;if(null!=t.tickDecimals){var s=i.indexOf("."),a=-1==s?0:i.length-s-1;if(a<t.tickDecimals)return(a?i:i+".")+(""+n).substr(1,t.tickDecimals-a)}return i}),e.isFunction(s.tickFormatter)&&(t.tickFormatter=function(e,t){return""+s.tickFormatter(e,t)}),null!=s.alignTicksWithAxis){var d=("x"==t.direction?ct:dt)[s.alignTicksWithAxis-1];if(d&&d.used&&d!=t){var h=t.tickGenerator(t);if(h.length>0&&(null==s.min&&(t.min=Math.min(t.min,h[0])),null==s.max&&h.length>1&&(t.max=Math.max(t.max,h[h.length-1]))),t.tickGenerator=function(e){var t,n,i=[];for(n=0;n<d.ticks.length;++n)t=(d.ticks[n].v-d.min)/(d.max-d.min),t=e.min+t*(e.max-e.min),i.push(t);return i},!t.mode&&null==s.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),f=t.tickGenerator(t);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(t.tickDecimals=p)}}}}function P(t){var n=t.options.ticks,i=[];null==n||"number"==typeof n&&n>0?i=t.tickGenerator(t):n&&(i=e.isFunction(n)?n(t):n);var s,a;for(t.ticks=[],s=0;s<i.length;++s){var o=null,r=i[s];"object"==typeof r?(a=+r[0],r.length>1&&(o=r[1])):a=+r,null==o&&(o=t.tickFormatter(a,t)),isNaN(a)||t.ticks.push({v:a,label:o})}}function I(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function A(){at.clear(),r(mt.drawBackground,[lt]);var e=st.grid;e.show&&e.backgroundColor&&L(),e.show&&!e.aboveData&&R();for(var t=0;t<it.length;++t)r(mt.drawSeries,[lt,it[t]]),F(it[t]);r(mt.draw,[lt]),e.show&&e.aboveData&&R(),at.render(),J()}function O(e,t){for(var n,i,s,a,o=p(),r=0;r<o.length;++r)if(n=o[r],n.direction==t&&(a=t+n.n+"axis",e[a]||1!=n.n||(a=t+"axis"),e[a])){i=e[a].from,s=e[a].to;break}if(e[a]||(n="x"==t?ct[0]:dt[0],i=e[t+"1"],s=e[t+"2"]),null!=i&&null!=s&&i>s){var l=i;i=s,s=l}return{from:i,to:s,axis:n}}function L(){lt.save(),lt.translate(ht.left,ht.top),lt.fillStyle=nt(st.grid.backgroundColor,ft,0,"rgba(255, 255, 255, 0)"),lt.fillRect(0,0,pt,ft),lt.restore()}function R(){var t,n,i,s;lt.save(),lt.translate(ht.left,ht.top);var a=st.grid.markings;if(a)for(e.isFunction(a)&&(n=gt.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,a=a(n)),t=0;t<a.length;++t){var o=a[t],r=O(o,"x"),l=O(o,"y");null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),r.to<r.axis.min||r.from>r.axis.max||l.to<l.axis.min||l.from>l.axis.max||(r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),(r.from!=r.to||l.from!=l.to)&&(r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),r.from==r.to||l.from==l.to?(lt.beginPath(),lt.strokeStyle=o.color||st.grid.markingsColor,lt.lineWidth=o.lineWidth||st.grid.markingsLineWidth,lt.moveTo(r.from,l.from),lt.lineTo(r.to,l.to),lt.stroke()):(lt.fillStyle=o.color||st.grid.markingsColor,lt.fillRect(r.from,l.to,r.to-r.from,l.from-l.to))))}n=p(),i=st.grid.borderWidth;for(var u=0;u<n.length;++u){var c,d,h,f,m=n[u],g=m.box,_=m.tickLength;if(m.show&&0!=m.ticks.length){for(lt.lineWidth=1,"x"==m.direction?(c=0,d="full"==_?"top"==m.position?0:ft:g.top-ht.top+("top"==m.position?g.height:0)):(d=0,c="full"==_?"left"==m.position?0:pt:g.left-ht.left+("left"==m.position?g.width:0)),m.innermost||(lt.strokeStyle=m.options.color,lt.beginPath(),h=f=0,"x"==m.direction?h=pt+1:f=ft+1,1==lt.lineWidth&&("x"==m.direction?d=Math.floor(d)+.5:c=Math.floor(c)+.5),lt.moveTo(c,d),lt.lineTo(c+h,d+f),lt.stroke()),lt.strokeStyle=m.options.tickColor,lt.beginPath(),t=0;t<m.ticks.length;++t){var v=m.ticks[t].v;h=f=0,isNaN(v)||v<m.min||v>m.max||"full"==_&&("object"==typeof i&&i[m.position]>0||i>0)&&(v==m.min||v==m.max)||("x"==m.direction?(c=m.p2c(v),f="full"==_?-ft:_,"top"==m.position&&(f=-f)):(d=m.p2c(v),h="full"==_?-pt:_,"left"==m.position&&(h=-h)),1==lt.lineWidth&&("x"==m.direction?c=Math.floor(c)+.5:d=Math.floor(d)+.5),lt.moveTo(c,d),lt.lineTo(c+h,d+f))}lt.stroke()}}i&&(s=st.grid.borderColor,"object"==typeof i||"object"==typeof s?("object"!=typeof i&&(i={top:i,right:i,bottom:i,left:i}),"object"!=typeof s&&(s={top:s,right:s,bottom:s,left:s}),i.top>0&&(lt.strokeStyle=s.top,lt.lineWidth=i.top,lt.beginPath(),lt.moveTo(0-i.left,0-i.top/2),lt.lineTo(pt,0-i.top/2),lt.stroke()),i.right>0&&(lt.strokeStyle=s.right,lt.lineWidth=i.right,lt.beginPath(),lt.moveTo(pt+i.right/2,0-i.top),lt.lineTo(pt+i.right/2,ft),lt.stroke()),i.bottom>0&&(lt.strokeStyle=s.bottom,lt.lineWidth=i.bottom,lt.beginPath(),lt.moveTo(pt+i.right,ft+i.bottom/2),lt.lineTo(0,ft+i.bottom/2),lt.stroke()),i.left>0&&(lt.strokeStyle=s.left,lt.lineWidth=i.left,lt.beginPath(),lt.moveTo(0-i.left/2,ft+i.bottom),lt.lineTo(0-i.left/2,0),lt.stroke())):(lt.lineWidth=i,lt.strokeStyle=st.grid.borderColor,lt.strokeRect(-i/2,-i/2,pt+i,ft+i))),lt.restore()}function N(){e.each(p(),function(e,t){var n,i,s,a,o,r=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",u="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,c=t.options.font||"flot-tick-label tickLabel";if(at.removeText(u),t.show&&0!=t.ticks.length)for(var d=0;d<t.ticks.length;++d)n=t.ticks[d],!n.label||n.v<t.min||n.v>t.max||("x"==t.direction?(a="center",i=ht.left+t.p2c(n.v),"bottom"==t.position?s=r.top+r.padding:(s=r.top+r.height-r.padding,o="bottom")):(o="middle",s=ht.top+t.p2c(n.v),"left"==t.position?(i=r.left+r.width-r.padding,a="right"):i=r.left+r.padding),at.addText(u,i,s,n.label,c,null,null,a,o))})}function F(e){e.lines.show&&j(e),e.bars.show&&q(e),e.points.show&&U(e)}function j(e){function t(e,t,n,i,s){var a=e.points,o=e.pointsize,r=null,l=null;lt.beginPath();for(var u=o;u<a.length;u+=o){var c=a[u-o],d=a[u-o+1],h=a[u],p=a[u+1];if(null!=c&&null!=h){if(p>=d&&d<s.min){if(p<s.min)continue;c=(s.min-d)/(p-d)*(h-c)+c,d=s.min}else if(d>=p&&p<s.min){if(d<s.min)continue;h=(s.min-d)/(p-d)*(h-c)+c,p=s.min}if(d>=p&&d>s.max){if(p>s.max)continue;c=(s.max-d)/(p-d)*(h-c)+c,d=s.max}else if(p>=d&&p>s.max){if(d>s.max)continue;h=(s.max-d)/(p-d)*(h-c)+c,p=s.max}if(h>=c&&c<i.min){if(h<i.min)continue;d=(i.min-c)/(h-c)*(p-d)+d,c=i.min}else if(c>=h&&h<i.min){if(c<i.min)continue;p=(i.min-c)/(h-c)*(p-d)+d,h=i.min}if(c>=h&&c>i.max){if(h>i.max)continue;d=(i.max-c)/(h-c)*(p-d)+d,c=i.max}else if(h>=c&&h>i.max){if(c>i.max)continue;p=(i.max-c)/(h-c)*(p-d)+d,h=i.max}(c!=r||d!=l)&&lt.moveTo(i.p2c(c)+t,s.p2c(d)+n),r=h,l=p,lt.lineTo(i.p2c(h)+t,s.p2c(p)+n)}}lt.stroke()}function n(e,t,n){for(var i=e.points,s=e.pointsize,a=Math.min(Math.max(0,n.min),n.max),o=0,r=!1,l=1,u=0,c=0;;){if(s>0&&o>i.length+s)break;o+=s;var d=i[o-s],h=i[o-s+l],p=i[o],f=i[o+l];if(r){if(s>0&&null!=d&&null==p){c=o,s=-s,l=2;continue}if(0>s&&o==u+s){lt.fill(),r=!1,s=-s,l=1,o=u=c+s;continue}}if(null!=d&&null!=p){if(p>=d&&d<t.min){if(p<t.min)continue;h=(t.min-d)/(p-d)*(f-h)+h,d=t.min}else if(d>=p&&p<t.min){if(d<t.min)continue;f=(t.min-d)/(p-d)*(f-h)+h,p=t.min}if(d>=p&&d>t.max){if(p>t.max)continue;h=(t.max-d)/(p-d)*(f-h)+h,d=t.max}else if(p>=d&&p>t.max){if(d>t.max)continue;f=(t.max-d)/(p-d)*(f-h)+h,p=t.max}if(r||(lt.beginPath(),lt.moveTo(t.p2c(d),n.p2c(a)),r=!0),h>=n.max&&f>=n.max)lt.lineTo(t.p2c(d),n.p2c(n.max)),lt.lineTo(t.p2c(p),n.p2c(n.max));else if(h<=n.min&&f<=n.min)lt.lineTo(t.p2c(d),n.p2c(n.min)),lt.lineTo(t.p2c(p),n.p2c(n.min));else{var m=d,g=p;f>=h&&h<n.min&&f>=n.min?(d=(n.min-h)/(f-h)*(p-d)+d,h=n.min):h>=f&&f<n.min&&h>=n.min&&(p=(n.min-h)/(f-h)*(p-d)+d,f=n.min),h>=f&&h>n.max&&f<=n.max?(d=(n.max-h)/(f-h)*(p-d)+d,h=n.max):f>=h&&f>n.max&&h<=n.max&&(p=(n.max-h)/(f-h)*(p-d)+d,f=n.max),d!=m&&lt.lineTo(t.p2c(m),n.p2c(h)),lt.lineTo(t.p2c(d),n.p2c(h)),lt.lineTo(t.p2c(p),n.p2c(f)),p!=g&&(lt.lineTo(t.p2c(p),n.p2c(f)),lt.lineTo(t.p2c(g),n.p2c(f)))}}}}lt.save(),lt.translate(ht.left,ht.top),lt.lineJoin="round";var i=e.lines.lineWidth,s=e.shadowSize;if(i>0&&s>0){lt.lineWidth=s,lt.strokeStyle="rgba(0,0,0,0.1)";var a=Math.PI/18;t(e.datapoints,Math.sin(a)*(i/2+s/2),Math.cos(a)*(i/2+s/2),e.xaxis,e.yaxis),lt.lineWidth=s/2,t(e.datapoints,Math.sin(a)*(i/2+s/4),Math.cos(a)*(i/2+s/4),e.xaxis,e.yaxis)}lt.lineWidth=i,lt.strokeStyle=e.color;var o=$(e.lines,e.color,0,ft);o&&(lt.fillStyle=o,n(e.datapoints,e.xaxis,e.yaxis)),i>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),lt.restore()}function U(e){function t(e,t,n,i,s,a,o,r){for(var l=e.points,u=e.pointsize,c=0;c<l.length;c+=u){var d=l[c],h=l[c+1];null==d||d<a.min||d>a.max||h<o.min||h>o.max||(lt.beginPath(),d=a.p2c(d),h=o.p2c(h)+i,"circle"==r?lt.arc(d,h,t,0,s?Math.PI:2*Math.PI,!1):r(lt,d,h,t,s),lt.closePath(),n&&(lt.fillStyle=n,lt.fill()),lt.stroke())}}lt.save(),lt.translate(ht.left,ht.top);var n=e.points.lineWidth,i=e.shadowSize,s=e.points.radius,a=e.points.symbol;if(0==n&&(n=1e-4),n>0&&i>0){var o=i/2;lt.lineWidth=o,lt.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,s,null,o+o/2,!0,e.xaxis,e.yaxis,a),lt.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,s,null,o/2,!0,e.xaxis,e.yaxis,a)}lt.lineWidth=n,lt.strokeStyle=e.color,t(e.datapoints,s,$(e.points,e.color),0,!1,e.xaxis,e.yaxis,a),lt.restore()}function z(e,t,n,i,s,a,o,r,l,u,c){var d,h,p,f,m,g,_,v,b;u?(v=g=_=!0,m=!1,d=n,h=e,f=t+i,p=t+s,d>h&&(b=h,h=d,d=b,m=!0,g=!1)):(m=g=_=!0,v=!1,d=e+i,h=e+s,p=n,f=t,p>f&&(b=f,f=p,p=b,v=!0,_=!1)),h<o.min||d>o.max||f<r.min||p>r.max||(d<o.min&&(d=o.min,m=!1),h>o.max&&(h=o.max,g=!1),p<r.min&&(p=r.min,v=!1),f>r.max&&(f=r.max,_=!1),d=o.p2c(d),p=r.p2c(p),h=o.p2c(h),f=r.p2c(f),a&&(l.fillStyle=a(p,f),l.fillRect(d,f,h-d,p-f)),c>0&&(m||g||_||v)&&(l.beginPath(),l.moveTo(d,p),m?l.lineTo(d,f):l.moveTo(d,f),_?l.lineTo(h,f):l.moveTo(h,f),g?l.lineTo(h,p):l.moveTo(h,p),v?l.lineTo(d,p):l.moveTo(d,p),l.stroke()))}function q(e){function t(t,n,i,s,a,o){for(var r=t.points,l=t.pointsize,u=0;u<r.length;u+=l)null!=r[u]&&z(r[u],r[u+1],r[u+2],n,i,s,a,o,lt,e.bars.horizontal,e.bars.lineWidth)}lt.save(),lt.translate(ht.left,ht.top),lt.lineWidth=e.bars.lineWidth,lt.strokeStyle=e.color;var n;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;default:n=-e.bars.barWidth/2}var i=e.bars.fill?function(t,n){return $(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,i,e.xaxis,e.yaxis),lt.restore()}function $(t,n,i,s){var a=t.fill;if(!a)return null;if(t.fillColor)return nt(t.fillColor,i,s,n);var o=e.color.parse(n);return o.a="number"==typeof a?a:.4,o.normalize(),o.toString()}function H(){if(null!=st.legend.container?e(st.legend.container).html(""):n.find(".legend").remove(),st.legend.show){for(var t,i,s=[],a=[],o=!1,r=st.legend.labelFormatter,l=0;l<it.length;++l)t=it[l],t.label&&(i=r?r(t.label,t):t.label,i&&a.push({label:i,color:t.color}));if(st.legend.sorted)if(e.isFunction(st.legend.sorted))a.sort(st.legend.sorted);else if("reverse"==st.legend.sorted)a.reverse();else{var u="descending"!=st.legend.sorted;a.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=u?1:-1})}for(var l=0;l<a.length;++l){var c=a[l];l%st.legend.noColumns==0&&(o&&s.push("</tr>"),s.push("<tr>"),o=!0),s.push('<td class="legendColorBox"><div style="border:1px solid '+st.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+c.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+c.label+"</td>")}if(o&&s.push("</tr>"),0!=s.length){var d='<table style="font-size:smaller;color:'+st.grid.color+'">'+s.join("")+"</table>";if(null!=st.legend.container)e(st.legend.container).html(d);else{var h="",p=st.legend.position,f=st.legend.margin;null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?h+="top:"+(f[1]+ht.top)+"px;":"s"==p.charAt(0)&&(h+="bottom:"+(f[1]+ht.bottom)+"px;"),"e"==p.charAt(1)?h+="right:"+(f[0]+ht.right)+"px;":"w"==p.charAt(1)&&(h+="left:"+(f[0]+ht.left)+"px;");var m=e('<div class="legend">'+d.replace('style="','style="position:absolute;'+h+";")+"</div>").appendTo(n);if(0!=st.legend.backgroundOpacity){var g=st.legend.backgroundColor;null==g&&(g=st.grid.backgroundColor,g=g&&"string"==typeof g?e.color.parse(g):e.color.extract(m,"background-color"),g.a=1,g=g.toString());var _=m.children();e('<div style="position:absolute;width:'+_.width()+"px;height:"+_.height()+"px;"+h+"background-color:"+g+';"> </div>').prependTo(m).css("opacity",st.legend.backgroundOpacity)}}}}}function W(e,t,n){var i,s,a,o=st.grid.mouseActiveRadius,r=o*o+1,l=null;for(i=it.length-1;i>=0;--i)if(n(it[i])){var u=it[i],c=u.xaxis,d=u.yaxis,h=u.datapoints.points,p=c.c2p(e),f=d.c2p(t),m=o/c.scale,g=o/d.scale;if(a=u.datapoints.pointsize,c.options.inverseTransform&&(m=Number.MAX_VALUE),d.options.inverseTransform&&(g=Number.MAX_VALUE),u.lines.show||u.points.show)for(s=0;s<h.length;s+=a){var _=h[s],v=h[s+1];if(null!=_&&!(_-p>m||-m>_-p||v-f>g||-g>v-f)){var b=Math.abs(c.p2c(_)-e),y=Math.abs(d.p2c(v)-t),w=b*b+y*y;r>w&&(r=w,l=[i,s/a])}}if(u.bars.show&&!l){var k,x;switch(u.bars.align){case"left":k=0;break;case"right":k=-u.bars.barWidth;break;default:k=-u.bars.barWidth/2}for(x=k+u.bars.barWidth,s=0;s<h.length;s+=a){var _=h[s],v=h[s+1],E=h[s+2];null!=_&&(it[i].bars.horizontal?p<=Math.max(E,_)&&p>=Math.min(E,_)&&f>=v+k&&v+x>=f:p>=_+k&&_+x>=p&&f>=Math.min(E,v)&&f<=Math.max(E,v))&&(l=[i,s/a])}}}return l?(i=l[0],s=l[1],a=it[i].datapoints.pointsize,{datapoint:it[i].datapoints.points.slice(s*a,(s+1)*a),dataIndex:s,series:it[i],seriesIndex:i}):null}function B(e){st.grid.hoverable&&G("plothover",e,function(e){return 0!=e.hoverable})}function Y(e){st.grid.hoverable&&G("plothover",e,function(){return!1})}function V(e){G("plotclick",e,function(e){return 0!=e.clickable})}function G(e,t,i){var s=rt.offset(),a=t.pageX-s.left-ht.left,o=t.pageY-s.top-ht.top,r=f({left:a,top:o});r.pageX=t.pageX,r.pageY=t.pageY;var l=W(a,o,i);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+s.left+ht.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+s.top+ht.top,10)),st.grid.autoHighlight){for(var u=0;u<_t.length;++u){var c=_t[u];c.auto!=e||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||X(c.series,c.point)}l&&Z(l.series,l.datapoint,e)}n.trigger(e,[r,l])}function J(){var e=st.interaction.redrawOverlayInterval;return-1==e?void K():void(vt||(vt=setTimeout(K,e)))}function K(){vt=null,ut.save(),ot.clear(),ut.translate(ht.left,ht.top);var e,t;for(e=0;e<_t.length;++e)t=_t[e],t.series.bars.show?tt(t.series,t.point):et(t.series,t.point);ut.restore(),r(mt.drawOverlay,[ut])}function Z(e,t,n){if("number"==typeof e&&(e=it[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var s=Q(e,t);-1==s?(_t.push({series:e,point:t,auto:n}),J()):n||(_t[s].auto=!1)}function X(e,t){if(null==e&&null==t)return _t=[],void J();if("number"==typeof e&&(e=it[e]),"number"==typeof t){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var i=Q(e,t);-1!=i&&(_t.splice(i,1),J())}function Q(e,t){for(var n=0;n<_t.length;++n){var i=_t[n];if(i.series==e&&i.point[0]==t[0]&&i.point[1]==t[1])return n}return-1}function et(t,n){var i=n[0],s=n[1],a=t.xaxis,o=t.yaxis,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();
if(!(i<a.min||i>a.max||s<o.min||s>o.max)){var l=t.points.radius+t.points.lineWidth/2;ut.lineWidth=l,ut.strokeStyle=r;var u=1.5*l;i=a.p2c(i),s=o.p2c(s),ut.beginPath(),"circle"==t.points.symbol?ut.arc(i,s,u,0,2*Math.PI,!1):t.points.symbol(ut,i,s,u,!1),ut.closePath(),ut.stroke()}}function tt(t,n){var i,s="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),a=s;switch(t.bars.align){case"left":i=0;break;case"right":i=-t.bars.barWidth;break;default:i=-t.bars.barWidth/2}ut.lineWidth=t.bars.lineWidth,ut.strokeStyle=s,z(n[0],n[1],n[2]||0,i,i+t.bars.barWidth,function(){return a},t.xaxis,t.yaxis,ut,t.bars.horizontal,t.bars.lineWidth)}function nt(t,n,i,s){if("string"==typeof t)return t;for(var a=lt.createLinearGradient(0,i,0,n),o=0,r=t.colors.length;r>o;++o){var l=t.colors[o];if("string"!=typeof l){var u=e.color.parse(s);null!=l.brightness&&(u=u.scale("rgb",l.brightness)),null!=l.opacity&&(u.a*=l.opacity),l=u.toString()}a.addColorStop(o/(r-1),l)}return a}var it=[],st={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},at=null,ot=null,rt=null,lt=null,ut=null,ct=[],dt=[],ht={left:0,right:0,top:0,bottom:0},pt=0,ft=0,mt={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},gt=this;gt.setData=c,gt.setupGrid=S,gt.draw=A,gt.getPlaceholder=function(){return n},gt.getCanvas=function(){return at.element},gt.getPlotOffset=function(){return ht},gt.width=function(){return pt},gt.height=function(){return ft},gt.offset=function(){var e=rt.offset();return e.left+=ht.left,e.top+=ht.top,e},gt.getData=function(){return it},gt.getAxes=function(){var t={};return e.each(ct.concat(dt),function(e,n){n&&(t[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),t},gt.getXAxes=function(){return ct},gt.getYAxes=function(){return dt},gt.c2p=f,gt.p2c=m,gt.getOptions=function(){return st},gt.highlight=Z,gt.unhighlight=X,gt.triggerRedrawOverlay=J,gt.pointOffset=function(e){return{left:parseInt(ct[h(e,"x")-1].p2c(+e.x)+ht.left,10),top:parseInt(dt[h(e,"y")-1].p2c(+e.y)+ht.top,10)}},gt.shutdown=w,gt.destroy=function(){w(),n.removeData("plot").empty(),it=[],st=null,at=null,ot=null,rt=null,lt=null,ut=null,ct=[],dt=[],mt=null,_t=[],gt=null},gt.resize=function(){var e=n.width(),t=n.height();at.resize(e,t),ot.resize(e,t)},gt.hooks=mt,l(gt),u(a),b(),c(s),S(),A(),y();var _t=[],vt=null}function i(e,t){return t*Math.floor(e/t)}var s=Object.prototype.hasOwnProperty;t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var n=this.element,i=this.context,s=this.pixelRatio;this.width!=e&&(n.width=e*s,n.style.width=e+"px",this.width=e),this.height!=t&&(n.height=t*s,n.style.height=t+"px",this.height=t),i.restore(),i.save(),i.scale(s,s)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(s.call(e,t)){var n=this.getTextLayer(t),i=e[t];n.hide();for(var a in i)if(s.call(i,a)){var o=i[a];for(var r in o)if(s.call(o,r)){for(var l,u=o[r].positions,c=0;l=u[c];c++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(u.splice(c--,1),l.rendered&&l.element.detach());0==u.length&&delete o[r]}}n.show()}},t.prototype.getTextLayer=function(t){var n=this.text[t];return null==n&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},t.prototype.getTextInfo=function(t,n,i,s,a){var o,r,l,u;if(n=""+n,o="object"==typeof i?i.style+" "+i.variant+" "+i.weight+" "+i.size+"px/"+i.lineHeight+"px "+i.family:i,r=this._textCache[t],null==r&&(r=this._textCache[t]={}),l=r[o],null==l&&(l=r[o]={}),u=l[n],null==u){var c=e("<div></div>").html(n).css({position:"absolute","max-width":a,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof i?c.css({font:o,color:i.color}):"string"==typeof i&&c.addClass(i),u=l[n]={width:c.outerWidth(!0),height:c.outerHeight(!0),element:c,positions:[]},c.detach()}return u},t.prototype.addText=function(e,t,n,i,s,a,o,r,l){var u=this.getTextInfo(e,i,s,a,o),c=u.positions;"center"==r?t-=u.width/2:"right"==r&&(t-=u.width),"middle"==l?n-=u.height/2:"bottom"==l&&(n-=u.height);for(var d,h=0;d=c[h];h++)if(d.x==t&&d.y==n)return void(d.active=!0);d={active:!0,rendered:!1,element:c.length?u.element.clone():u.element,x:t,y:n},c.push(d),d.element.css({top:Math.round(n),left:Math.round(t),"text-align":r})},t.prototype.removeText=function(e,t,n,i,a,o){if(null==i){var r=this._textCache[e];if(null!=r)for(var l in r)if(s.call(r,l)){var u=r[l];for(var c in u)if(s.call(u,c))for(var d,h=u[c].positions,p=0;d=h[p];p++)d.active=!1}}else for(var d,h=this.getTextInfo(e,i,a,o).positions,p=0;d=h[p];p++)d.x==t&&d.y==n&&(d.active=!1)},e.plot=function(t,i,s){var a=new n(e(t),i,s,e.plot.plugins);return a},e.plot.version="0.8.2",e.plot.plugins=[],e.fn.plot=function(t,n){return this.each(function(){e.plot(this,t,n)})}}(e),e}),define("widgets/continuousGraph",["jquery","jqueryui/widget","flot"],function(e){"use strict";e.widget("ted.continuousGraph",{options:{label:"Label",numberOfDataPoints:120,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#ff0000"],yaxis:{min:0,max:5e3},xaxis:{show:!1},legend:{backgroundOpacity:0}}},_create:function(){this.data=[];for(var t=0;t<this.options.numberOfDataPoints;t++)this.data.push([t,this.options.initialValue]);this.ui=e.plot(this.element,[{label:this.options.label,data:this.data}],this.options.flotConfig),this._refresh()},_refresh:function(){this.ui.draw()},_setOption:function(e,t){this._super(e,t),this._refresh()},update:function(e){this.data.length===this.options.numberOfDataPoints&&(this.data=this.data.slice(1)),this.data.push(Math.min(e,this.options.flotConfig.yaxis.max));for(var t=[],n=0;n<this.data.length;n++)t.push([n,this.data[n]]);this.ui.setData([{label:this.options.label,data:t}]),this._refresh()}})}),define("widgets/multiSeriesIndexGraph",["jquery","jqueryui/widget","flot"],function(e){"use strict";e.widget("ted.multiSeriesIndexGraph",{options:{labels:["Label"],initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#00ff00"],yaxis:{min:0,max:100},xaxis:{show:!1},legend:{backgroundOpacity:0}},numberOfDataPoints:120},_create:function(){this.data=[];for(var t=0;t<this.options.labels.length;t++){this.data[t]=[];for(var n=0;n<this.options.numberOfDataPoints;n++)this.data[t].push(this.options.initialValue)}this.ui=e.plot(this.element,this._graphData(),this.options.flotConfig),this._refresh()},_refresh:function(){this.ui.draw()},_setOption:function(e,t){this._super(e,t),this._refresh()},_graphData:function(){for(var e=[],t=0;t<this.data.length;t++){for(var n=[],i=0;i<this.options.numberOfDataPoints;i++)n.push([i,this.data[t][i]]);e.push({label:this.options.labels[t],data:n})}return e},update:function(e){if(this.data[0].length===this.options.numberOfDataPoints)for(var t=0;t<this.data.length;t++)this.data[t]=this.data[t].slice(1);for(var n=0;n<e.length;n++)this.data[n].push(Math.min(e[n],this.options.flotConfig.yaxis.max));this.ui.setData(this._graphData()),this._refresh()}})}),define("widgets/videoQos",["lodash","jquery","jqueryui/widget","widgets/continuousGraph","widgets/multiSeriesIndexGraph"],function(e,t){"use strict";t.widget("ted.videoQos",{options:{bandwidth:0,bufferLength:0,backBufferLength:0,loadLevel:0,nextLevel:0,currentLevel:0},_create:function(){var n="";e(["bandwidth","buffer","level"]).forEach(function(e){n+='<div id="'+e+'-graph" class="qos-player-graph"></div>'}),this.element.append('<div class="qos-graph-container">'+n+"</div>");var i=t("#bandwidth-graph");this.bwGraph=i,this.bwGraph.continuousGraph({label:"Bandwidth (kbps)",numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#ff0000"],yaxis:{min:0,max:5e3},xaxis:{show:!1},legend:{backgroundOpacity:0}}});var s=t("#buffer-graph");this.bufferGraph=s,this.bufferGraph.multiSeriesIndexGraph({labels:["Buffer","Back Buffer"],numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!1}},colors:["#00ff00","#0000ff"],yaxis:{min:0,max:100},xaxis:{show:!1},legend:{backgroundOpacity:0}}});var a=t("#level-graph");this.levelGraph=a,this.levelGraph.multiSeriesIndexGraph({labels:["Load level","Next level","Current level"],numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{show:!0,fill:!1}},colors:["#F3610D","#644089","#dbe66b"],yaxis:{min:0,max:7},xaxis:{show:!1},legend:{backgroundOpacity:0}}}),this._refresh()},_refresh:function(){this.bwGraph.continuousGraph("update",parseInt(this.options.bandwidth/1e3,10)),this.bufferGraph.multiSeriesIndexGraph("update",[parseInt(this.options.bufferLength,10),parseInt(this.options.backBufferLength,10)]),this.levelGraph.multiSeriesIndexGraph("update",[parseInt(this.options.loadLevel,10),parseInt(this.options.nextLevel,10),parseInt(this.options.currentLevel,10)])},_setOption:function(e,t){this._super(e,t),this._refresh()},_destroy:function(){this.element.children(".qos-graph-container").remove()}})}),define("jqueryui/core",["jquery"],function(e){return function(e,t){function n(t,n){var s,a,o,r=t.nodeName.toLowerCase();return"area"===r?(s=t.parentNode,a=s.name,t.href&&a&&"map"===s.nodeName.toLowerCase()?(o=e("img[usemap=#"+a+"]")[0],!!o&&i(o)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var s=0,a=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,s,a=e(this[0]);a.length&&a[0]!==document;){if(i=a.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(a.css("zIndex"),10),!isNaN(s)&&0!==s))return s;a=a.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),s=isNaN(i);return(s||i>=0)&&n(t,!s)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function s(t,n,i,s){return e.each(a,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var a="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?r["inner"+i].call(this):this.each(function(){e(this).css(o,s(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(o,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var s,a=e.ui[t].prototype;for(s in i)a.plugins[s]=a.plugins[s]||[],a.plugins[s].push([n,i[s]])},call:function(e,t,n){var i,s=e.plugins[t];if(s&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",s=!1;return t[i]>0?!0:(t[i]=1,s=t[i]>0,t[i]=0,s)}})}(e),e}),define("lib/qos",["widgets/videoQos","jqueryui/core"],function(){"use strict";function e(){var e=n.player,i=!1;"flash"===e.player("mode")&&(e.on("playermetricsdata",function(n,s){i&&t()&&e.videoQos("option",s.metricsData)}),e.on("playermetricstoggle",function(){i=!i,i?t()||e.videoQos():t()&&e.videoQos("destroy")}))}function t(){return n.player.is(":data(tedVideoQos)")}var n={player:null};return n.initQos=e,n}),function(e){"use strict";var t=function(e,n,i){return 1===arguments.length?t.get(e):t.set(e,n,i)};t._document=document,t._navigator=navigator,t.defaults={path:"/"},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[e]},t.set=function(n,i,s){return s=t._getExtendedOptions(s),s.expires=t._getExpiresDate(i===e?-1:s.expires),t._document.cookie=t._generateCookieString(n,i,s),t},t.expire=function(n,i){return t.set(n,e,i)},t._getExtendedOptions=function(n){return{path:n&&n.path||t.defaults.path,domain:n&&n.domain||t.defaults.domain,expires:n&&n.expires||t.defaults.expires,secure:n&&n.secure!==e?n.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){switch(n=n||new Date,typeof e){case"number":e=new Date(n.getTime()+1e3*e);break;case"string":e=new Date(e)}if(e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=encodeURIComponent(e),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var i=e+"="+t;return i+=n.path?";path="+n.path:"",i+=n.domain?";domain="+n.domain:"",i+=n.expires?";expires="+n.expires.toGMTString():"",i+=n.secure?";secure":""},t._getCookieObjectFromString=function(n){for(var i={},s=n?n.split("; "):[],a=0;a<s.length;a++){var o=t._getKeyValuePairFromCookieString(s[a]);i[o.key]===e&&(i[o.key]=o.value)}return i},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=0>t?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCookieObjectFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){return t._navigator.cookieEnabled||"1"===t.set("cookies.js",1).get("cookies.js")},t.enabled=t._areEnabled(),"function"==typeof define&&define.amd?define("Cookies",[],function(){return t}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Cookies=t):window.Cookies=t}(),define("lib/currentUserId",["Cookies"],function(e){"use strict";var t="_ted_user_id";return{get:function(){return e.get(t)}}}),define("lib/favorite",["exports","jquery","lib/ga","lib/currentUserId","lib/pubSub"],function(e,t,n,i,s){"use strict";function a(e){var t=!!i.get();return t||e.reject(new Error("Not logged in")),t}var o=t.Deferred;e.add=function(e){var i=new o,r=i.promise();return a(i)?(t.post("/favorites",e).then(function(e){s("favorite.add").publish(e),i.resolve(e),n.sendEvent("favorite","add",e.itemType.toLowerCase())},function(){i.reject(new Error("Rejected by server"))}),r):r},e.get=function(e){var n=new o,i=n.promise();return a(n)?(t.getJSON("/favorites/find",e).then(function(e){n.resolve(e)},function(){n.reject(new Error("Rejected by server"))}),i):i},e.remove=function(e){var n=new o,i=n.promise();if(!a(n))return i;var r={data:e,dataType:"json",type:"DELETE",url:"/favorites/"+e.id};return t.ajax(r).then(function(e){s("favorite.remove").publish(e),n.resolve(e)},function(){n.reject(new Error("Rejected by server"))}),i}}),define("Modernizr",[],function(){"use strict";return window.Modernizr}),define("lib/personalStorage",["lodash","Modernizr","exports","lib/currentUserId"],function(e,t,n,i){"use strict";function s(t,i){var s=e.toArray(arguments);return n.storageAdapter?(s[1]=n.getKey(i),t.apply(n.storageAdapter,s.slice(1))):!1}n.storageAdapter=t.localstorage?window.localStorage:void 0,n.getKey=function(e){var t=i.get();return t||(t="0"),t+"-"+e},n.getItem=e.wrap(function(e){return n.storageAdapter.getItem(e)},s),n.setItem=e.wrap(function(e,t){n.storageAdapter.setItem(e,t)},s),n.removeItem=e.wrap(function(e){n.storageAdapter.removeItem(e)},s)}),define("lib/watchLaterLocal",["exports","jquery","lodash","Modernizr","lib/currentUserId","lib/personalStorage"],function(e,t,n,i,s,a){"use strict";function o(e){return+e.split("|",1).pop()}function r(e){return(e.match(/(\|\d+)+/)||"|")[0]+"|"}function l(t){var n=new u,i=n.promise(),s=e._checkCapability();return s!==!0?(n.reject(s),i):(t.apply(n,Array.prototype.splice.call(arguments,1)),i)}var u=t.Deferred,c="wl",d=null,h=18e4,p=null;e.addPlaylist=function(t){return e._add("playlists",t)},e.addTalk=function(t){return e._add("talks",t)},e.checkPlaylist=function(t){return e._check("playlists",t)},e.checkTalk=function(t){return e._check("talks",t)},e.count=n.wrap(function(){var t=this;e._getCache().then(function(e){t.resolve({total:e.talksCount+e.playlistsCount,talks:e.talksCount,playlists:e.playlistsCount})},function(e){t.reject(e)})},l),e.removePlaylist=function(t){return e._remove("playlists",t)},e.removeTalk=function(t){return e._remove("talks",t)},e.sync=n.wrap(function(){if(p)return p;var i=this;return p=i.promise(),t.get("/saved_items/sync.txt").then(function(t){return t=+new Date+";"+t,(d=e._fromS(t))?(a.setItem(c,t),void i.resolve(d)):void i.reject(new Error("Invalid response"))},function(){i.reject(new Error("Rejected by server"))}).always(n.delay(function(){p=null},h)),p},l),e._add=n.wrap(function(t,n){var i=this;e._check(t,n).then(function(s){s||(d[t+"List"]+=n+"|",d[t+"Count"]++,a.setItem(c,e._toS(d))),i.resolve(d)},function(e){i.reject(e)})},l),e._check=n.wrap(function(t,n){var i=this;e._getCache().then(function(e){i.resolve(-1!==e[t+"List"].indexOf("|"+n+"|"))},function(e){i.reject(e)})},l),e._checkCapability=function(){return i.localstorage?s.get()?!0:new Error("Not logged in"):new Error("No localStorage")},e._getCache=function(){var t=new u,n=t.promise();return d?(t.resolve(d),n):(d=e._fromS(a.getItem(c)),d?(t.resolve(d),+new Date-+d.lastSync>h&&e.sync()):e.sync().then(function(){t.resolve(d)},function(e){t.reject(e)}),n)},e._remove=n.wrap(function(t,n){var i=this;e._check(t,n).then(function(s){s&&(d[t+"List"]=d[t+"List"].replace("|"+n+"|","|"),d[t+"Count"]--,a.setItem(c,e._toS(d))),i.resolve(d)},function(e){i.reject(e)})},l),e._reset=function(){d=null,p=null},e._fromS=function(e){if(!e)return null;if(!e.match(/^\d+;\d+(\|\d+)*;\d+(\|\d+)*$/))return null;var t=e.split(";");return{lastSync:+t[0],talksCount:o(t[1]),talksList:r(t[1]),playlistsCount:o(t[2]),playlistsList:r(t[2])}},e._toS=function(e){return e?[e.lastSync,e.talksCount+e.talksList.slice(0,-1),e.playlistsCount+e.playlistsList.slice(0,-1)].join(";"):null}}),define("lib/watchLater",["exports","jquery","lodash","Modernizr","lib/ga","lib/currentUserId","lib/watchLaterLocal","lib/pubSub"],function(e,t,n,i,s,a,o,r){"use strict";function l(e){return i.localstorage?a.get()?!0:(e.reject(new Error("Not logged in")),!1):(e.reject(new Error("No localStorage")),!1)}var u=t.Deferred,c=[];e.add=function(e){var n=new u,i=n.promise();return l(n)?(t.post("/saved_items",e).then(function(e){o["add"+e.itemType](e.itemId),r("watchLater.add").publish(e),n.resolve(e),s.sendEvent("watchLater","add",e.itemType.toLowerCase())},function(){n.reject(new Error("Rejected by server"))}),i):i},e.get=function(e){var i=new u,s=i.promise();if(!l(i))return s;var a={itemId:e.itemId,itemType:e.itemType},o=n.find(c,a);return o?o.promise:(a.promise=s,c.push(a),t.getJSON("/saved_items/find",e).then(function(e){i.resolve(e)},function(){i.reject(new Error("Rejected by server"))}),s)},e.remove=function(e){var n=new u,i=n.promise();if(!l(n))return i;var s={data:e,dataType:"json",type:"DELETE",url:"/saved_items/"+e.id};return t.ajax(s).then(function(e){o["remove"+e.itemType](e.itemId),r("watchLater.remove").publish(e),n.resolve(e)},function(){n.reject(new Error("Rejected by server"))}),i},e.update=function(e){var n=new u,i=n.promise();if(!l(n))return i;var s={data:e,dataType:"json",type:"PUT",url:"/saved_items/"+e.id};return t.ajax(s).then(function(e){n.resolve(e)},function(){n.reject(new Error("Rejected by server"))}),i},e._reset=function(){c=[]}}),define("utils/share",["jquery","lodash","lib/ga"],function(e,t,n){"use strict";var i={media:e('meta[property="og:image"]').first().attr("content"),height:450,message:"",url:location.href,width:500,utmSource:"tedcomshare",utmMedium:"social",utmCampaign:"tedspread"},s=encodeURIComponent,a={email:{href:"mailto:?subject=<%= message %>&body=<%= email %>",ga:"email",utmMedium:"email"},facebook:{href:"//www.facebook.com/sharer/sharer.php?u=<%= url %>",ga:"facebook",utmSource:"facebook.com"},gplus:{href:"//plus.google.com/share?url=<%= url %>",ga:"googlePlus",utmSource:"plus.google.com"},linkedin:{href:"//www.linkedin.com/shareArticle?mini=true&url=<%= url %>&title=<%= message %>&source=TED",ga:"linkedIn",height:500,utmSource:"linkedin.com"},twitter:{href:"//twitter.com/intent/tweet?url=<%= url %>&text=<%= message %>",ga:"twitter",utmSource:"twitter.com"},pinterest:{href:"//pinterest.com/pin/create/button/?url=<%= url %>&media=<%= media %>",ga:"pinterest",utmSource:"pinterest.com"}};return function(e,o){var r=a[e];if(!r)return!1;o=t.merge({},i,r,o);var l=o.url+(-1===o.url.indexOf("?")?"?":"&")+"utm_source="+o.utmSource+"&utm_medium="+o.utmMedium+"&utm_campaign="+o.utmCampaign,u=t.template(o.href,{url:s(l),message:s(o.message),media:s(o.media),email:s(o.message+"\n"+l)});u.match(/mailto:/)?window.location.href=u:window.open(u,"sharingpopup",["scrollbars=1","resizable=1","height="+o.height,"width="+o.width].join(",")).focus(),n.sendSocial(e,"start",o.url)}}),define("utils/timeFromUrl",[],function(){"use strict";return function(e){var t,n,i,s={offset:!0};return e||(e=document.location.href),t=e.match(/#t=(\d+)m(\d+)s[^\/]*/),t&&(n=parseInt(t[1],10),i=parseInt(t[2],10)+60*n,s.offset=!1),t=e.match(/#t-(\d+)[^\/]*/),t&&(i=parseInt(t[1],10)/1e3),t=e.match(/#(\d+)[^\/]*/),t&&(i=parseInt(t[1],10)),s.seconds=i,s}}),define("views/mixins/cached-find",["exports"],function(e){"use strict";e._findEls=null,e.find=function(e){if(this._findEls||(this._findEls={}),this._findEls[e])return this._findEls[e];var t=this.$el.find(e);return t.length&&(this._findEls[e]=t),t}}),define("templates/helpers/ifCond",["Handlebars"],function(e){"use strict";e.registerHelper("ifCond",function(e,t,n,i){switch(t){case"!=":case"!==":return e!==n?i.fn(this):i.inverse(this);case"==":case"===":return e===n?i.fn(this):i.inverse(this);case"===":return e===n?i.fn(this):i.inverse(this);case"<":return n>e?i.fn(this):i.inverse(this);case"<=":return n>=e?i.fn(this):i.inverse(this);case">":return e>n?i.fn(this):i.inverse(this);case">=":return e>=n?i.fn(this):i.inverse(this);case"&&":return e&&n?i.fn(this):i.inverse(this);case"||":return e||n?i.fn(this):i.inverse(this);default:return i.inverse(this)}})}),define("hbs!templates/language-list",["hbs","hbs/handlebars","templates/helpers/ifCond"],function(e,t){var n=t.template({1:function(e,t,n,i){var s,a;return'    <li class="language-list__item">\n      <a class="language checkable" href="#" data-language-code="'+this.escapeExpression((a=null!=(a=t.languageCode||(null!=e?e.languageCode:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"languageCode",hash:{},data:i}):a))+'">\n        <div class="language__exonym">\n          <span class="language__label checkable__label">'+this.escapeExpression((a=null!=(a=t.languageName||(null!=e?e.languageName:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"languageName",hash:{},data:i}):a))+"</span>\n        </div>\n"+(null!=(s=(t.ifCond||e&&e.ifCond||t.helperMissing).call(e,null!=e?e.languageName:e,"!=",null!=e?e.endonym:e,{name:"ifCond",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+"      </a>\n    </li>\n"},2:function(e,t,n,i){var s;return'          <div class="language__endonym" lang="'+this.escapeExpression((s=null!=(s=t.ianaCode||(null!=e?e.ianaCode:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"ianaCode",hash:{},data:i}):s))+'">\n            <span class="language__label checkable__label">'+this.escapeExpression((s=null!=(s=t.endonym||(null!=e?e.endonym:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"endonym",hash:{},data:i}):s))+"</span>\n          </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<ul class="m3 sl language-list">\n'+(null!=(s=t.each.call(e,null!=e?e.languages:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"</ul>\n"},useData:!0});return t.registerPartial("templates/language-list",n),t.registerPartial("templates/language-list",n),n}),define("templates/helpers/icon",["Handlebars"],function(e){"use strict";function t(e,t,i){return e=n(e),t=n(t),i=n(i),'<i class="icon icon_'+e+" "+(i||"")+'">'+(t?"<span class=screen-reader-text>"+t+"</span>":"")+"</i>"}var n=e.Utils.escapeExpression;return e.registerHelper("icon",function(n,i,s){return new e.SafeString(t(n,i,s))}),t}),define("hbs!templates/subtitle-modal",["hbs","hbs/handlebars","hbs!templates/language-list","templates/helpers/icon"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n  <h3 class="modal__head__title">\n    '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"subtitle",null,"modal__head__icon",{name:"icon",hash:{},data:i}))+'\n    Language\n  </h3>\n</div>\n\n<div class="m3">\n  <a class="Subtitle-modal__switch checkable checkable--checked" href="#">\n    Subtitles off\n  </a>\n</div>\n\n<div class="m3 Subtitle-modal__list">\n'+(null!=(s=this.invokePartial(n["templates/language-list"],e,{name:"templates/language-list",data:i,indent:"  ",helpers:t,partials:n}))?s:"")+'</div>\n\n<hr>\n\nTED Talks are subtitled by volunteers.\nDon\'t see your language?\n<a href="http://www.ted.com/participate/translate/get-started" target="_blank">Help us translate</a>!\n'},usePartial:!0,useData:!0});return t.registerPartial("templates/subtitle-modal",n),n}),define("templates/helpers/t",["Handlebars"],function(e){"use strict";e.registerHelper("t",function(e){return e})}),define("hbs!templates/modalDefault",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n  </a>\n  <h3 class="modal__head__title">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+"</h3>\n</div>\n"},useData:!0});return t.registerPartial("templates/modalDefault",n),n}),define("lib/focus-zone",["jquery","lodash","jqueryui/core"],function(e,t){"use strict";function n(t){this.$el=e(t)}function i(e){e.preventDefault()}var s=e(window);return n.__reset=function(){t.assign(n,{__active:void 0,__isListening:!1,__zones:[]})},n.__addZone=function(e){n.__zones.push(e),n.__setActive(),n.__startListening()},n.__removeZone=function(e){n.__zones=t.without(n.__zones,e),n.__setActive(),n.__stopListening()},n.__setActive=function(){n.__active=t.last(n.__zones)},n.__startListening=function(){n.__isListening||n.__active&&(n.__startListeningInner(),n.__isListening=!0)},n.__startListeningInner=function(){s.on("keydown",n.__keyDown)},n.__stopListening=function(){n.__isListening&&(n.__active||(n.__stopListeningInner(),n.__isListening=!1))},n.__stopListeningInner=function(){s.off("keydown",n.__keyDown)},n.__keyDown=function(s){var a=n.__active;if(a&&s.keyCode===e.ui.keyCode.TAB){var o=s.target,r=a.$el,l=r.find(":tabbable"),u=l.filter(":first"),c=l.filter(":last");o!==c[0]&&o!==r[0]||s.shiftKey?o!==u[0]&&o!==r[0]||!s.shiftKey?-1===t.indexOf(l,o)&&(u.focus(),i(s)):(c.focus(),i(s)):(u.focus(),i(s))}},t.assign(n.prototype,{activate:function(){return this._recordFocus(),n.__addZone(this),this},deactivate:function(){return n.__removeZone(this),this._restoreFocus(),this},_recordFocus:function(){this.$focus=e(":focus")},_restoreFocus:function(){this.$focus&&this.$focus.length&&this.$focus.focus()}}),n.__reset(),n}),define("widgets/modal",["jquery","lodash","hbs!templates/modalDefault","lib/pubSub","lib/focus-zone","jqueryui/widget","lib/resize"],function(e,t,n,i,s){"use strict";function a(){d||(c=e(window),l=e(document.body),u=e("html"))}var o,r,l,u,c,d=0,h="modal-backdrop--show",p="modal--show",f="modal-open",m="modal__content",g=0;return r=["<div class=modal>","<div class=modal__outer>","<div class=modal__inner>"].join(""),i("breakpoint").subscribe(function(e){o=768>e}),e.widget("ted.modal",{options:{align:"middle",autoOpen:!0},_create:function(){var t=this;a(),this.options.title&&this.element.prepend(n(this.options)),this.modal=this.element.addClass(m).css("display","").wrap(r).closest("div.modal"),this.modal.addClass("modal--align-"+this.options.align);
var i=e("<div class=modal-backdrop>");this.backdrop=i;var u=e("<div class=modal-wrapper>");this.wrapper=u,u.append(this.backdrop).append(this.modal),this.focusZone=new s(this.modal),this.wrapper.on("click",function(n){return o?!0:e(n.target).closest("div.modal__content").length?!0:(n.preventDefault(),void t.close())}),l.append(this.wrapper),this._on({"click a.modal__close":function(e){e.preventDefault(),t.close()},keyup:function(n){n.preventDefault(),n.keyCode===e.ui.keyCode.ESCAPE&&t.close()}}),this.options.autoOpen&&t.open()},_destroy:function(){var e=this;t.defer(function(){e.wrapper.remove()})},open:function(){var e=this;return this._hasOpened?(e.backdrop.addClass(h),e.openedAt={y:c.scrollTop()},g++||u.addClass(f),o&&window.scrollTo(0,0),e.modal.addClass(p),e.focusZone.activate(),this.element.attr("tabindex",0),this.element.focus(),void e._trigger("open")):void window.setTimeout(function(){e._hasOpened||(e._hasOpened=!0,e.open())},10)},close:function(){this.modal.removeClass(p),--g||u.removeClass(f),this.openedAt&&window.scrollTo(0,this.openedAt.y),this.backdrop.removeClass(h),this.element.attr("tabindex",-1),this.focusZone.deactivate(),this._trigger("close")}}),function(t,n){return e(t).modal(n)}}),define("views/subtitle-modal",["jquery","lodash","Backbone","views/mixins/cached-find","hbs!templates/subtitle-modal","hbs!templates/language-list","widgets/modal"],function(e,t,n,i,s,a){"use strict";var o="checkable--checked",r=n.View.extend({className:"Subtitle-modal",template:s,events:{"click a.language":"_clickLanguage","click a.Subtitle-modal__switch":"_clickSwitch"},_rendered:!1,close:function(){return this.$el.modal("close"),this},initialize:function(e){var i=this;return i.state=new n.Model(t.extend({isOpen:!1,selected:!1},e||{})),i.listenTo(i.state,"change:selected",i._actSelected),i.listenTo(i.state,"change:languages",i._rerenderLanguages),this},open:function(){return this.$el.modal("open"),this},render:function(){var e=this;return e.$el.addClass("subtitle-modal").html(e.template(e.state.toJSON())).modal({autoOpen:!1}).on("modalclose",function(){e.trigger("close"),e.state.set("isOpen",!1)}).on("modalopen",function(){e.trigger("open"),e.state.set("isOpen",!0)}),e._rendered=!0,this._actSelected(),this},_actSelected:function(){var e=this.state.get("selected"),t=this.find("a.language");t.removeClass(o),e&&t.filter('[data-language-code="'+e+'"]').addClass(o),this.find("a.Subtitle-modal__switch")[e?"removeClass":"addClass"](o)},_clickLanguage:function(t){t.preventDefault();var n=e(t.target).closest("a.language"),i=n.data("language-code")||!1;this.state.set("selected",i)},_clickSwitch:function(e){e.preventDefault(),this.state.set("selected",!1)},_rerenderLanguages:function(){if(this._rendered){var e=this.state.get("languages");this.find("div.Subtitle-modal__list").html(a({languages:e}))}}});return t.extend(r.prototype,i),r}),define("hbs!templates/talkEndCard",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDuration"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'        <li class="talk-end-card__item">\n          <a class="l3 talk-end-card__link ga-link" href="/talks/'+this.escapeExpression((s=null!=(s=t.slug||(null!=e?e.slug:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"slug",hash:{},data:i}):s))+'" data-ga-category="talk.relatedTalk">\n            <img class="talk-end-card__image" src="'+this.escapeExpression((s=null!=(s=t.image||(null!=e?e.image:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"image",hash:{},data:i}):s))+'" alt="'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+'">\n\n            <div class="talk-end-card__speaker">'+this.escapeExpression((s=null!=(s=t.speaker||(null!=e?e.speaker:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"speaker",hash:{},data:i}):s))+'</div>\n            <div class="talk-end-card__title">'+this.escapeExpression((s=null!=(s=t.title||(null!=e?e.title:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"title",hash:{},data:i}):s))+'</div>\n            <div class="talk-end-card__duration">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=e?e.duration:e,{name:"formatDuration",hash:{},data:i}))+"</div>\n          </a>\n        </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="talk-end-card">\n  <h2 class="talk-end-card__headline">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"More TED Talks",{name:"t",hash:{},data:i}))+'</h2>\n\n  <div class="talk-end-card__container">\n    <ul class="talk-end-card__list">\n'+(null!=(s=t.each.call(e,null!=e?e.relatedTalks:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"    </ul>\n  </div>\n</div>\n"},useData:!0});return t.registerPartial("templates/talkEndCard",n),n}),define("hbs!templates/talkViewsBreakdown",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'      <li class="talk-breakdown__source">\n        <span class="talk-breakdown__source__bar" style="width:'+this.escapeExpression((s=null!=(s=t.width||(null!=e?e.width:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"width",hash:{},data:i}):s))+'%"></span>\n        <span class="talk-breakdown__source__label">'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+"% "+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</span>\n      </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="talk-breakdown">\n  <p><strong>This number combines views from the following outlets:</strong></p>\n\n  <ul class="sl talk-breakdown__sources">\n'+(null!=(s=t.each.call(e,null!=e?e.sources:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"  </ul>\n</div>\n"},useData:!0});return t.registerPartial("templates/talkViewsBreakdown",n),n}),define("hbs!templates/commentApologyModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Could not save comment",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Sorry: we're currently experiencing difficulties and were unable to save your comment.",{name:"t",hash:{},data:i}))+"</p>\n</div>\n"},useData:!0});return t.registerPartial("templates/commentApologyModal",n),n}),define("lib/currentUser",["jquery","lodash","lib/currentUserId","lib/personalStorage"],function(e,t,n,i){"use strict";function s(e){return t.isFinite(e)?+e:null}function a(e){return e?""+e:null}function o(e){return e=t.pick(e,T),t.forOwn(e,function(t,n){e[n]=E[n](t)}),e}function r(e){return e&&JSON.parse(e)}function l(){return o(r(w.storageAdapter.getItem(k)))}function u(){return e.ajax({dataType:"json",url:"/me",data:{c:n.get()+"-"+Math.round(+new Date/1e3/120)},timeout:3e3})}function c(e){u().then(t.bind(d,w,e),t.bind(h,w,e))}function d(e,t){if(!t)return void h(e,t);if(t.unavailable&&t.unavailable.length)for(var n=l(),i=t.unavailable,s=i.length;s--;)t[i[s]]=n[i[s]]||t[i[s]];t.lastDownloaded=(new Date).getTime(),_=o(t),g(e)&&w.storageAdapter.setItem(k,JSON.stringify(_))}function h(e){p(),e.reject()}function p(){_=null,w.storageAdapter.removeItem(k),e(document.documentElement).removeClass("loggedin").addClass("loggedout")}function f(e,t){var n=(new Date).getTime();return e>n-(t||0)}function m(){return w._check(_)}function g(e){var t=m();return t?e.resolve(_):(p(),e.reject()),t}var _,v=function(e){return!!e},b=function(e){return e},y=e.Deferred,w={},k="me",x=!0,E={id:s,profileId:s,firstName:a,lastName:a,avatarUrl:a,hasConferences:v,upcomingConferences:b,isCommentModerator:v,hasEdActivity:v,isTEDxOrganizer:v,lastDownloaded:s},T=t.keys(E);return w.storageAdapter=i,w.getDetails=function(){var e=new y;return _=_||l(),m()||(_=null),_?(e.resolve(_),x&&!f(18e4,_.lastDownloaded)&&(x=!1,c(new y))):n.get()?c(e):e.reject(),e.promise()},w._check=function(e){var i=864e5;return e&&+e.id===+n.get()&&T.length===t.keys(t.pick(e,T)).length&&f(i,e.lastDownloaded)},w._reset=function(){_=void 0,x=!0},w}),define("lib/browserDetect",["exports"],function(e){"use strict";function t(e){for(var t=0;t<e.length;t++){var n=e[t].string,s=e[t].prop;if(i=e[t].versionSearch||e[t].identity,n){if(-1!==n.indexOf(e[t].subString))return e[t].identity}else if(s)return e[t].identity}}function n(e){var t=e.indexOf(i);if(-1!==t)return parseFloat(e.substring(t+i.length+1))}var i,s=window.navigator,a=[{string:s.userAgent,subString:"Chrome",identity:"Chrome"},{string:s.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:s.userAgent,subString:"Firefox",identity:"Firefox"},{string:s.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:s.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}];e.browser=t(a)||"Unknown Browser",e.version=n(window.navigator.userAgent)||n(window.navigator.appVersion)||"Unknown Version"}),define("utils/ted",[],function(){"use strict";var e=function(){var e=window.navigator,t=e?e.userAgent.toLowerCase():"";if(-1!==t.indexOf("chrome"))return!1;var n=t.match(/macintosh.*os x.*applewebkit.*version\/([\d]+).*safari/);return n?+n[1]<7?!1:!0:!1};return function(t){return window.TED?"playerPath"===t?e()?window.TED.playerPathLocal:window.TED.playerPathRemote:window.TED[t]:""}}),define("lib/errorCollector",["jquery","lodash","lib/browserDetect","lib/currentUserId","utils/ted","exports"],function(e,t,n,i,s,a){"use strict";a.post=t.throttle(function(t){e.post("/error_collector.php",{message:t})},5e3),a.log=function(t,o){a.post(e.extend({message:t,context:"js",uri:window.location.href,client_name:n.browser,client_version:n.version,elapsed_seconds:Math.floor((+new Date-s("startTime"))/1e3),profile_id:i.get()||"N/A",user_agent:window.navigator?window.navigator.userAgent:"Unknown User Agent"},o||{}))}}),define("hbs!templates/authPromptModal",["hbs","hbs/handlebars","templates/helpers/icon"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="auth-prompt__section auth-prompt__header">\n  <h2 class="auth-prompt__header__title">\n    Log in to\n    TED\n  </h2>\n\n  <a href="#" class="modal__close auth-prompt__close">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n</div>\n\n<div class="auth-prompt__section auth-prompt__options">\n  <form class="auth-prompt__option auth-prompt__option--standard">\n    <div class="auth-prompt__message">\n      Your email or password was incorrect.\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Email</label>\n      <input class="form-control auth-prompt__email" name="user[email]" type="email">\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Password</label>\n      <input class="form-control auth-prompt__password" name="user[password]" type="password">\n    </div>\n\n    <div class="m3">\n      <label>\n        <input class="auth-prompt__remember" type="checkbox" checked name="user[remember_me]">\n        <span class="form-label" style="display:inline; margin-left: 2px;">\n          Remember me\n        </span>\n      </label>\n    </div>\n\n    <div>\n      <button class="button button--dark auth-prompt__login">Log in</button>\n      <a class="l3 auth-prompt__halp" href="'+this.escapeExpression((s=null!=(s=t.signInHelpUrl||(null!=e?e.signInHelpUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"signInHelpUrl",hash:{},data:i}):s))+'" target="_blank">Need help logging in?</a>\n    </div>\n  </form>\n\n  <div class="auth-prompt__option auth-prompt__option--social">\n    <button class="button button--wide button--dark button--labeled button--facebook auth-prompt__facebook">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"facebook","","button__icon",{name:"icon",hash:{},data:i}))+'\n      <span class="button__label">Log in with Facebook</span>\n    </button>\n  </div>\n</div>\n\n<div class="auth-prompt__section auth-prompt__footer">\n  <span class="auth-prompt__footer__question">Don\'t have an account yet?</span>\n  <a class="l3" href="'+this.escapeExpression((s=null!=(s=t.signUpUrl||(null!=e?e.signUpUrl:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"signUpUrl",hash:{},data:i}):s))+'" target="_blank">Sign up</a>\n</div>\n\n<div class="auth-prompt__thinking"></div>\n'},useData:!0});return t.registerPartial("templates/authPromptModal",n),n}),define("views/AuthPromptView",["lodash","Modernizr","Backbone","lib/auth","hbs!templates/authPromptModal","utils/ted","spinjs","widgets/modal"],function(e,t,n,i,s,a,o){"use strict";function r(){i||(i=require("lib/auth"))}var l=n.View.extend({template:s,events:{"click button.auth-prompt__facebook":"facebook","click button.auth-prompt__login":"login","submit form.auth-prompt__option--standard":"login"},close:function(){this.$el.modal("close")},open:function(){this.$el.removeClass("auth-prompt--error"),this.$el.modal("open"),this.$email.focus()},login:function(e){e&&e.preventDefault(),this._startThinking(),r(),i.login(this.$email.val(),this.$password.val(),this.$remember.val()).then(this._loginSuccess,this._loginFailure).always(this._stopThinking),this.$password.val("")},facebook:function(e){e&&e.preventDefault(),this._startThinking(),r(),i.facebook().then(this._facebookSuccess,this._facebookFailure).always(this._stopThinking)},initialize:function(){var e=this;this._loginSuccess=function(){e.close(),e.trigger("login.success")},this._facebookSuccess=this._loginSuccess,this._loginFailure=function(t){t&&t.responseJSON&&e.$el.find(".auth-prompt__message").html(t.responseJSON.error),e.$el.addClass("auth-prompt--error"),e.trigger("login.failure")},this._facebookFailure=function(){e.trigger("login.failure")},this._stopThinking=function(){e.$thinkers.prop("disabled",!1),e.$el.removeClass("auth-prompt--thinking"),e._spinner&&e._spinner.stop()}},render:function(){var e=this;return this.$el.addClass("auth-prompt").html(e.template({signInHelpUrl:a("signInHelpUrl"),signUpUrl:a("signUpUrl")})).modal({autoOpen:!1}).on("modalclose",function(){e.trigger("close")}).on("modalopen",function(){e.trigger("open")}),this.$email=this.$el.find("input.auth-prompt__email"),this.$password=this.$el.find("input.auth-prompt__password"),this.$remember=this.$el.find("input.auth-prompt__remember"),this.$thinkers=this.$el.find(["form.auth-prompt__option--standard","button.auth-prompt__login","button.auth-prompt__facebook"].join(", ")).add(this.$email).add(this.$password),this},_startThinking:function(){this.$thinkers.prop("disabled",!0),this.$el.addClass("auth-prompt--thinking"),this._spinner||(this._spinner=new o({className:"spinner spinner--centered"})),this._spinner.spin(this.el)}});return l}),define("hbs!templates/authError",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Error",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Sorry, an error occurred. Please log in and try again.",{name:"t",hash:{},data:i}))+'</p>\n  <p><a class="l3" href="/session/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log in",{name:"t",hash:{},data:i}))+"</a></p>\n</div>\n"},useData:!0});return t.registerPartial("templates/authError",n),n}),define("utils/callback",["lodash"],function(e){"use strict";var t=Number(new Date),n="tedc"+t,i=0;return function(t){var s=n+ ++i,a=this;return window[s]=function(){t.apply(a,e.toArray(arguments)),delete window[s]},s}}),define("utils/iframep",["jquery","utils/callback"],function(e,t){"use strict";return function(n){function i(){"pending"===a.state&&(a.reject(),delete window[o])}function s(){var e=l.contentDocument||l.contentWindow&&l.contentWindow.document;window[o]&&window.setTimeout("complete"===e.readyState?i:s,300)}var a=new e.Deferred,o=t(function(e){a.resolve(e)});n=n.replace("callback=?","callback="+o);var r=e("<iframe></iframe>").css({display:"none",width:0,height:0}).appendTo(document.body),l=r.get(0);return r.ready(s).attr("src",n),a.always(function(){r.remove()}),window.setTimeout(i,5e3),a.promise()}}),define("utils/origin",[],function(){"use strict";return window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}),define("lib/auth",["jquery","lodash","lib/currentUser","lib/errorCollector","Modernizr","views/AuthPromptView","hbs!templates/authError","utils/callback","utils/iframep","utils/origin","lib/pubSub","utils/ted","exports"],function(e,t,n,i,s,a,o,r,l,u,c,d,h){"use strict";function p(e){e.done(function(e){c("auth.login").publish(e)})}function f(){w?w.open():e(o()).modal()}function m(){if(!E)throw new Error("lib/auth: please check auth.capable() to ensure client support before using auth methods.");if(!h.capable())throw f(),new Error("lib/auth: this client is not capable of using auth methods.")}function g(){return l("/session/check?callback=?").done(_)}function _(t){e("head").append(v("csrf-param",t.csrf.param)+v("csrf-token",t.csrf.token))}function v(e,t){return'<meta name="'+e+'" content="'+t+'">'}function b(e,t){return function(n){e.reject(n),h._reportError(t)}}function y(){a||(a=require("views/AuthPromptView"))}var w,k,x,E=!1,T=window.console;h._openPrompt=function(){x||(y(),x=new a,x.on("close",function(){t.defer(function(){k&&"pending"!==k.state()&&k.reject()})}).on("login.success",function(){h._resolveDetails(k).fail(f)}).render()),x.open()},h._reportError=function(e){var t="Auth error: "+e;i.log(t),T&&T.log&&T.log(t)},h._reset=function(){E=!1,w=void 0,k=void 0,x=void 0},h._resolveDetails=function(e){return n.getDetails().done(function(t){e.resolve(t)})},h.capable=function(){return E=!0,s.cors},h.facebook=function(){function t(e){e&&e.csrf&&_(e),"pending"===n.state()&&(p(n),h._resolveDetails(n).fail(b(n,"unable to corroborate Facebook authentication")),s&&s.close())}m();var n=new e.Deferred,i=r(t),s=window.open("/users/new?facebook=true&referer="+encodeURIComponent(u+"/session/check?callback="+i),"authfb",["scrollbars=1","resizable=1","height=480","width=640"].join(",")),a=0,o=300,l=1e4,c=window.setInterval(function(){a++,(s&&s.closed||!s&&a*o>l)&&(t(),window[i]&&delete window[i],window.clearInterval(c),c=null)},o);return n.promise()},h.login=function(t,n,i){m();var s=new e.Deferred;return h._resolveDetails(s).then(function(e){s.resolve(e)},function(){e.ajax({url:d("authHost")+"/session/new.json",timeout:3e3,type:"GET",xhrFields:{withCredentials:!0}}).then(function(a){p(s),e.ajax({url:d("authHost")+"/session.json",timeout:3e3,type:"POST",data:{authenticity_token:a.authenticity_token,user:{email:t,password:n,remember_me:i}},xhrFields:{withCredentials:!0}}).then(function(){g().then(function(){h._resolveDetails(s).fail(b(s,"unable to corroborate authentication"))},b(s,"session check timed out"))},b(s,"credentials rejected"))},b(s,"could not obtain token"))}),s.promise()},h.logout=function(){m()},h.prompt=function(){m();var t=new e.Deferred;return k=t,h._resolveDetails(t).fail(h._openPrompt),t.promise()},c("auth.login").subscribe(function(){e(document.documentElement).addClass("loggedin").removeClass("loggedout")}),e(function(){e(document).on("click","a.auth-login",function(e){h.capable()&&(e.preventDefault(),h.prompt())})})}),define("hbs!templates/authRequest",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Please log in",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Please log in or sign up to complete this action.",{name:"t",hash:{},data:i}))+'</p>\n  <p><a class="l3" href="/session/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log in or sign up",{name:"t",hash:{},data:i}))+"</a></p>\n</div>\n"},useData:!0});return t.registerPartial("templates/authRequest",n),n}),define("views/AuthView",["jquery","lodash","Backbone","lib/currentUser","lib/auth","hbs!templates/authRequest","widgets/modal"],function(e,t,n,i,s,a){"use strict";function o(){if(r)r.modal("open");else{var t=e(a());r=t.modal()}}var r,l=t.memoize(function(){return i.getDetails()}),u=n.View.extend({demandAuthFor:function(n){if(arguments.length>1)return void this.demandAuthFor(t.toArray(arguments));if(t.isArray(n))return void t.each(n,function(e){this.demandAuthFor(e)},this);var i=this[n];this[n]=function(){function t(){i.apply(a,n)}var n=arguments,a=this;n[0]instanceof e.Event&&n[0].preventDefault(),l().then(t,function(){s.capable()?s.prompt().done(t):o()})}}});return u}),function(e){function t(e,t){return function(n){return l(e.call(this,n),t)}}function n(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function i(){}function s(e){o(this,e)}function a(e){var t=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,a=e.hours||e.hour||e.h||0,o=e.minutes||e.minute||e.m||0,r=e.seconds||e.second||e.s||0,l=e.milliseconds||e.millisecond||e.ms||0;this._input=e,this._milliseconds=l+1e3*r+6e4*o+36e5*a,this._days=s+7*i,this._months=n+12*t,this._data={},this._bubble()}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e){return 0>e?Math.ceil(e):Math.floor(e)}function l(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function u(e,t,n,i){var s,a,o=t._milliseconds,r=t._days,l=t._months;o&&e._d.setTime(+e._d+o*n),(r||l)&&(s=e.minute(),a=e.hour()),r&&e.date(e.date()+r*n),l&&e.month(e.month()+l*n),o&&!i&&O.updateOffset(e),(r||l)&&(e.minute(s),e.hour(a))}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e,t){var n,i=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),a=0;for(n=0;i>n;n++)~~e[n]!==~~t[n]&&a++;return a+s}function h(e){return e?st[e]||e.toLowerCase().replace(/(.)s$/,"$1"):e}function p(e,t){return t.abbr=e,F[e]||(F[e]=new i),F[e].set(t),F[e]}function f(e){if(!e)return O.fn._lang;if(!F[e]&&j)try{require("./lang/"+e)}catch(t){return O.fn._lang}return F[e]}function m(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function g(e){var t,n,i=e.match(q);for(t=0,n=i.length;n>t;t++)i[t]=lt[i[t]]?lt[i[t]]:m(i[t]);return function(s){var a="";for(t=0;n>t;t++)a+=i[t]instanceof Function?i[t].call(s,e):i[t];return a}}function _(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var i=5;i--&&$.test(t);)t=t.replace($,n);return at[t]||(at[t]=g(t)),at[t](e)}function v(e,t){switch(e){case"DDDD":return B;case"YYYY":return Y;case"YYYYY":return V;case"S":case"SS":case"SSS":case"DDD":return W;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return G;case"a":case"A":return f(t._l)._meridiemParse;case"X":return Z;case"Z":case"ZZ":return J;case"T":return K;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return H;default:return new RegExp(e.replace("\\",""))}}function b(e){var t=(J.exec(e)||[])[0],n=(t+"").match(tt)||["-",0,0],i=+(60*n[1])+~~n[2];return"+"===n[0]?-i:i}function y(e,t,n){var i,s=n._a;switch(e){case"M":case"MM":s[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":i=f(n._l).monthsParse(t),null!=i?s[1]=i:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(s[2]=~~t);break;case"YY":s[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":s[0]=~~t;break;case"a":case"A":n._isPm=f(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":s[3]=~~t;break;case"m":case"mm":s[4]=~~t;break;case"s":case"ss":s[5]=~~t;break;case"S":case"SS":case"SSS":s[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=b(t)}null==t&&(n._isValid=!1)}function w(e){var t,n,i=[];if(!e._d){for(t=0;7>t;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];i[3]+=~~((e._tzm||0)/60),i[4]+=~~((e._tzm||0)%60),n=new Date(0),e._useUTC?(n.setUTCFullYear(i[0],i[1],i[2]),n.setUTCHours(i[3],i[4],i[5],i[6])):(n.setFullYear(i[0],i[1],i[2]),n.setHours(i[3],i[4],i[5],i[6])),e._d=n}}function k(e){var t,n,i=e._f.match(q),s=e._i;for(e._a=[],t=0;t<i.length;t++)n=(v(i[t],e).exec(s)||[])[0],n&&(s=s.slice(s.indexOf(n)+n.length)),lt[i[t]]&&y(i[t],n,e);s&&(e._il=s),e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),w(e)}function x(e){var t,n,i,a,r,l=99;for(a=0;a<e._f.length;a++)t=o({},e),t._f=e._f[a],k(t),n=new s(t),r=d(t._a,n.toArray()),n._il&&(r+=n._il.length),l>r&&(l=r,i=n);o(e,i)}function E(e){var t,n=e._i,i=X.exec(n);if(i){for(e._f="YYYY-MM-DD"+(i[2]||" "),t=0;4>t;t++)if(et[t][1].exec(n)){e._f+=et[t][0];break}J.exec(n)&&(e._f+=" Z"),k(e)}else e._d=new Date(n)}function T(t){var n=t._i,i=U.exec(n);n===e?t._d=new Date:i?t._d=new Date(+i[1]):"string"==typeof n?E(t):c(n)?(t._a=n.slice(0),w(t)):t._d=new Date(n instanceof Date?+n:n)}function C(e,t,n,i,s){return s.relativeTime(t||1,!!n,e,i)}function S(e,t,n){var i=N(Math.abs(e)/1e3),s=N(i/60),a=N(s/60),o=N(a/24),r=N(o/365),l=45>i&&["s",i]||1===s&&["m"]||45>s&&["mm",s]||1===a&&["h"]||22>a&&["hh",a]||1===o&&["d"]||25>=o&&["dd",o]||45>=o&&["M"]||345>o&&["MM",N(o/30)]||1===r&&["y"]||["yy",r];return l[2]=t,l[3]=e>0,l[4]=n,C.apply({},l)}function D(e,t,n){var i,s=n-t,a=n-e.day();return a>s&&(a-=7),s-7>a&&(a+=7),i=O(e).add("d",a),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function M(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=f().preparse(t)),O.isMoment(t)?(e=o({},t),e._d=new Date(+t._d)):n?c(n)?x(e):k(e):T(e),new s(e))}function P(e,t){O.fn[e]=O.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),O.updateOffset(this),this):this._d["get"+n+t]()}}function I(e){O.duration.fn[e]=function(){return this._data[e]}}function A(e,t){O.duration.fn["as"+e]=function(){return+this/t}}for(var O,L,R="2.1.0",N=Math.round,F={},j="undefined"!=typeof module&&module.exports,U=/^\/?Date\((\-?\d+)/i,z=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,q=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,$=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,H=/\d\d?/,W=/\d{1,3}/,B=/\d{3}/,Y=/\d{1,4}/,V=/[+\-]?\d{1,6}/,G=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,J=/Z|[\+\-]\d\d:?\d\d/i,K=/T/i,Z=/[\+\-]?\d+(\.\d{1,3})?/,X=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Q="YYYY-MM-DDTHH:mm:ssZ",et=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],tt=/([\+\-]|\d\d)/gi,nt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),it={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},st={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},at={},ot="DDD w W M D d".split(" "),rt="M D H h m s w W".split(" "),lt={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return l(~~(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(~~(e/60),2)+":"+l(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(~~(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ot.length;)L=ot.pop(),lt[L+"o"]=n(lt[L],L);for(;rt.length;)L=rt.pop(),lt[L+L]=t(lt[L],2);for(lt.DDDD=t(lt.DDD,3),i.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,i;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=O([2e3,t]),i="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(i.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,i;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=O([2e3,1]).day(t),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"
},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,i){var s=this._relativeTime[n];return"function"==typeof s?s(e,t,n,i):s.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return D(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},O=function(e,t,n){return M({_i:e,_f:t,_l:n,_isUTC:!1})},O.utc=function(e,t,n){return M({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},O.unix=function(e){return O(1e3*e)},O.duration=function(e,t){var n,i,s=O.isDuration(e),o="number"==typeof e,r=s?e._input:o?{}:e,l=z.exec(e);return o?t?r[t]=e:r.milliseconds=e:l&&(n="-"===l[1]?-1:1,r={y:0,d:~~l[2]*n,h:~~l[3]*n,m:~~l[4]*n,s:~~l[5]*n,ms:~~l[6]*n}),i=new a(r),s&&e.hasOwnProperty("_lang")&&(i._lang=e._lang),i},O.version=R,O.defaultFormat=Q,O.updateOffset=function(){},O.lang=function(e,t){return e?(t?p(e,t):F[e]||f(e),void(O.duration.fn._lang=O.fn._lang=f(e))):O.fn._lang._abbr},O.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),f(e)},O.isMoment=function(e){return e instanceof s},O.isDuration=function(e){return e instanceof a},O.fn=s.prototype={clone:function(){return O(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return _(O(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!d(this._a,(this._isUTC?O.utc(this._a):O(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=_(this,e||O.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?O.duration(+t,e):O.duration(e,t),u(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?O.duration(+t,e):O.duration(e,t),u(this,n,-1),this},diff:function(e,t,n){var i,s,a=this._isUTC?O(e).zone(this._offset||0):O(e).local(),o=6e4*(this.zone()-a.zone());return t=h(t),"year"===t||"month"===t?(i=432e5*(this.daysInMonth()+a.daysInMonth()),s=12*(this.year()-a.year())+(this.month()-a.month()),s+=(this-O(this).startOf("month")-(a-O(a).startOf("month")))/i,s-=6e4*(this.zone()-O(this).startOf("month").zone()-(a.zone()-O(a).startOf("month").zone()))/i,"year"===t&&(s/=12)):(i=this-a,s="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?s:r(s)},from:function(e,t){return O.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(O(),e)},calendar:function(){var e=this.diff(O().startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?"string"==typeof e&&(e=this.lang().weekdaysParse(e),"number"!=typeof e)?this:this.add({d:e-t}):t},month:function(e){var t,n=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(t,this.daysInMonth())),O.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(e){switch(e=h(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),this},endOf:function(e){return this.startOf(e).add(e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+O(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+O(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+O(e).startOf(t)},min:function(e){return e=O.apply(null,arguments),this>e?this:e},max:function(e){return e=O.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=b(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&u(this,O.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return O.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=N((O(this).startOf("day")-O(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=D(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=D(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=D(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},lang:function(t){return t===e?this._lang:(this._lang=f(t),this)}},L=0;L<nt.length;L++)P(nt[L].toLowerCase().replace(/s$/,""),nt[L]);P("year","FullYear"),O.fn.days=O.fn.day,O.fn.months=O.fn.month,O.fn.weeks=O.fn.week,O.fn.isoWeeks=O.fn.isoWeek,O.fn.toJSON=O.fn.toISOString,O.duration.fn=a.prototype={_bubble:function(){var e,t,n,i,s=this._milliseconds,a=this._days,o=this._months,l=this._data;l.milliseconds=s%1e3,e=r(s/1e3),l.seconds=e%60,t=r(e/60),l.minutes=t%60,n=r(t/60),l.hours=n%24,a+=r(n/24),l.days=a%30,o+=r(a/30),l.months=o%12,i=r(o/12),l.years=i},weeks:function(){return r(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*~~(this._months/12)},humanize:function(e){var t=+this,n=S(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=O.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=O.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=h(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=h(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:O.fn.lang};for(L in it)it.hasOwnProperty(L)&&(A(L,it[L]),I(L.toLowerCase()));A("Weeks",6048e5),O.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},O.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),j&&(module.exports=O),"undefined"==typeof ender&&(this.moment=O),"function"==typeof define&&define.amd&&define("moment",[],function(){return O})}.call(this),define("templates/helpers/timeAgo",["Handlebars","moment"],function(e,t){"use strict";e.registerHelper("timeAgo",function(e){return t(e).fromNow()})}),define("hbs!templates/comment",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/timeAgo","templates/helpers/icon"],function(e,t){var n=t.template({1:function(e){return'        <img src="'+this.escapeExpression(this.lambda(null!=e?e.thumb:e,e))+'" class="comment__image__thumb">\n'},3:function(e,t,n,i){var s;return null!=(s=t["if"].call(e,null!=e?e.monogram:e,{name:"if",hash:{},fn:this.program(4,i,0),inverse:this.program(6,i,0),data:i}))?s:""},4:function(e,t,n,i){var s;return'          <div class="comment__image__thumb comment__image__monogram" style="background:#'+this.escapeExpression((s=null!=(s=t.color||(null!=e?e.color:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"color",hash:{},data:i}):s))+'">'+this.escapeExpression((s=null!=(s=t.monogram||(null!=e?e.monogram:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"monogram",hash:{},data:i}):s))+"</div>\n"},6:function(){return'          <img src="/temp/noface.png" class="comment__image__thumb">\n'},8:function(e,t,n,i){var s;return'  <div class="comment__parent">\n    '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"In reply to:",{name:"t",hash:{},data:i}))+'\n\n    <figure class="comment__quote">\n      <blockquote class="comment__quote__body">\n        '+this.escapeExpression(this.lambda(null!=(s=null!=e?e.parent:e)?s.message:s,e))+'\n      </blockquote>\n\n      <figcaption class="comment__quote__attribution">\n        '+this.escapeExpression(this.lambda(null!=(s=null!=e?e.parent:e)?s.name:s,e))+"\n      </figcaption>\n    </figure>\n  </div>\n"},10:function(e,t,n,i){var s;return"    <p>\n"+(null!=(s=t.each.call(e,e,{name:"each",hash:{},fn:this.program(11,i,0),inverse:this.noop,data:i}))?s:"")+"    </p>\n"},11:function(e,t,n,i){var s;return"        "+this.escapeExpression(this.lambda(e,e))+"\n        "+(null!=(s=t.unless.call(e,i&&i.last,{name:"unless",hash:{},fn:this.program(12,i,0),inverse:this.noop,data:i}))?s:"")+"\n"},12:function(){return"<br>"},14:function(e,t,n,i){var s,a;return'    <a class="button button--small comment__link comment__upvote '+(null!=(s=t["if"].call(e,null!=e?e.upvoted:e,{name:"if",hash:{},fn:this.program(15,i,0),inverse:this.noop,data:i}))?s:"")+'" href="#">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"upvote",{name:"icon",hash:{},data:i}))+"\n      "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Upvote",{name:"t",hash:{},data:i}))+'\n\n      <span class="comment__upvote__count" '+(null!=(s=t.unless.call(e,null!=e?e.upvotes:e,{name:"unless",hash:{},fn:this.program(17,i,0),inverse:this.noop,data:i}))?s:"")+">\n        (+"+this.escapeExpression((a=null!=(a=t.upvotes||(null!=e?e.upvotes:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"upvotes",hash:{},data:i}):a))+")\n      </span>\n    </a>\n"},15:function(){return"comment__upvote--upvoted"},17:function(){return'style="display:none"'},19:function(e,t,n,i){var s,a;return'    <span class="comment__upvote__count--ro" '+(null!=(s=t.unless.call(e,null!=e?e.upvotes:e,{name:"unless",hash:{},fn:this.program(17,i,0),inverse:this.noop,data:i}))?s:"")+">\n      Upvotes (+"+this.escapeExpression((a=null!=(a=t.upvotes||(null!=e?e.upvotes:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"upvotes",hash:{},data:i}):a))+")\n    </span>\n"},21:function(e,t,n,i){return'    <a class="comment__link comment__edit" href="#">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Edit",{name:"t",hash:{},data:i}))+'</a>\n    <a class="comment__link comment__delete" href="#">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Delete",{name:"t",hash:{},data:i}))+"</a>\n"},23:function(e,t,n,i){return'    <!-- <a class="comment__link comment__move" href="#">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Move",{name:"t",hash:{},data:i}))+"</a> -->\n"},25:function(e,t,n,i){var s;return null!=(s=t["if"].call(e,null!=e?e.reported:e,{name:"if",hash:{},fn:this.program(26,i,0),inverse:this.program(28,i,0),data:i}))?s:""},26:function(e,t,n,i){return'      <span class="comment__report comment__report--reported">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"flag",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Reported. Thank you.",{name:"t",hash:{},data:i}))+"\n      </span>\n"},28:function(e,t,n,i){return'      <a class="comment__link comment__report" href="#">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"flag",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Report",{name:"t",hash:{},data:i}))+"\n      </a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,a;return'\n<header class="comment__header">\n  <div class="media">\n    <a href=\'/profiles/'+this.escapeExpression((a=null!=(a=t.profileId||(null!=e?e.profileId:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"profileId",hash:{},data:i}):a))+'\' class="comment__image media__image">\n'+(null!=(s=t["if"].call(e,null!=e?e.thumb:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?s:"")+'    </a>\n\n    <div class="media__message">\n      <a class="comment__name" href="/profiles/'+this.escapeExpression((a=null!=(a=t.profileId||(null!=e?e.profileId:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"profileId",hash:{},data:i}):a))+'" target="_blank">'+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"name",hash:{},data:i}):a))+'</a>\n      <div class="comment__date">\n        <strong>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Posted",{name:"t",hash:{},data:i}))+"</strong>\n        "+this.escapeExpression((t.timeAgo||e&&e.timeAgo||t.helperMissing).call(e,null!=e?e.date:e,{name:"timeAgo",hash:{},data:i}))+"\n      </div>\n    </div>\n  </div>\n</header>\n\n"+(null!=(s=t["if"].call(e,null!=e?e.parent:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+'\n<div class="comment__body hyphens">\n'+(null!=(s=t.each.call(e,null!=e?e.paragraphs:e,{name:"each",hash:{},fn:this.program(10,i,0),inverse:this.noop,data:i}))?s:"")+'</div>\n\n<div class="comment__editor">\n  <textarea class="comment__editor__input"></textarea>\n\n  <div class="comment__editor__message"></div>\n\n  <div class="comment__editor__controls">\n    <span class="comment__editor__count">2000</span>\n    '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"characters left",{name:"t",hash:{},data:i}))+'\n\n    <button class="button button-small comment__editor__button comment__editor__submit">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Submit",{name:"t",hash:{},data:i}))+'</button>\n  </div>\n</div>\n\n<footer class="comment__footer">\n  <a class="button button--small comment__link comment__reply" href="#">\n    '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"reply",{name:"icon",hash:{},data:i}))+"\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Reply",{name:"t",hash:{},data:i}))+"\n  </a>\n\n"+(null!=(s=t.unless.call(e,null!=e?e.isOwn:e,{name:"unless",hash:{},fn:this.program(14,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isOwn:e,{name:"if",hash:{},fn:this.program(19,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isEditable:e,{name:"if",hash:{},fn:this.program(21,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isModable:e,{name:"if",hash:{},fn:this.program(23,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t.unless.call(e,null!=e?e.isOwn:e,{name:"unless",hash:{},fn:this.program(25,i,0),inverse:this.noop,data:i}))?s:"")+'</footer>\n\n<article class="comment__response">\n  <textarea rows="6" class="comment__response__input"></textarea>\n\n  <div class="comment__response__message"></div>\n\n  <div class="comment__response__buttons">\n    <span class="comment__response__limit">\n      <span class="comment__response__limit__remain">2000</span>\n      '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"characters left",{name:"t",hash:{},data:i}))+'\n    </span>\n\n    <button class="button button--small comment__response__button comment__response__submit">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Submit",{name:"t",hash:{},data:i}))+'</button>\n  </div>\n</article>\n\n<div class="comment__replies"></div>\n'},useData:!0});return t.registerPartial("templates/comment",n),n}),define("lib/thread",["exports","lodash","jquery","lib/currentUser"],function(e,t,n,i){"use strict";function s(e,t,n){return{records:e,metadata:{page:t,pageCount:n}}}function a(e,n){var i=new Date(1e3*(0+e.date));if(!e.deleted){var s=o(e.children,t.extend({parentId:e.comment_id},n)),a=+n.currentUserId===+e.user_id;return{id:e.comment_id,parentId:n.parentId,threadId:n.threadId,isOwn:a,isModable:n.isCommentModerator,isEditable:n.isCommentModerator||a,name:e.name,profileId:e.profile_id,thumb:e.profile_pic,date:i,message:e.comment,replies:s,upvoted:!!e.actor_score_id,scoreId:e.actor_score_id||null,reported:!!e.actor_flag_id,flagId:e.actor_flag_id||null,upvotes:e.score,removed:e.deleted}}}function o(e,n){function i(e){return a(e,n)}return t.isPlainObject(e)?t.filter(t.map(t.values(e),i)):[]}var r={page:1,perPage:10,sort:"rated"},l={};e.get=function(e,a){var l=new n.Deferred;a=t.extend({},r,a);var u="/conversation_forums/"+e,c={page:a.page,per_page:a.perPage,sort:a.sort},d=new n.Deferred;return i.getDetails().then(function(e){d.resolve({currentUserId:e.id,isCommentModerator:e.isCommentModerator})},function(){d.resolve({currentUserId:!1,isCommentModerator:!1})}),n.when(n.getJSON(u,c),d).then(function(e,n){var i,a=e[0],r=n;if(a.attributes&&(a=a.attributes),!a||!a.discussion_thread)return void l.resolve(s([],1,1));i=t.extend({threadId:a.id},r);var u=a.discussion_thread.thread[0],d=o(u,i);l.resolve(s(d,c.page,t.size(u)<c.per_page?c.page:c.page+1))},function(){l.reject()}),l.promise()},e.saveComment=function(e,i){var s=n.Deferred(),a=s.promise();i=t.extend({},l,i);var o="/comments",r={comment:e.message,timestamp:Math.floor(new Date/1e3).toString()},u={};if(e.id)o="/comments/"+e.id,u._method="PUT";else if(e.parentId)r.commentable_type="comment",r.commentable_id=e.parentId;else{if(!e.threadId)return s.reject(new Error("parentId or threadId required.")),a;r.commentable_type="conversation_forum",r.commentable_id=e.threadId}return u.comment=r,n.post(o,u,null,"json").then(function(e){s.resolve(e?{id:e.id}:null)},function(){s.reject()}),a},e.destroyComment=function(e,i){var s=n.Deferred(),a=s.promise(),o="/comments/"+e,r={_method:"DELETE"};return i&&(i.send=i.send?"1":""),t.extend(r,i||{}),n.post(o,r,null,"json").then(function(){s.resolve()},function(){s.reject()}),a},e.saveFlag=function(e){var t=n.Deferred(),i=t.promise(),s="/comment_flags",a={comment_flag:{comment_id:e.commentId}};return e.id&&(s="/comment_flags/"+e.id,a._method="PUT"),n.post(s,a,null,"json").then(function(e){t.resolve({id:e.id})},function(){t.reject()}),i},e.destroyFlag=function(e){var t=n.Deferred(),i=t.promise(),s="/comment_flags/"+e,a={_method:"DELETE"};return n.post(s,a,null,"json").then(function(){t.resolve()},function(){t.reject()}),i},e.saveScore=function(e){var t=n.Deferred(),i=t.promise(),s="/comment_scores",a={comment_score:{comment_id:e.commentId}};return e.id&&(s="/comment_scores/"+e.id,a._method="PUT"),n.post(s,a,null,"json").then(function(e){t.resolve({id:e.id})},function(){t.reject()}),i},e.destroyScore=function(e){var t=n.Deferred(),i=t.promise(),s="/comment_scores/"+e,a={_method:"DELETE"};return n.post(s,a,null,"json").then(function(){t.resolve()},function(){t.reject()}),i}}),define("utils/monogram",["jquery"],function(e){"use strict";return function(t){return(t=e.trim(t))?(t=t.split(",")[0],t=t.replace(/\s[a-z]\w+\s/g," "),t=t.replace(/\s\w+\.$/,""),t=t.replace(/\s[A-Z]+$/,""),t=t.replace(/[^\s\w]+([\w])/g,"$1"),t=e.trim(t).toUpperCase().split(/\s+/),t[0][0]+(t.length>1?t[t.length-1][0]:"")):""}}),define("collections/Comments",["Backbone","models/Comment"],function(e,t){"use strict";var n=e.Collection.extend({constructor:function(){this.model||(this.model=require("models/Comment")),e.Collection.apply(this,arguments)},model:t,parent:null});return n}),define("models/Comment",["jquery","lodash","Backbone","lib/pubSub","lib/thread","lib/currentUser","utils/monogram","collections/Comments"],function(e,t,n,i,s,a,o,r){"use strict";function l(){r||(r=require("collections/Comments"))}var u=n.Model.extend({defaults:{isOwn:!0,isEditable:!0,upvotes:0,upvoted:!1},maxMessageLength:2e3,constructor:function(){l(),this.replies=new r,this.replies.parent=this,n.Model.apply(this,arguments)},initialize:function(e){this.replies.reset(e.replies)},monogram:function(){return o(this.get("name"))},parse:function(e){return this.replies.reset(e.replies),t.omit(e,"replies")},remove:function(e){var t=this,n=s.destroyComment(t.get("id"),e);return t.trigger("request",t,n),n.done(function(){t.set("removed",!0)}),n},report:function(){var e=this,t=s.saveFlag({commentId:e.get("id")});return t.done(function(t){e.set({reported:!0,flagId:t.id}),i("comment.report").publish(e.toJSON())}),t},unreport:function(){var e=this,t=s.destroyFlag(e.get("flagId"));return t.done(function(){e.set("reported",!1)}),t},sync:function(t,n){var o;return o="delete"===t?s.destroyComment(n.get("id")):"create"===t?e.when(s.saveComment(n.toJSON()).done(function(e){n.set(e)}),a.getDetails().done(function(e){n.set({name:e.firstName+" "+e.lastName,thumb:e.avatarUrl})})).done(function(){n.get("profileId")||n.set("profileId","me"),i("comment.create").publish(n.toJSON())}):s.saveComment(n.toJSON()),n.trigger("request",n,o),o},toggleUpvote:function(){var e,t=this,n=t.get("upvotes"),a=t.get("upvoted");return a?(n-=1,e=s.destroyScore(t.get("scoreId"))):(n+=1,e=s.saveScore({commentId:t.get("id")})),e.done(function(e){t.set({upvoted:!a,upvotes:n,scoreId:e?e.id||null:null}),i("comment.upvote").publish(t.toJSON())}),e},validate:function(e){return e.message?e.message.length>this.maxMessageLength?"Comments must container fewer than "+this.maxMessageLength+" characters.":e.id||e.threadId||e.parentId?void 0:"Your comment is not associated with any thread.":"Please enter a comment."}});return u}),define("hbs!templates/commentReportModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Report this comment?",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Reporting a comment or conversation sends a notification to our moderation team. They will review the message and take the appropriate action.",{name:"t",hash:{},data:i}))+"</p>\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This action cannot be undone.",{name:"t",hash:{},data:i}))+'</p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="spam">\n      '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Flag as spam",{name:"t",hash:{},data:i}))+'\n    </label>\n  </p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="abuse">\n      '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Flag as inappropriate",{name:"t",hash:{},data:i}))+'\n    </label>\n  </p>\n\n  <p class="comment-report__message" style="display:none">\n    <strong>Please select a reason for reporting this comment.</strong>\n  </p>\n\n  <button class="comment-report__submit button">Flag</button>\n  <button class="comment-report__cancel button">Cancel</button>\n</div>\n'},useData:!0});return t.registerPartial("templates/commentReportModal",n),n}),define("views/CommentReportView",["lodash","Backbone","hbs!templates/commentReportModal","widgets/modal"],function(e,t,n){"use strict";var i=t.View.extend({tagName:"div",className:"comment-report",events:{"click .comment-report__submit":"submit","click .comment-report__cancel":"cancel"},render:function(){return this.$el.html(n()).modal({close:e.bind(this.remove,this)}),this},cancel:function(){this.$el.modal("close")},submit:function(){var e=this.$el.find("input.comment-report__reason:checked").data("reason");return e?(this.disable(!0),this.model.report(e),void this.$el.modal("close")):void this.$el.find("p.comment-report__message").slideDown("fast")},disable:function(e){this.$el[e?"addClass":"removeClass"]("comment-report--disabled"),this.$el.find("button, input, textarea").prop("disabled",e)}});return i}),define("hbs!templates/commentRemoveOwnModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Remove your comment?",{name:"t",hash:{},data:i}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Are you sure you want to delete your comment?",{name:"t",hash:{},data:i}))+"</p>\n  <p>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This action cannot be undone.",{name:"t",hash:{},data:i}))+'</p>\n\n  <button class="comment-remove__submit button">Yes, delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n'},useData:!0});return t.registerPartial("templates/commentRemoveOwnModal",n),n}),define("hbs!templates/commentRemoveModModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'        <option value="'+this.escapeExpression((s=null!=(s=t.value||(null!=e?e.value:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"value",hash:{},data:i}):s))+'">'+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Remove this comment?",{name:"t",hash:{},data:i}))+'</h3>\n  </div>\n\n  <div class="form-group">\n    <select class="form-control form-control--dropdown comment-remove__reason">\n      <option value="">Reason for deletion</option>\n'+(null!=(s=t.each.call(e,null!=e?e.reasons:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'    </select>\n  </div>\n\n  <div class="form-group">\n    <label class="checkbox">\n      <input class="checkbox__input comment-remove__send" type="checkbox">\n      <span class="form-label">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Send an email notifying the commenter.",{name:"t",hash:{},data:i}))+'</span>\n    </label>\n  </div>\n\n  <div class="form-group">\n    <input class="form-control comment-remove__subject" type="text" value="Your TED.com comment">\n  </div>\n\n  <div class="form-group">\n    <textarea class="form-control comment-remove__email" rows="5"></textarea>\n  </div>\n\n  <button class="comment-remove__submit button">Delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n'},useData:!0});return t.registerPartial("templates/commentRemoveModModal",n),n}),define("hbs!templates/emails/commentRemoveNone",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nThank you for your post, but I'm afraid the right folks won't see it in these comments. Would you mind sending this in via our contact form?\n\nhttp://www.ted.com/contact\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemoveNone",n),n}),define("hbs!templates/emails/commentRemoveCollateral",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nWe're sorry, but your comment (included below) has been removed, as a comment it was in response to was deleted. Please feel free to start a new discussion with your comment (included below).\n\n"+this.escapeExpression((s=null!=(s=t.url||(null!=e?e.url:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"url",hash:{},data:i}):s))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemoveCollateral",n),n}),define("hbs!templates/emails/commentRemoveInappropriate",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nWe're sorry. Your comment has been removed according to the TED.com Terms of Use:\n\nhttp://www.ted.com/termsofuse\n\nWant to rephrase your comment?\n\nRejoin the conversation:\n\n"+this.escapeExpression((s=null!=(s=t.url||(null!=e?e.url:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"url",hash:{},data:i}):s))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemoveInappropriate",n),n}),define("hbs!templates/emails/commentRemoveGeneral",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nTED comment threads are a welcoming place for differing opinions, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the other party were sitting across from you at a dinner table. How could you engage them in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\nhttp://www.ted.com/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"
},useData:!0});return t.registerPartial("templates/emails/commentRemoveGeneral",n),n}),define("hbs!templates/emails/commentRemoveOffTopic",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nWe're sorry, but we need you to stay on topic as you chime in on conversations, or consider starting a new topic of your own. The full text of your comment is included below, please let us know if you have any questions.\n\nWant to rephrase your comment? Rejoin the conversation:\n\n"+this.escapeExpression((s=null!=(s=t.url||(null!=e?e.url:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"url",hash:{},data:i}):s))+"\n\nStart a new Conversation:\n\nhttp://www.ted.com/conversations\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemoveOffTopic",n),n}),define("hbs!templates/emails/commentRemovePoorlyWritten",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nWe're sorry. We have removed your comment (included below) from TED.com, because the writing was difficult to understand. Want to clarify and re-post your comment?\n\nRejoin the conversation:\n\n"+this.escapeExpression((s=null!=(s=t.url||(null!=e?e.url:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"url",hash:{},data:i}):s))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemovePoorlyWritten",n),n}),define("hbs!templates/emails/commentRemoveRude",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"Dear "+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+",\n\nTED comment threads are a welcoming place for critical comment and debate, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling, especially those that are aggressive towards a speaker personally, do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the speaker were sitting across from you at a dinner table. Our speakers do read and respond to comments. How could you engage the speaker in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\nhttp://www.ted.com/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((s=null!=(s=t.comment||(null!=e?e.comment:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"comment",hash:{},data:i}):s))+"\n"},useData:!0});return t.registerPartial("templates/emails/commentRemoveRude",n),n}),define("views/CommentRemoveView",["lodash","Backbone","hbs!templates/commentRemoveOwnModal","hbs!templates/commentRemoveModModal","hbs!templates/emails/commentRemoveNone","hbs!templates/emails/commentRemoveCollateral","hbs!templates/emails/commentRemoveInappropriate","hbs!templates/emails/commentRemoveGeneral","hbs!templates/emails/commentRemoveOffTopic","hbs!templates/emails/commentRemovePoorlyWritten","hbs!templates/emails/commentRemoveRude","widgets/modal"],function(e,t,n,i,s,a,o,r,l,u,c){"use strict";var d=t.View.extend({tagName:"div",className:"comment-remove",events:{"change .comment-remove__reason":"reason","click .comment-remove__submit":"submit","click .comment-remove__cancel":"cancel"},reasons:[{value:"comment_none",label:"None",email:s},{value:"comment_collateral",label:"Collateral damage",email:a},{value:"comment_inappropriate",label:"Inappropriate",email:o},{value:"comment_general",label:"General",email:r},{value:"comment_off_topic",label:"Off-topic",email:l},{value:"comment_poorly_written",label:"Poorly written",email:u},{value:"comment_rude",label:"Rude critique",email:c}],reason:function(){var t=e.find(this.reasons,{value:this.$reason.val()}),n={name:this.model.get("name"),comment:this.model.get("message"),url:window.location.href};this.$email.val(t?t.email(n):"")},render:function(){var t=this.model.get("isOwn");return this.$el.html(t?n():i({reasons:this.reasons})),this.$el.modal({close:e.bind(this.remove,this)}),t||(this.$email=this.$el.find("textarea.comment-remove__email"),this.$reason=this.$el.find("select.comment-remove__reason"),this.$subject=this.$el.find("input.comment-remove__subject")),this},cancel:function(){this.$el.modal("close")},submit:function(){this.disable(!0),this.model.get("isOwn")?this.model.remove():this.model.remove({reason:this.$reason.val(),email:this.$email.val(),subject:this.$subject.val(),send:this.$el.find("input.comment-remove__send:checked").length>0}),this.$el.modal("close")},disable:function(e){this.$el[e?"addClass":"removeClass"]("comment-remove--disabled"),this.$el.find("button, input, textarea").prop("disabled",e)}});return d}),define("utils/paragraphs",[],function(){"use strict";var e="\n";return function(t){var n,i;if(!t)return[[]];for(n=t.replace(/\r\n/g,e).replace(/\r/g,e).split(e+e),i=n.length;i--;)n[i]=n[i].split(e);return n}}),define("views/CommentView",["jquery","lodash","views/AuthView","views/CommentsView","hbs!templates/comment","models/Comment","spinjs","hbs!templates/commentApologyModal","views/CommentReportView","views/CommentRemoveView","utils/paragraphs","widgets/modal"],function(e,t,n,i,s,a,o,r,l,u,c){"use strict";function d(){i||(i=require("views/CommentsView"))}var h=["ADD1D6","B0C4CC","778390","4B6375"],p={},f=t.once(function(){p.$apology=null,p.$body=e("body, html"),p.reportView=null}),m="comment__upvote--upvoted",g=n.extend({tagName:"article",className:"comment",events:{"click a.comment__reply":"toggleReply","click a.comment__upvote":"upvote","click a.comment__report":"report","click a.comment__edit":"toggleEdit","click a.comment__delete":"remove","click a.comment__move":"move","click button.comment__response__submit":"submit","input textarea.comment__response__input":"recountResponse","click button.comment__editor__submit":"submitEdit","input textarea.comment__editor__input":"recountEdit"},initialize:function(){this.listenTo(this.model,"change:upvotes",this.refreshUpvotes),this.listenTo(this.model,"change:reported",this.refreshReported),this.listenTo(this.model,"change:removed",this.refreshRemoved),this.listenTo(this.model,"change:message",this.refreshMessage),this.listenTo(this.model,"request",this._request),this.demandAuthFor("toggleReply","upvote","report","toggleEdit","remove","move"),this.$el.data("view",this)},recountResponse:function(e){this._checkEventRecipient("recountResponse",e)&&this.$responseCount.text(this.model.maxMessageLength-this.$responseText.val().length)},render:function(){f();var e=this.model.collection.parent,n=this.model.toJSON();return n.monogram=this.model.monogram(),n.color=t.shuffle(h)[0],n.paragraphs=c(n.message),this.$el.attr("id","comment-"+n.id).html(s(t.extend({parent:e?e.toJSON():!1},n))),this.$body=this.$el.find("div.comment__body"),this.$editLink=this.$el.find("a.comment__edit"),this.$edit=this.$el.find("div.comment__editor"),this.$editText=this.$edit.find("textarea.comment__editor__input"),this.$editMessage=this.$edit.find("div.comment__editor__message"),this.$editCount=this.$edit.find("span.comment__editor__count"),this.$response=this.$el.find("article.comment__response"),this.$responseText=this.$response.find("textarea"),this.$responseMessage=this.$response.find("div.comment__response__message"),this.$responseCount=this.$response.find("span.comment__response__limit__remain"),this.$replyLink=this.$el.find("a.comment__reply"),this.$upvote=this.$el.find("a.comment__upvote"),this.$upvoteCount=this.$el.find("span.comment__upvote__count"),this._renderReplies(),this},refreshMessage:function(){this.$body.text(this.model.get("message"))},refreshRemoved:function(){this.$el.slideUp("fast")},toggleEdit:function(e){if(this._checkEventRecipient("toggleEdit",e)){e.preventDefault();var n="none"===this.$edit.css("display"),i=this;this.$editLink[n?"addClass":"removeClass"]("comment__link--active"),n?(i.$editText.val(i.model.get("message")),i.recountEdit(e),i.$body.slideUp("fast"),i.$edit.slideDown("fast"),t.delay(function(){i.$editText.focus()},100)):(this.$edit.slideUp("fast"),this.$body.slideDown("fast"))}},remove:function(e){this._checkEventRecipient("remove",e)&&(e.preventDefault(),new u({model:this.model}).render())},move:function(e){this._checkEventRecipient("move",e)&&e.preventDefault()},submitEdit:function(e){var t=this;if(t._checkEventRecipient("submitEdit",e)){e.preventDefault();var n=t.model.get("message");t.model.set("message",t.$editText.val());var i=t.model.save();i?(t.$editMessage.slideUp("fast"),this._getSpinner().spin(t.$edit.get(0)),this.disableEdit(!0),i.then(function(){t.$edit.slideUp("fast"),t.$body.slideDown("fast")},function(){t.apologize(),t.model.set("message",n)}).always(function(){t._spinner.stop(),t.disableEdit(!1)})):(t.model.set("message",n),t.$editMessage.text(t.model.validationError).slideDown("fast"))}},disableEdit:function(e){this.$edit.find("button, input, textarea").prop("disabled",e)},recountEdit:function(e){this._checkEventRecipient("recountEdit",e)&&(e.preventDefault(),this.$editCount.text(this.model.maxMessageLength-this.$editText.val().length))},toggleReply:function(e){if(this._checkEventRecipient("toggleReply",e)){e.preventDefault();var t="none"===this.$response.css("display"),n=this;this.$replyLink[t?"addClass":"removeClass"]("comment__link--active"),t?this.$response.slideDown(400,function(){n.$responseText.focus()}):this.$response.slideUp("fast")}},upvote:function(e){this._checkEventRecipient("upvote",e)&&(e.preventDefault(),this.model.toggleUpvote())},report:function(e){this._checkEventRecipient("report",e)&&(e.preventDefault(),this.model.get("reported")?this.model.unreport():new l({model:this.model}).render())},submit:function(e){var t=this;if(t._checkEventRecipient("submit",e)){e.preventDefault();var n=new a({parentId:t.model.get("id"),message:t.$responseText.val()}),i=n.save();i?(t.$responseMessage.slideUp("fast"),this._getSpinner().spin(t.$response.get(0)),this.disableResponse(!0),i.then(function(){t.model.replies.add(n,{at:0}),t.$responseText.val(""),t.$response.slideUp("fast")},function(){t.apologize(),n=null}).always(function(){t._spinner.stop(),t.disableResponse(!1)})):(t.$responseMessage.text(n.validationError).slideDown("fast"),n=null)}},disableResponse:function(e){this.$response[e?"addClass":"removeClass"]("comment__response--disabled"),this.$response.find("button, input, textarea").prop("disabled",e)},apologize:function(){p.$apology?p.$apology.modal("open"):p.$apology=e(r()).modal()},refreshUpvotes:function(){var e=this.model.get("upvotes"),t=e&&e>0;t&&this.$upvoteCount.text("("+e+")"),this.$upvoteCount[t?"fadeIn":"fadeOut"]("fast"),this.$upvote[this.model.get("upvoted")?"addClass":"removeClass"](m)},refreshReported:function(){var t=e(s(this.model.toJSON())).find(".comment__report");this.$el.find(".comment__report").replaceWith(t)},_checkEventRecipient:function(t,n){var i=e(n.target).closest("article.comment"),s=i.data("view"),a=s===this;return a||s[t].call(s,n),a},_getSpinner:function(){return this._spinner||(this._spinner=new o),this._spinner},_renderReplies:function(){d(),this._repliesView=new i({events:{},collection:this.model.replies}),this._repliesView.render(),this._repliesView.$el.appendTo(this.$el.find("div.comment__replies"))},_pendingRequests:0,_request:function(e,t){var n=this;n._requestSpinner||(n._requestSpinner=new o),n.$body.is(":visible")&&n._requestSpinner.spin(n.$body.get(0)),n._pendingRequests++,t.always(function(){n._pendingRequests--,n._pendingRequests<=0&&n._requestSpinner.stop()})}});return g}),define("views/CommentsView",["jquery","lodash","Backbone","views/CommentView"],function(e,t,n,i){"use strict";function s(t,n){var i=e(n.target).closest("article.comment"),s=i.data("view");s[t].call(s,n)}var a=n.View.extend({tagName:"section",className:"comments",events:{"click a.comment__reply":"commentToggleReply","click a.comment__upvote":"commentUpvote","click a.comment__report":"commentReport","click a.comment__edit":"commentToggleEdit","click a.comment__delete":"commentRemove","click a.comment__move":"commentMove","click button.comment__response__submit":"commentSubmit","input textarea.comment__response__input":"commentRecountResponse","click button.comment__editor__submit":"commentSubmitEdit","input textarea.comment__editor__input":"commentRecountEdit"},initialize:function(){this.listenTo(this.collection,"add",this._addComment),this.listenTo(this.collection,"reset",this.render)},render:function(){var e=this;return e.$el.empty(),e.collection.length?e.collection.each(function(t){e._addComment(t)}):e.$el.hide(),e._rendered=!0,e},commentToggleReply:function(e){s("toggleReply",e)},commentUpvote:function(e){s("upvote",e)},commentToggleEdit:function(e){s("toggleEdit",e)},commentRemove:function(e){s("remove",e)},commentMove:function(e){s("move",e)},commentRecountResponse:function(e){s("recountResponse",e)},commentReport:function(e){s("report",e)},commentSubmit:function(e){s("submit",e)},commentSubmitEdit:function(e){s("submitEdit",e)},commentRecountEdit:function(e){s("recountEdit",e)},_addComment:function(e,t,n){var s=new i({events:{},model:e}),a=s.render().$el;this._rendered&&a.hide(),this.$el[n&&0===n.at?"prepend":"append"](a),this._rendered&&(this.$el.show(),a.slideDown("fast"))}});return a}),define("autosize",["jquery"],function(e){return function(e){var t,n={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},i='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',s=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],a=e(i).data("autosize",!0)[0];a.style.lineHeight="99px","99px"===e(a).css("lineHeight")&&s.push("lineHeight"),a.style.lineHeight="",e.fn.autosize=function(i){return this.length?(i=e.extend({},n,i||{}),a.parentNode!==document.body&&e(document.body).append(a),this.each(function(){function n(){var t,n=window.getComputedStyle?window.getComputedStyle(h,null):!1;n?(t=h.getBoundingClientRect().width,(0===t||"number"!=typeof t)&&(t=parseInt(n.width,10)),e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,i){t-=parseInt(n[i],10)})):t=p.width(),a.style.width=Math.max(t,0)+"px"}function o(){var o={};if(t=h,a.className=i.className,a.id=i.id,u=parseInt(p.css("maxHeight"),10),e.each(s,function(e,t){o[t]=p.css(t)}),e(a).css(o).attr("wrap",p.attr("wrap")),n(),window.chrome){var r=h.style.width;h.style.width="0px";{h.offsetWidth}h.style.width=r}}function r(){var e,s;t!==h?o():n(),a.value=!h.value&&i.placeholder?(p.attr("placeholder")||"")+i.append:h.value+i.append,a.style.overflowY=h.style.overflowY,s=parseInt(h.style.height,10),a.scrollTop=0,a.scrollTop=9e4,e=a.scrollTop,u&&e>u?(h.style.overflowY="scroll",e=u):(h.style.overflowY="hidden",c>e&&(e=c)),e+=f,s!==e&&(h.style.height=e+"px",m&&i.callback.call(h,h))}function l(){clearTimeout(d),d=setTimeout(function(){var e=p.width();e!==_&&(_=e,r())},parseInt(i.resizeDelay,10))}var u,c,d,h=this,p=e(h),f=0,m=e.isFunction(i.callback),g={height:h.style.height,overflow:h.style.overflow,overflowY:h.style.overflowY,wordWrap:h.style.wordWrap,resize:h.style.resize},_=p.width(),v=p.css("resize");p.data("autosize")||(p.data("autosize",!0),("border-box"===p.css("box-sizing")||"border-box"===p.css("-moz-box-sizing")||"border-box"===p.css("-webkit-box-sizing"))&&(f=p.outerHeight()-p.height()),c=Math.max(parseInt(p.css("minHeight"),10)-f||0,p.height()),p.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===v?p.css("resize","none"):"both"===v&&p.css("resize","horizontal"),"onpropertychange"in h?"oninput"in h?p.on("input.autosize keyup.autosize",r):p.on("propertychange.autosize",function(){"value"===event.propertyName&&r()}):p.on("input.autosize",r),i.resizeDelay!==!1&&e(window).on("resize.autosize",l),p.on("autosize.resize",r),p.on("autosize.resizeIncludeStyle",function(){t=null,r()}),p.on("autosize.destroy",function(){t=null,clearTimeout(d),e(window).off("resize",l),p.off("autosize").off(".autosize").css(g).removeData("autosize")}),r())})):this}}(window.jQuery||window.$),e}),define("views/ThreadView",["jquery","lodash","Backbone","spinjs","hbs!templates/commentApologyModal","views/CommentsView","models/Comment","widgets/modal","autosize"],function(e,t,n,i,s,a,o){"use strict";function r(){if(l)l.modal("open");else{var t=e(s());l=t.modal()}}var l,u=n.View.extend({events:{"click button.thread__new__button":"submitNew","input textarea.thread__new__input":"recountNew","focus textarea":"enableAutoresize","click a.thread__more":"more","click input.thread__sorts__option__input":"sort"},$els:{newArea:"div.thread__new",newAlert:"div.thread__new__alert",newCount:"span.thread__new__count",newText:"textarea.thread__new__input",comments:"div.thread__comments",sorts:"input.thread__sorts__option__input",more:"a.thread__more",loading:null},disableNew:function(e){this.init$el("newArea")&&this.$els.newArea.find("button, input, textarea").prop("disabled",e)},getSort:function(){return this.init$el("sorts")?this.$els.sorts.filter(":checked").val():null},initialize:function(){this.listenTo(this.model,"request",this._loadingMore),this.listenTo(this.model.comments,"add",this._recountComments),this.listenTo(this.model.comments,"remove",this._recountComments),this.listenTo(this.model.comments,"reset",this._recountComments)},more:function(e){e&&e.preventDefault(),this.model.more()},recountNew:function(){var e,t=o.prototype.maxMessageLength,n=this.init$el("newCount")&&this.init$el("newText"),i=this.$els;n&&(e=i.newText.val(),i.newCount.text(t-e.length))},render:function(){this.commentsView||(this.commentsView=new a({collection:this.model.comments})),this.init$el("comments")&&(this.commentsView.render().$el.appendTo(this.$els.comments),this.$els.loading=e("<div></div>").addClass("thread__loading").hide().appendTo(this.$els.comments),this._recountComments())},enableAutoresize:function(t){e(t.target).autosize()},sort:function(){this.model.sort(this.getSort())},submitNew:function(e){var t=this;if(t.init$el("newAlert")&&t.init$el("newArea")&&t.init$el("newText")){e&&e.preventDefault();var n=new o({threadId:t.model.get("id"),message:t.$els.newText.val()}),i=n.save();i?(t.$els.newAlert.slideUp("fast"),this._getSpinner().spin(t.$els.newArea.get(0)),t.disableNew(!0),i.then(function(){t.model.comments.add(n,{at:0}),t.$els.newText.val("")},function(){r(),n=null}).always(function(){t._spinner.stop(),t.disableNew(!1)})):(t.$els.newAlert.text(n.validationError).slideDown("fast"),n=null)}},init$el:function(e){var n=this.$els[e];return n&&t.isString(n)?(n=this.$el.find(n),n.length||(n=!1),this.$els[e]=n,n):n},_getSpinner:function(){return this._spinner||(this._spinner=new i),this._spinner},_loadingMore:function(e,t){var n=this;n.$els.loading&&(n._getSpinner().spin(n.$els.loading.show().get(0)),n.$el.addClass("thread--loading"),t.always(function(){n._spinner.stop(),n.$els.loading.slideUp("fast"),n.$el.removeClass("thread--loading")}).done(function(e){e&&e.metadata.pageCount<=e.metadata.page?n.init$el("more").fadeOut("fast"):n.init$el("more").show()}))},_recountCommentsLast:null,_recountComments:function(){var e=this.model.comments.length>0;e!==this._recountCommentsLast&&(this.$el[e?"removeClass":"addClass"]("thread--no-comments")[e?"addClass":"removeClass"]("thread--with-comments"),this._recountCommentsLast=e)}});return u}),define("models/Thread",["Backbone","collections/Comments","lib/thread"],function(e,t,n){"use strict";var i=e.Model.extend({defaults:{id:null,sort:"rated"},_loadingMore:!1,nextPage:1,constructor:function(){this.comments=new t,e.Model.apply(this,arguments)},more:function(){var e=this;if(!e._loadingMore){e._loadingMore=!0;var t=e.get("id"),i={page:e.nextPage,sort:e.get("sort")},s=n.get(t,i).then(function(t){var n=t.records;return n&&n.length&&(e.comments[1===e.nextPage?"reset":"add"](n),e.nextPage++),t}).always(function(){e._loadingMore=!1});e.trigger("request",e,s)}},sort:function(e){this.set("sort",e),this.nextPage=1,this.more()}});return i}),define("hbs!templates/subtitle-help-modal",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n\n  <h3 class="modal__head__title">Help with subtitles</h3>\n</div>\n\n<p><strong>Desktop / laptop users:</strong> please make sure you have the most updated versions of your browser and Flash player, and that Flash is enabled when you visit TED.com.</p>\n\n<p><strong>iOS users:</strong> to access subtitles, start playing the video, then tap the speech bubble icon that appears in the bottom row of video controls.</p>\n\n<p><strong>Android users:</strong> although Android devices do not support subtitles, you can <a href="https://play.google.com/store/apps/details?id=com.ted.android" target="_blank">download the TED app from the Google Play store</a>.</p>\n'},useData:!0});return t.registerPartial("templates/subtitle-help-modal",n),n}),define("hbs!templates/playerHeroHiccup",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(){return"        Sorry:\n        we can't play video on this browser.\n        Please make sure it's up to date\n        and that Flash 11.1 or higher is installed.\n"},3:function(){return"        We're sorry:\n        video playback cannot be initialized\n        at this time.\n"},5:function(){return"        We're sorry:\n        video playback has been interrupted.\n        You may need to refresh the page\n        to resume.\n"},7:function(){return"        We are experiencing a small hiccup.\n        Video playback may be slow or choppy.\n        Please be patient.\n        We're working on it!\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="player-hero__hiccup">\n  <div class="player-hero__inner">\n    <div class="container">\n'+(null!=(s=t["if"].call(e,null!=e?e.isClient:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isInit:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isFatal:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=e?e.isHiccup:e,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?s:"")+"\n      You can always\n      download this talk\n      or save it to watch later.\n    </div>\n  </div>\n</div>\n"},useData:!0});return t.registerPartial("templates/playerHeroHiccup",n),n}),define("hbs!templates/controlsMaxi",["hbs","hbs/handlebars","templates/helpers/icon","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){return'        <a class="controls__button controls__skip" href="#" tabindex="1" role="button">\n          '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-skip","","controls__icon",{name:"icon",hash:{},data:i}))+"\n          "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Skip",{name:"t",hash:{},data:i}))+"\n        </a>\n"},3:function(e,t,n,i){return'        <a class="controls__button controls__button--right controls__transcript" href="#" tabindex="1" role="button">\n          '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"transcript","","controls__icon",{name:"icon",hash:{},data:i}))+"\n          "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Transcript",{name:"t",hash:{},data:i}))+"\n        </a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="controls controls--maxi controls--active">\n  <div class="controls__postbar">\n    <div class="controls__postbar__progress"></div>\n  </div>\n\n  <div class="controls__scrubber scrubber">\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n  </div>\n\n  <div class="controls__toolbar">\n    <div class="controls__adtime">\n      <div class="controls__adtime__inner">\n        <div class="controls__adtime__content">\n          <span class="controls__adtime__value">0:00</span>\n        </div>\n      </div>\n    </div>\n\n    <div class="controls__toolbar__container">\n      <a class="controls__button controls__play" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-play","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Play",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="controls__button controls__pause" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-pause","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Pause",{name:"t",hash:{},data:i}))+"\n      </a>\n\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.options:e)?s.isSkip:s,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'\n      <a class="controls__button controls__volume" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-volume","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Volume",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="controls__button controls__button--right controls__fullscreen" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-fullscreen","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"FullScreen",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="controls__button controls__button--right controls__options" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-cog","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Options",{name:"t",hash:{},data:i}))+"\n      </a>\n\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.options:e)?s.isTranscript:s,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+'\n      <a class="controls__button controls__button--right controls__subtitles" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"subtitle","","controls__icon",{name:"icon",hash:{},data:i}))+"\n        "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Subtitles",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <div class="controls__meta">\n        <div class="controls__detail"></div>\n\n        <div class="controls__meta__credits"></div>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0});return t.registerPartial("templates/controlsMaxi",n),n}),define("hbs!templates/controlsMini",["hbs","hbs/handlebars","templates/helpers/icon"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div class="controls controls--mini">\n  <div class="controls__toolbar">\n    <a class="controls__button controls__play" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-play","Play","controls__icon",{name:"icon",hash:{},data:i}))+'\n    </a>\n\n    <a class="controls__button controls__pause" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-pause","Pause","controls__icon",{name:"icon",hash:{},data:i}))+'\n    </a>\n\n    <a class="controls__button controls__volume" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-volume","Volume","controls__icon",{name:"icon",hash:{},data:i}))+'\n    </a>\n\n    <a class="controls__button controls__button--right controls__fullscreen" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-fullscreen","Toggle full screen","controls__icon",{name:"icon",hash:{},data:i}))+'\n    </a>\n\n    <a class="controls__button controls__button--right controls__options" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((t.icon||e&&e.icon||t.helperMissing).call(e,"control-cog","Options","controls__icon",{name:"icon",hash:{},data:i}))+'\n    </a>\n\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n\n    <div class="controls__scrub-wrapper">\n      <div class="controls__scrubber scrubber"></div>\n    </div>\n  </div>\n</div>\n'},useData:!0});return t.registerPartial("templates/controlsMini",n),n}),define("templates/helpers/formatDate",["Handlebars","moment"],function(e,t){"use strict";function n(e,n,i){return i&&i.hash&&i.hash.forceUTC?t(n||void 0).utc().format(e):t(n||void 0).format(e)}return e.registerHelper("formatDate",n),n}),define("hbs!templates/controlsMaxiDetail",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDate"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Playlist:",{name:"t",hash:{},data:i}))+"\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"playing",{name:"t",hash:{},data:i}))+"\n    "+this.escapeExpression((s=null!=(s=t.index||(null!=e?e.index:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"index",hash:{},data:i}):s))+"\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"of",{name:"t",hash:{},data:i}))+"\n    "+this.escapeExpression((s=null!=(s=t.talksCount||(null!=e?e.talksCount:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"talksCount",hash:{},data:i}):s))+"\n"},3:function(e,t,n,i){var s;return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Filmed",{name:"t",hash:{},data:i}))+"\n    "+this.escapeExpression((t.formatDate||e&&e.formatDate||t.helperMissing).call(e,"MMMM YYYY",null!=e?e.filmed:e,{name:"formatDate",hash:{forceUTC:!0},data:i}))+"\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"at",{name:"t",hash:{},data:i}))+"\n    "+this.escapeExpression((s=null!=(s=t.event||(null!=e?e.event:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"event",hash:{},data:i}):s))+"\n"
},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,a;return'<div class="controls__meta__details">\n'+(null!=(s=t["if"].call(e,null!=e?e.isPlaylist:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?s:"")+'</div>\n<h3 class="controls__meta__title">'+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"name",hash:{},data:i}):a))+"</h3>\n"},useData:!0});return t.registerPartial("templates/controlsMaxiDetail",n),n}),define("jqueryui/mouse",["jquery"],function(e){return function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,s=1===n.which,a="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return s&&!a&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(e),e}),define("touchPunch",["jquery","jqueryui/mouse"],function(e){return function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],i=document.createEvent("MouseEvents");i.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(i)}}if(e.support.touch="ontouchend"in document,e.support.touch){var n,i=e.ui.mouse.prototype,s=i._mouseInit;i._touchStart=function(e){var i=this;!n&&i._mouseCapture(e.originalEvent.changedTouches[0])&&(n=!0,i._touchMoved=!1,t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},i._touchMove=function(e){n&&(this._touchMoved=!0,t(e,"mousemove"))},i._touchEnd=function(e){n&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),n=!1)},i._mouseInit=function(){var t=this;t.element.bind("touchstart",e.proxy(t,"_touchStart")).bind("touchmove",e.proxy(t,"_touchMove")).bind("touchend",e.proxy(t,"_touchEnd")),s.call(t)}}}(e),e}),define("widgets/slider",["jquery","jqueryui/widget","jqueryui/mouse","touchPunch"],function(e){"use strict";return e.widget("ted.slider",e.ui.mouse,{options:{distance:0,orientation:"horizontal",value:0,change:null,slide:null,start:null,stop:null},value:function(e){return arguments.length&&(this.options.value=e,this._refreshValue()),this.options.value},_change:function(e){this._trigger("change",e,this._getData({value:this.value()}))},_create:function(){this._detectOrientation(),this._mouseInit();var t=e("<div class=slider__progress></div>");this.progressElement=t,this.cursorElement=e("<div class=slider__cursor></div>").appendTo(this.progressElement),this.element.addClass("slider slider--"+this.orientation).append(this.progressElement)},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_getData:function(e){return e},_mouseCapture:function(e){var t,n;return this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:e.pageX,y:e.pageY},n=this._valueFromPosition(t),this._start(e),this._slide(e,n),!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._valueFromPosition(t);return this._slide(e,n),!1},_mouseStart:function(){return!0},_mouseStop:function(e){return this._mouseDrag(e),this._stop(e),this._change(e),!1},_refreshValue:function(){var e=this.value();this.progressElement.css("vertical"===this.orientation?"height":"width",100*e+"%")},_slide:function(e,t){this._trigger("slide",e,this._getData({value:t})),this.value(t)},_start:function(e){this.element.addClass("slider--active"),this._trigger("start",e)},_stop:function(e){this.element.removeClass("slider--active"),this._trigger("stop",e)},_valueFromPosition:function(e){var t,n,i;return"vertical"===this.orientation?(i=this.elementSize.height,n=e.y-this.elementOffset.top):(i=this.elementSize.width,n=e.x-this.elementOffset.left),t=n/i,t>1&&(t=1),0>t&&(t=0),"vertical"===this.orientation&&(t=1-t),t}}),function(t,n){return e(t).slider(n)}}),define("widgets/scrubber",["jquery","lib/ga","widgets/slider"],function(e,t){"use strict";var n="scrubber",i=n+"--active",s=n+"--hover",a=n+"__cursor",o=n+"__playhead",r=n+"__progress";return e.widget("ted.scrubber",e.ted.slider,{options:{duration:null,player:null},_isScrubbing:!1,_isSeeking:!1,_progress:0,_create:function(){this.options.player&&this._setPlayer(),this.playheadElement=e("<div class="+o+"></div>").prependTo(this.element),this._super(),this.element.addClass(n),this.cursorElement.addClass(a),this.progressElement.addClass(r),this._on(this._handleEvents)},_getData:function(t){return e.extend({cursor:t.value*this.options.duration,playhead:this._progress*this.options.duration,progress:this._progress,duration:this.options.duration},t)},_handleEvents:{mouseover:function(){this.element.addClass(s)},mouseout:function(){this.element.removeClass(s)},scrubberstart:function(){this.element.addClass(i),this._isScrubbing=!0},scrubberstop:function(){this.element.removeClass(i),this._isScrubbing=!1}},_setOption:function(e,t){this._super(e,t),"duration"===e&&this.progress(this._getData({value:this._progress}).playhead/t)},_setPlayer:function(){var n=this,i=e(this.options.player),s=i.player("talk");this.option("duration",s.duration),this._on({scrubberchange:function(e,n){i.player("seek",n.cursor),t.sendEvent("player","seek","scrubber",Math.round(n.cursor))}}),i.on("playertalk",function(e,t){n.option("duration",t.duration),n.progress(0)}).on("playerduration",function(e,t){n.option("duration",t.duration)}).on("playerseeking",function(){n._isSeeking=!0}).on("playerseeked",function(){n._isSeeking=!1}).on("playerprogress",function(e,t){n.progress(t.progress)})},isSeeking:function(e){return arguments.length&&(this._isSeeking=!!e),this._isScrubbing||this._isSeeking},progress:function(e){if(arguments.length){var t=100*e+"%";this.progressElement&&!this.isSeeking()&&this.progressElement.width(t),this.playheadElement&&this.playheadElement.width(t),this._progress=e,this._trigger("progress",null,this._getData({value:e}))}return this._progress}}),function(t,n){return e(t).scrubber(n)}}),define("jqueryui/position",["jquery"],function(e){return function(e,t){function n(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}function s(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var a,o=Math.max,r=Math.abs,l=Math.round,u=/left|center|right/,c=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(a!==t)return a;var n,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),n=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,n===i&&(i=s[0].clientWidth),s.remove(),a=n-i},getScrollInfo:function(t){var n=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),s="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,a="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]),s=!!n[0]&&9===n[0].nodeType;return{element:n,isWindow:i,isDocument:s,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var a,p,m,g,_,v,b=e(t.of),y=e.position.getWithinInfo(t.within),w=e.position.getScrollInfo(y),k=(t.collision||"flip").split(" "),x={};return v=s(b),b[0].preventDefault&&(t.at="left top"),p=v.width,m=v.height,g=v.offset,_=e.extend({},g),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=u.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=u.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=d.exec(i[0]),n=d.exec(i[1]),x[this]=[e?e[0]:0,n?n[0]:0],t[this]=[h.exec(i[0])[0],h.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===t.at[0]?_.left+=p:"center"===t.at[0]&&(_.left+=p/2),"bottom"===t.at[1]?_.top+=m:"center"===t.at[1]&&(_.top+=m/2),a=n(x.at,p,m),_.left+=a[0],_.top+=a[1],this.each(function(){var s,u,c=e(this),d=c.outerWidth(),h=c.outerHeight(),f=i(this,"marginLeft"),v=i(this,"marginTop"),E=d+f+i(this,"marginRight")+w.width,T=h+v+i(this,"marginBottom")+w.height,C=e.extend({},_),S=n(x.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?C.left-=d:"center"===t.my[0]&&(C.left-=d/2),"bottom"===t.my[1]?C.top-=h:"center"===t.my[1]&&(C.top-=h/2),C.left+=S[0],C.top+=S[1],e.support.offsetFractions||(C.left=l(C.left),C.top=l(C.top)),s={marginLeft:f,marginTop:v},e.each(["left","top"],function(n,i){e.ui.position[k[n]]&&e.ui.position[k[n]][i](C,{targetWidth:p,targetHeight:m,elemWidth:d,elemHeight:h,collisionPosition:s,collisionWidth:E,collisionHeight:T,offset:[a[0]+S[0],a[1]+S[1]],my:t.my,at:t.at,within:y,elem:c})}),t.using&&(u=function(e){var n=g.left-C.left,i=n+p-d,s=g.top-C.top,a=s+m-h,l={target:{element:b,left:g.left,top:g.top,width:p,height:m},element:{element:c,left:C.left,top:C.top,width:d,height:h},horizontal:0>i?"left":n>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>p&&r(n+i)<p&&(l.horizontal="center"),h>m&&r(s+a)<m&&(l.vertical="middle"),l.important=o(r(n),r(i))>o(r(s),r(a))?"horizontal":"vertical",t.using.call(this,e,l)}),c.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollLeft:i.offset.left,a=i.width,r=e.left-t.collisionPosition.marginLeft,l=s-r,u=r+t.collisionWidth-a-s;t.collisionWidth>a?l>0&&0>=u?(n=e.left+l+t.collisionWidth-a-s,e.left+=l-n):e.left=u>0&&0>=l?s:l>u?s+a-t.collisionWidth:s:l>0?e.left+=l:u>0?e.left-=u:e.left=o(e.left-r,e.left)},top:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollTop:i.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,l=s-r,u=r+t.collisionHeight-a-s;t.collisionHeight>a?l>0&&0>=u?(n=e.top+l+t.collisionHeight-a-s,e.top+=l-n):e.top=u>0&&0>=l?s:l>u?s+a-t.collisionHeight:s:l>0?e.top+=l:u>0?e.top-=u:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var n,i,s=t.within,a=s.offset.left+s.scrollLeft,o=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,u=e.left-t.collisionPosition.marginLeft,c=u-l,d=u+t.collisionWidth-o-l,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(n=e.left+h+p+f+t.collisionWidth-o-a,(0>n||n<r(c))&&(e.left+=h+p+f)):d>0&&(i=e.left-t.collisionPosition.marginLeft+h+p+f-l,(i>0||r(i)<d)&&(e.left+=h+p+f))},top:function(e,t){var n,i,s=t.within,a=s.offset.top+s.scrollTop,o=s.height,l=s.isWindow?s.scrollTop:s.offset.top,u=e.top-t.collisionPosition.marginTop,c=u-l,d=u+t.collisionHeight-o-l,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>c?(i=e.top+p+f+m+t.collisionHeight-o-a,e.top+p+f+m>c&&(0>i||i<r(c))&&(e.top+=p+f+m)):d>0&&(n=e.top-t.collisionPosition.marginTop+p+f+m-l,e.top+p+f+m>d&&(n>0||r(n)<d)&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,s,a,o=document.getElementsByTagName("body")[0],r=document.createElement("div");t=document.createElement(o?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in i)t.style[a]=i[a];t.appendChild(r),n=o||document.documentElement,n.insertBefore(t,n.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",s=e(r).offset().left,e.support.offsetFractions=s>10&&11>s,t.innerHTML="",n.removeChild(t)}()}(e),e}),define("widgets/popup",["jquery","lodash","jqueryui/widget","jqueryui/position"],function(e,t){"use strict";function n(e,t){this.element.removeClass(o).css(e).addClass(s+t.horizontal+" "+s+("center"===t.vertical?"middle":t.vertical))}for(var i=300,s="popup--tailed--",a=["center","left","middle","right","bottom","top"],o="",r=a.length;r--;)o+=s+a[r]+" ";return e.widget("ted.popup",{options:{position:{my:"center bottom-20",at:"center top",of:window,collision:"fit flip"},inverse:!1,tail:!0},_create:function(){this.options.position.using||(this.options.position.using=t.bind(n,this)),this.element.addClass("popup"+(this.options.tail?" popup--tailed":"")+(this.options.inverse?" popup--inverse":" inverse"))},_isOpen:!1,open:function(e){var t=this;t._trigger("beforeOpen",e)!==!1&&(t.position(),t._isOpen=!0,t.element.removeClass("popup--hide").addClass("popup--show"),t._trigger("open"))},close:function(e){var t=this,n=t.element;t._trigger("beforeClose",e)!==!1&&(t._isOpen=!1,n.addClass("popup--hide"),setTimeout(function(){t._isOpen||n.removeClass("popup--show")},i),t._trigger("close"))},position:function(){this.element.addClass("popup--positioning").position(this.options.position).removeClass("popup--positioning")}}),function(t,n){return e(t).popup(n)}}),define("widgets/tooltip",["jquery","lodash","jqueryui/widget","widgets/popup"],function(e){"use strict";var t;return e.widget("ted.tooltip",{options:{content:"",interactive:!1,interactiveTolerance:350,position:{},openDelay:0,supportTouch:!0,allowClick:!1},_create:function(){var n;t||(t=e(document.body)),this.element.addClass("tooltip"),this.options.position.of=this.element,this.popupObject=e("<div class=tooltip__popup>").append(this.options.content).popup(this.options).insertAfter(this.element),n=this.element,this.options.interactive&&(n=n.add(this.popupObject)),this._on(n,this._handleEvents),this._on(e("#shoji"),{click:function(t){!this._isOpened||this.options.interactive&&e(t.target).closest(this.popupObject).length||(this._isOpened=!1,this.popupObject.popup("close"))}})},_isHoverClickEnabled:!1,_isFirstTouch:!1,_isTouched:!1,_isMousedOver:!1,_handleEvents:{touchstart:function(){this._isTouched=!0,this._isHoverClickEnabled||(this._isFirstTouch=!0)},mouseover:function(e){var t=this,n=t.options.openDelay||0;(this.options.supportTouch||!this._isTouched)&&(this._isMousedOver=!0,this._isOpened&&(n=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._isMousedOver&&t.openPopup(e)},n))},mouseout:function(e){var t=this,n=this.options.interactiveTolerance||0;this._isMousedOver=!1,this._isOpened||(n=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t._isMousedOver||t.closePopup(e)},n)},click:function(t){e(t.target).closest(this.element).length&&((this.options.supportTouch||!this._isTouched)&&(this.openPopup(t),!this._isFirstTouch&&this._isHoverClickEnabled&&this._trigger("hoverclick",t),this._isFirstTouch=!1),this.options.allowClick||(t.preventDefault(),t.stopPropagation()))},popupopen:function(){this._isHoverClickEnabled=!0},popupclose:function(){this._isHoverClickEnabled=!1}},_setOption:function(e,t){"content"===e&&this.popupObject.html(t)},openPopup:function(e){this._isOpened=!0,this.popupObject.popup("open",e)},closePopup:function(e){this.popupObject.popup("close",e),this._off(t,"click"),this._isOpened=!1},popup:function(){return this.popupObject}}),function(t,n){return e(t).tooltip(n)}}),define("widgets/volume",["jquery","widgets/slider","widgets/tooltip"],function(e){"use strict";var t="volume",n=t+"--muted",i=t+"-slider",s=i+"--muted",a=i+"__progress";return e.widget("ted.volume",e.ted.tooltip,{options:{content:"<div class="+i+">",interactive:!0,inverse:!0,interactiveTolerance:1e3,player:null,value:0},sliderElement:null,_create:function(){this._super(),this.element.addClass(t),this.sliderElement=this.popupObject.find("div."+i),this.sliderElement.slider({orientation:"vertical"}),this.options.player&&this._setPlayer(),this._on(this.sliderElement,this._handleSliderEvents),this.sliderElement.find("div.slider__progress").addClass(a)},_handleEvents:{volumehoverclick:function(){this.mute(!this.mute())}},_handleSliderEvents:{sliderchange:function(e,t){this.closePopup(e),this._trigger("change",e,t)},sliderslide:function(e,t){this.openPopup(e),this._trigger("slide",e,t)}},_setPlayer:function(){var t=this,n=e(this.options.player);this._on({volumemute:function(e,t){n.player("mute",t.mute)},volumechange:function(e,t){n.player("volume",t.value)},volumeslide:function(e,t){n.player("volume",t.value)}}),n.on("playermuted",function(e,n){t.mute(n.muted)}).on("playervolume",function(e,n){t.value(n.volume)}),t.mute(n.player("mute")),t.value(n.player("volume"))},_isMuted:!1,mute:function(e){if(arguments.length){if(e=!!e,e===this._isMuted)return;this._isMuted=e;var t=e?"addClass":"removeClass";this.element[t](n),this.sliderElement[t](s),this._trigger("mute",null,{mute:e})}return this._isMuted},value:function(e){return arguments.length&&this.sliderElement.slider("value",e),this.sliderElement.slider("value")}}),function(t,n){return e(t).volume(n)}}),define("hbs!templates/playerOptions",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="Player-options__rate">\n  <h4 class="h10 m5" style="width:200px">Playback rate:</h4>\n\n  <ul class="sl p4">\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"id",hash:{},data:i}):s))+'-rate" value=1 checked>\n        &nbsp;\n        Normal\n      </label>\n    </li>\n\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"id",hash:{},data:i}):s))+'-rate" value=1.5>\n        &nbsp;\n        1.5x\n        <em>(faster)</em>\n      </label>\n    </li>\n\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"id",hash:{},data:i}):s))+'-rate" value=2>\n        &nbsp;\n        2x\n        <em>(fastest)</em>\n      </label>\n    </li>\n  </ul>\n</div>\n'},useData:!0});return t.registerPartial("templates/playerOptions",n),n}),define("widgets/playerOptions",["jquery","hbs!templates/playerOptions","widgets/tooltip"],function(e,t){"use strict";var n=0,i="Player-options";e.widget("ted.playerOptions",e.ted.tooltip,{options:{interactive:!0,inverse:!0,player:null},_create:function(){this.options.content=t({id:"player-options-"+ ++n}),this._super(),this.element.addClass(i),this._on(this.popupObject,{"click input.Player-options__rate__input":function(t){this._trigger("playbackRate",t,{playbackRate:+e(t.target).val()})}}),this.options.player&&this._setPlayer()},_setPlayer:function(){var t=this,n=e(t.options.player);t._on({playeroptionsplaybackrate:function(e,t){n.player("playbackRate",t.playbackRate)}}),n.on("playerplaybackrate",function(e,n){t._setPlaybackRate(n.playbackRate)}),t._setPlaybackRate(n.player("playbackRate"))},_setPlaybackRate:function(e){this.popupObject.find('input.Player-options__rate__input[value="'+e+'"]').prop("checked",!0)}})}),define("hbs!templates/subtitleCredits",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"transcript",{name:"t",hash:{},data:i}))+"\n"},3:function(e,t,n,i){return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"translation",{name:"t",hash:{},data:i}))+"\n"},5:function(e,t,n,i){var s;return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"by",{name:"t",hash:{},data:i}))+'\n    <a href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.translator:e)?s.uri:s,e))+'" target="_blank">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.translator:e)?s.name:s,e))+"</a>"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.reviewer:e)?s.name:s,{name:"if",hash:{},fn:this.program(6,i,0),inverse:this.noop,data:i}))?s:"")+"\n"},6:function(){return","},8:function(e,t,n,i){var s;return"    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"reviewed by",{name:"t",hash:{},data:i}))+'\n    <a href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.reviewer:e)?s.uri:s,e))+'" target="_blank">'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.reviewer:e)?s.name:s,e))+"</a>.\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return"<div>\n  "+this.escapeExpression(this.lambda(null!=(s=null!=e?e.language:e)?s.name:s,e))+"\n\n"+(null!=(s=t["if"].call(e,null!=e?e.isTranscript:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.translator:e)?s.name:s,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.reviewer:e)?s.name:s,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+'\n  <a class="l3" href="/talks?language='+this.escapeExpression(this.lambda(null!=(s=null!=e?e.language:e)?s.code:s,e))+'" target="_blank">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"More talks in",{name:"t",hash:{},data:i}))+" "+this.escapeExpression(this.lambda(null!=(s=null!=e?e.language:e)?s.name:s,e))+"</a>\n</div>\n"},useData:!0});return t.registerPartial("templates/subtitleCredits",n),n}),define("widgets/subtitleCredits",["jquery","lodash","hbs!templates/subtitleCredits"],function(e,t,n){"use strict";var i="subtitle-credits",s=i+"--visible";return e.widget("ted.subtitleCredits",{options:{activeLanguage:!1,player:null,talkSlug:null},_create:function(){this.element.addClass(i),this.options.player&&this._setPlayer()},_setPlayer:function(){var e=this,t=e.options.player;this._on(e.options.player,{playersubtitle:function(t,n){e.activateLanguage(n.subtitle?n.subtitle.languageCode:!1)},playertalk:function(t,n){e.option("talkSlug",n.slug)}}),e._setOption("talkSlug",t.player("talk").slug);var n=t.player("subtitle");e.activateLanguage(n?n.languageCode:!1)},_setOption:function(e,t){this._super(e,t),("talkSlug"===e||"activeLanguage"===e)&&this.activateLanguage(this.options.activeLanguage)},activateLanguage:function(n){n&&this.options.talkSlug?(this.options.activeLanguage=n,e.getJSON("/talks/"+this.options.talkSlug+"/caption_credits",{language:n}).then(t.bind(this.setSubtitleData,this),t.bind(this.hide,this))):this.hide(),this._trigger("activateLanguage",null,{languageCode:n})},setSubtitleData:function(e){return e.translator&&e.translator.name||e.reviewer&&e.reviewer.name?(e.isTranscript=e.languageCode===this.options.player.player("talk").nativeLanguage,this.element.html(n(e)),void this.show()):this.hide()},hide:function(){this._trigger("hide"),this.element.removeClass(s)},show:function(){this._trigger("show"),this.element.addClass(s)}}),function(t,n){return e(t).subtitleCredits(n)}}),define("widgets/hover",["jquery","lodash","jqueryui/widget"],function(e,t){"use strict";function n(e,t,n){return Math.abs(e[0]-t[0])>n||Math.abs(e[1]-t[1])>n}function i(e){e._hoverIsTouchTriggered=!1}var s=e(document);e.widget("ted.hover",{options:{hoverIdleDelay:4e3,hoverStartDelay:200,hoverStopDelay:400,hoverSwipeTolerance:5},hoverState:function(e){return t.isUndefined(e)||this._hoverChangeState(null,!!e),this._hoverIsOn},_hoverIsClicking:!1,_hoverIsOn:!1,_hoverIsTouchTriggered:!1,_hoverLastCoords:null,_hoverStartTimeout:null,_hoverIdleTimeout:null,_hoverStopTimeout:null,_hoverChangeStateBound:null,_hoverMoveChangeBound:null,_hoverMouseMoveThrottled:null,_hoverTouchOutBound:null,_create:function(){this._hoverInit()},_hoverEvents:function(){return{mouseenter:this._hoverMouseMoveThrottled,mousemove:this._hoverMouseMoveThrottled,mouseleave:this._hoverOut,touchstart:this._hoverTouchStart,touchend:this._hoverTouchEnd,touchmove:this._hoverTouchMove,touchcancel:this._hoverTouchCancel,mousedown:this._hoverMouseDown,mouseup:this._hoverMouseUp,click:this._hoverMouseClick}},_hoverMove:function(e){this._hoverIsOn?this._hoverMoveChange(e):this._hoverStartSetTimeout(e)},_hoverMoveChange:function(e){var t={x:e.pageX||null,y:e.pageY||null};"mousedown"!==e.type&&"touchstart"!==e.type&&this._hoverLastCoords&&t.x&&t.x===this._hoverLastCoords.x&&t.y===this._hoverLastCoords.y||(this._hoverLastCoords=t,this._hoverChangeState(e,!0),this._hoverIdleSetTimeout(e))},_hoverOut:function(e){this._hoverStartClearTimeout(),this._hoverStopSetTimeout(e)},_hoverMouseClick:function(e){this._hoverIsTouchTriggered||this._hoverIsOn&&this._trigger("tap",e)},_hoverMouseDown:function(){this._hoverIsTouchTriggered||(this._hoverIsClicking=!0,this._hoverIdleClearTimeout())},_hoverMouseMove:function(e){this._hoverIsTouchTriggered||this._hoverMove(e)},_hoverMouseUp:function(e){this._hoverIsTouchTriggered||(this._hoverIsClicking=!1,this._hoverIdleSetTimeout(e))},_hoverTouchStart:function(){this._hoverIsTouchTriggered=!0,this._hoverTouchStartCoords=null,this._hoverTouchEndCoords=null},_hoverTouchEnd:function(e){this._hoverTouchSafetyTimeout&&window.clearTimeout(this._hoverTouchSafetyTimeout),this._hoverTouchSafetyTimeout=t.delay(i,600,this),this._hoverTouchEndCoords&&n(this._hoverTouchStartCoords,this._hoverTouchEndCoords,this.options.hoverSwipeTolerance)||(this._hoverIsOn&&this._trigger("tap",e),this._hoverMoveChange(e))},_hoverTouchCancel:function(e){e.preventDefault()},_hoverTouchMove:function(e){var t=e.originalEvent.touches[0],n=[t.pageX,t.pageY];null===this._hoverTouchStartCoords?this._hoverTouchStartCoords=n:this._hoverTouchEndCoords=n,this._hoverIsOn&&this._hoverMove(e)},_hoverTouchOut:function(t){e(t.target).closest(this.element).length||this._hoverChangeState(t,!1)},_hoverChangeState:function(e,t){t=!!t,this._hoverIdleClearTimeout(),this._hoverStartClearTimeout(),this._hoverStopClearTimeout(),(t||!this._hoverIsClicking)&&t!==this._hoverIsOn&&(this._hoverIsOn=t,this[t?"_hoverStart":"_hoverStop"](e),t?this._on(s,{touchstart:this._hoverTouchOutBound}):this._off(s,"touchstart"))},_hoverStartSetTimeout:function(e){this._hoverStartTimeout||(this._hoverStartTimeout=t.delay(this._hoverMoveChangeBound,this.options.hoverStartDelay,e))},_hoverStartClearTimeout:function(){this._hoverStartTimeout&&(window.clearTimeout(this._hoverStartTimeout),this._hoverStartTimeout=null)},_hoverStopSetTimeout:function(e){this._hoverStopClearTimeout(),this._hoverStopTimeout=t.delay(this._hoverChangeStateBound,this.options.hoverStopDelay,e,!1)},_hoverStopClearTimeout:function(){this._hoverStopTimeout&&(window.clearTimeout(this._hoverStopTimeout),this._hoverStopTimeout=null)},_hoverIdleSetTimeout:function(e){this._hoverIdleClearTimeout(),!this._hoverIsClicking&&this.options.hoverIdleDelay&&(this._hoverIdleTimeout=t.delay(this._hoverChangeStateBound,this.options.hoverIdleDelay,e,!1))},_hoverIdleClearTimeout:function(){this._hoverIdleTimeout&&(window.clearTimeout(this._hoverIdleTimeout),this._hoverIdleTimeout=null)},_hoverInit:function(){this._hoverChangeStateBound=t.bind(this._hoverChangeState,this),this._hoverMoveChangeBound=t.bind(this._hoverMoveChange,this),this._hoverTouchOutBound=t.bind(this._hoverTouchOut,this),this._hoverMouseMoveThrottled=t.throttle(t.bind(this._hoverMouseMove,this),100,{leading:!0,trailing:!1}),this._on(this._hoverEvents())},_hoverDestroy:function(){this._off(this._hoverEvents())},_hoverStart:function(e){this._trigger("start",e)},_hoverStop:function(e){this._trigger("stop",e)}})}),define("widgets/controls",["jquery","lodash","utils/formatDuration","utils/is_mobile","views/subtitle-modal","hbs!templates/controlsMaxi","hbs!templates/controlsMini","hbs!templates/controlsMaxiDetail","widgets/scrubber","widgets/volume","widgets/playerOptions","widgets/subtitleCredits","widgets/hover"],function(e,t,n,i,s,a,o,r){"use strict";function l(e,t){return function(n){e.call(t,n)!==!1&&n.preventDefault()}}function u(e){return e=t.clone(e),e.filmed&&(e.filmed*=1e3),(e.index||0===e.index)&&(e.index+=1),e}var c="controls",d=c+"--fullscreen",h=c+"--with-credits",p=c+"--no-languages",f=c+"--hover",m=c+"--playing",g=c+"--paused",_=c+"--postrolling",v=c+"--unskipable",b=c+"__detail",y={maxi:a,mini:o};return e.widget("ted.controls",e.ted.hover,{options:{hover:!0,hoverStopDelay:3e3,player:null,postrollDuration:null,template:"maxi"},_create:function(){var s=this,a=this.options.template;a=this.options.template=y[a]||a;var o=e(a({options:this.options})).filter("div."+c);this.element.addClass(o.attr("class")).html(o.html());var r={};t.forOwn(this._buttonHandlers,function(e,t){r["click a."+c+"__"+t]=l(e,s)}),this._on(r);var u=this.element.find("span.controls__time--elapsed"),d=this.element.find("span.controls__time--duration");s.scrubber=this.element.find("div.controls__scrubber").scrubber({player:this.options.player,progress:function(e,t){s.scrubber&&!s.scrubber.scrubber("isSeeking")&&u.text(n(t.playhead)),d.text(n(t.duration))},slide:function(e,t){s.scrubber&&s.scrubber.scrubber("isSeeking")&&u.text(n(t.cursor))
}}),this.volume=this.element.find("a.controls__volume").volume({player:this.options.player}),this._initSubtitles(),this.credits=this.element.find("div.controls__meta__credits"),this.credits.length&&this.credits.subtitleCredits({player:this.options.player}),this.playerOptions=this.element.find("a.controls__options").playerOptions({player:this.options.player}),this.details=this.element.find("div."+b),this._on(this.credits,{subtitlecreditsshow:function(){s.element.addClass(h)},subtitlecreditshide:function(){s.element.removeClass(h)}}),this.options.player.on("playerplay",t.bind(this._onPlay,this)),this.options.player.on("playerpause",t.bind(this._onPause,this)),this.options.player.on("playercomplete",t.bind(this._onPause,this)),this.options.player.on("playertalk",t.bind(this._onTalk,this)),this.options.player.on("playerenterfullscreen",t.bind(this._onEnterFullScreen,this)),this.options.player.on("playerexitfullscreen",t.bind(this._onExitFullScreen,this)),this.options.player.on("playerpostrollduration",t.bind(this._onTakeoverPostrollDuration,this)),this.options.player.on("playerpostrollremaining",t.bind(this._onPostrollRemaining,this)),this.options.player.on("playerpostrollcomplete",t.bind(this._onTakeoverPostrollComplete,this)),this._onTalk(),this.options.player.player("canFullScreen")&&this.element.addClass(c+"--can-fullscreen"),this.options.player.player("canPlaybackRate")&&this.element.addClass(c+"--can-options"),this.options.player.player("canSubtitle")&&this.element.addClass(c+"--can-subtitle"),i()||this.element.addClass(c+"--can-volume"),this.options.player.on("touchstart",function(e){s._hoverMove(e)}),this.options.hover&&this._hoverInit()},_buttonHandlers:{play:function(){this.options.player.player("play")},pause:function(){this.options.player.player("pause")},fullscreen:function(){this.options.player.player("toggleFullScreen")},skip:function(){this.options.player.player("playNext")}},_hoverStart:function(){this.element.addClass(f)},_hoverStop:function(){this.element.removeClass(f)},_onEnterFullScreen:function(){this.element.addClass(d)},_onExitFullScreen:function(){this.element.removeClass(d)},_onPlay:function(){this.element.addClass(m).removeClass(g)},_onPause:function(){this.element.addClass(g).removeClass(m)},_onTalk:function(){var e=this.options.player.player("talk"),n=this.options.player.player("talks").length,i=e.index>=n-1;this.element[e.languages.length?"removeClass":"addClass"](p),this.details.length&&this.details.html(r(t.extend(u(e),{isPlaylist:n>1,talksCount:n}))),this.element[i?"addClass":"removeClass"](v)},_onTakeoverPostrollDuration:function(e,t){this.options.postrollDuration=t.postrollDuration,this.element.addClass(_)},_onTakeoverPostrollComplete:function(){this.$postrollProgress.width("100%"),this.element.removeClass(_)},_onPostrollRemaining:function(e,t){this.$postrollProgress||(this.$postrollProgress=this.element.find("div.controls__postbar__progress"),this.$postrollTime=this.element.find("span.controls__adtime__value")),this.$postrollProgress.width(100*(1-t.postrollRemaining/this.options.postrollDuration)+"%"),this.$postrollTime.text(n(t.postrollRemaining))},_initSubtitles:function(){var e=this.element.find("a.controls__subtitles"),t=this.options.player;if(e.length&&t.player("canSubtitle")){var n=new s;this.subtitles=n;var i;t.on({playersubtitle:function(e,t){i=t&&t.subtitle&&t.subtitle.languageCode?t.subtitle.languageCode:!1,n.state.set("selected",i)},playertalk:function(e,t){n.state.set("languages",t.languages)}});var a=t.player("subtitle");n.state.set("selected",a&&a.languageCode),n.state.set("languages",t.player("talk").languages),n.render(),n.state.on("change:selected",function(e,s){var a=String(i);s=String(s);var o=s!==a,r=!!s&&o;o&&(t.player("subtitle",s),n.close()),r&&t.player("play")}),e.on("click",function(e){e.preventDefault(),n.open()})}}}),function(t,n){return e(t).controls(n)}}),define("widgets/player/ga-tracker",["lodash","Modernizr","lib/ga"],function(e,t,n){"use strict";function i(e){this._data={currentPlayerTime:null,hasPlayed:!1,lastPlayedTalkId:null,lastChangedTalkId:null,lastLanguageCode:null,marks:null,markableProgress:[25,50,75,95],markableTimes:[],postRolling:!1},this._widget=e,this._resetMarks(),this._addHandlers()}return i.prototype._resetMarkableTimes=function(t){this._data.markableTimes=e.union([10,30,60,90],e.range(120,t+1,120))},i.prototype._resetMarks=function(){this._data.marks={times:{},progress:{},ads:{}}},i.prototype._incrementTalkViews=function(){var e=require("Cookies").get("__utma");if(e&&t.localstorage){var i=+e.split(".").pop(),s=window.localStorage,a="talkViews",o=(s.getItem(a)||"").split("|");2===o.length&&+o[0]===i?o[1]=+o[1]+1:o=[i,1],s.setItem(a,o.join("|")),n.set("metric1",o[1])}},i.prototype._onTalkChange=function(){this._data.postRolling=!1,this._resetMarks(),this._incrementTalkViews()},i.prototype._addHandlers=function(){var e=this,t={playererror:function(e,t){var i=t.error,s="abortive"===i.severity;(s||"fatal"===i.severity)&&n.sendEvent("player",s?"error.abort":"error.fatal",i.message)},playerenterfullscreen:function(){n.sendEvent("player","enterFullScreen")},playerexitfullscreen:function(){n.sendEvent("player","exitFullScreen")},playerplay:function(){var t=e._widget.options.currentTalk.id;n.sendEvent("player","start",e._data.hasPlayed?"subsequent":"initial"),e._data.hasPlayed=!0,e._data.lastPlayedTalkId!==t&&(n.sendEvent("player.talk","start",t),e._data.lastPlayedTalkId=t)},playerpause:function(){n.sendEvent("player","pause",Math.round(e._data.currentPlayerTime))},playerready:function(){var t=e._widget.mode();n.sendEvent("player","initialize",t,{nonInteraction:1})},playerrequestnext:function(){n.sendEvent("player","next",e._data.postRolling?"postroll":"talk")},playerrequestplay:function(){n.sendEvent("player","request",e._data.hasPlayed?"subsequent":"initial")},playerprogress:function(t,i){var s=100*i.progress,a=0,o=-1,r=e._data.markableProgress.length;if(!e._widget.player.postrolling)for(;e._data.marks&&++o<r&&s>a;)a=e._data.markableProgress[o],s>=a&&!e._data.marks.progress[a]&&(e._data.currentPlayerTime>e._widget.options.startTrackingAt&&n.sendEvent("player","progressPct",a+"%"),e._data.marks.progress[a]=!0)},playertalkcomplete:function(){e._data.marks&&!e._data.marks.progress[100]&&(n.sendEvent("player","progressPct","100%"),e._data.marks.progress[100]=!0,n.sendEvent("player.talk","complete",e._widget.options.currentTalk.id))},playercurrenttime:function(t,i){var s=i.currentTime,a=0,o=-1,r=e._data.markableTimes.length;if(e._data.currentPlayerTime=s,!e._widget.player.postrolling)for(;e._data.marks&&++o<r&&s>a;)a=e._data.markableTimes[o],s>=a&&!e._data.marks.times[a]&&(a>e._widget.options.startTrackingAt&&n.sendEvent("player","progressTime",a+" seconds"),e._data.marks.times[a]=!0)},playerprerollstart:function(){e._data.marks&&!e._data.marks.ads.prerollStart&&(n.sendEvent("player.preRoll","cardStart"),e._data.marks.ads.prerollStart=!0)},playerprerollblock:function(){e._data.marks&&!e._data.marks.ads.prerollBlock&&(n.sendEvent("player.preRoll","cardBlock"),e._data.marks.ads.prerollBlock=!0)},playerpostrollstart:function(){e._data.postRolling=!0,e._data.marks&&!e._data.marks.ads.postrollStart&&(n.sendEvent("player.postRoll","adStart"),e._data.marks.ads.postrollStart=!0)},playerpostrollcomplete:function(){e._data.postRolling=!1,e._data.marks&&!e._data.marks.ads.postrollComplete&&(n.sendEvent("player.postRoll","adComplete"),e._data.marks.ads.postrollStart=!0)},playeradblock:function(){n.sendEvent("player","adBlock")},playerduration:function(t,n){e._widget.player.postrolling||e._resetMarkableTimes(n.duration)},playersubtitle:function(t,i){var s=String(i.subtitle&&i.subtitle.languageCode);s!==e._data.lastLanguageCode&&(s?n.sendEvent("player.subtitle","setLanguage",s):n.sendEvent("player.subtitle","disable")),e._data.lastLanguageCode=s},playertalk:function(t,n){var i=n.id;e._data.lastChangedTalkId!==i&&(e._onTalkChange(),e._data.lastChangedTalkId=i)}};this._handlers=t,this._widget._on(t)},i}),define("widgets/player/ted-tracker",["jquery","lodash","lib/currentUserId","utils/ted"],function(e,t,n,i){"use strict";function s(e){var t=i("zone")||{};this._data={lastMetaTalkId:null,lastPlayTalkId:null,vmAPIKey:t.api_key||"unknown"},this._widget=e,this._addHandlers()}return s.prototype._sendVM=function(n){var i=t.extend({},n,{share_token:this._widget.options.shareToken});e.post("/talks/"+this._widget.talk().id+"/views",{view:i},null,"json")},s.prototype._recordViewID=function(){this._widget.options.recordInIdentity&&n.get()&&e.post("/talks/"+this._widget.talk().id+"/user_views",{},null,"json")},s.prototype._recordViewVM=function(){var e=this._widget.mode();if("hls"===e&&this._sendVM({apikey:this._data.vmAPIKey,format:"hls",quality:"variant",service:"ted_player_html5_hls"}),"flash"===e&&this._sendVM({apikey:this._data.vmAPIKey,format:"hls",quality:"variant",service:"ted_player_flash_hls"}),"h264"===e){var t=this._widget.options.currentTalk.resources.h264[0].bitrate;this._sendVM({apikey:this._data.vmAPIKey,format:"mp4",quality:t?t+"k":"variant",service:"ted_player_html5_mp4"})}},s.prototype._onTalkPlay=function(){this._recordViewID(),this._recordViewVM()},s.prototype._addHandlers=function(){var e=this,t={playerrequestplay:function(){e._widget._ytPlayer&&e._widget._ytPlayer.playVideo&&e._sendVM({apikey:"botw",service:"botw"})},playerplay:function(){var t=e._widget.options.currentTalk.id;e._data.lastPlayTalkId!==t&&(e._onTalkPlay(),e._data.lastPlayTalkId=t)}};this._handlers=t,this._widget._on(t)},s});var ns_=window.ns_=window.ns_||{};ns_.StreamSense=ns_.StreamSense||function(){function e(e,t){var i=e||"",s="undefined",a=c.comScore||c.sitestat||function(e){var t,i,a,o,r,u="comScore=",h=d.cookie,p="",f="indexOf",m="substring",_="length",v=n.browserAcceptsLargeURLs()?g.URL_LENGTH_LIMIT:g.RESTRICTED_URL_LENGTH_LIMIT,b="&ns_",y="&",w=c.encodeURIComponent||escape;if(h[f](u)+1)for(o=0,a=h.split(";"),r=a[_];r>o;o++)i=a[o][f](u),i+1&&(p=y+unescape(a[o][m](i+u[_])));e+=b+"_t="+ +new Date+b+"c="+(d.characterSet||d.defaultCharset||"")+p,e.length>v&&e.indexOf(y)>0&&(t=e.substr(0,v-8).lastIndexOf(y),e=(e.substring(0,t)+b+"cut="+w(e.substring(t+1))).substr(0,v)),l.httpGet(e),typeof ns_p===s&&(ns_p={src:e}),ns_p.lastMeasurement=e};if(typeof t!==s){var o=[],r=c.encodeURIComponent||escape;for(var u in t)t.hasOwnProperty(u)&&o.push(r(u)+"="+r(t[u]));/[\?\&]$/.test(i)||(i+="&"),i+=o.join("&")}return a(i)}function t(e,t){for(var i,s=c.encodeURIComponent||escape,a=[],o=g.LABELS_ORDER,r=e.split("?"),l=r[0],u=r[1],h=u.split("&"),p=0,f=h.length;f>p;p++){var m=h[p].split("="),_=unescape(m[0]),v=unescape(m[1]);_&&(t[_]=v)}for(var b={},p=0,f=o.length;f>p;p++){var y=o[p];if(t.hasOwnProperty(y)){var w=t[y];"undefined"!=typeof w&&null!=w&&(b[y]=!0,a.push(s(y)+"="+s(t[y])))}}for(var y in t)if(!b[y]&&t.hasOwnProperty(y)){var w=t[y];"undefined"!=typeof w&&null!=w&&a.push(s(y)+"="+s(t[y]))}i=l+"?"+a.join("&"),i=i+(i.indexOf("&c8=")<0?"&c8="+s(d.title):"")+(i.indexOf("&c7=")<0?"&c7="+s(d.URL):"")+(i.indexOf("&c9=")<0?"&c9="+s(d.referrer):"");var k=n.browserAcceptsLargeURLs()?g.URL_LENGTH_LIMIT:g.RESTRICTED_URL_LENGTH_LIMIT;if(i.length>k&&i.indexOf("&")>0){var x=i.substr(0,k-8).lastIndexOf("&");i=(i.substring(0,x)+"&ns_cut="+s(i.substring(x+1))).substr(0,k)}return i}var n=function(){var e={uid:function(){var e=1;return function(){return+new Date+"_"+e++}}(),filter:function(e,t){var n={};for(var i in t)t.hasOwnProperty(i)&&e(t[i])&&(n[i]=t[i]);return n},extend:function(e){var t,n=arguments.length;e=e||{};for(var i=1;n>i;i++)if(t=arguments[i])for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e},getString:function(e,t){var n=String(e);return null==e?t||"na":n},getLong:function(e,t){var n=Number(e);return null==e||isNaN(n)?t||0:n},getInteger:function(e,t){var n=Number(e);return null==e||isNaN(n)?t||0:n},getBoolean:function(e,t){var n="true"==String(e).toLowerCase();return null==e?t||!1:n},isNotEmpty:function(e){return"undefined"!=typeof e&&null!=e&&"undefined"!=typeof e.length&&e.length>0},indexOf:function(t,n){var i=-1;return e.forEach(n,function(e,n){e==t&&(i=n)}),i},forEach:function(e,t,n){try{if("function"==typeof t)if(n="undefined"!=typeof n?n:null,"number"!=typeof e.length||"undefined"==typeof e[0]){var i="undefined"!=typeof e.__proto__;for(var s in e)(!i||i&&"undefined"==typeof e.__proto__[s])&&"function"!=typeof e[s]&&t.call(n,e[s],s)}else for(var s=0,a=e.length;a>s;s++)t.call(n,e[s],s)}catch(o){}},regionMatches:function(e,t,n,i,s){if(0>t||0>i||t+s>e.length||i+s>n.length)return!1;for(;--s>=0;){var a=e.charAt(t++),o=n.charAt(i++);if(a!=o)return!1}return!0},size:function(e){var t,n=0;for(var t in e)e.hasOwnProperty(t)&&n++;return n},log:function(e,t){if("undefined"!=typeof t&&t){var n=new Date,i=n.getHours()+":"+n.getMinutes()+":"+n.getSeconds();console.log(i,e)}},isTrue:function(e){return"undefined"==typeof e?!1:"string"==typeof e?(e=e.toLowerCase(),"true"===e||"1"===e||"on"===e):e?!0:!1},toString:function(t){if("undefined"==typeof t)return"undefined";if("string"==typeof t)return t;if("[object Array]"===Object.prototype.toString.call(t))return t.join(",");if(e.size(t)>0){var n="";for(var i in t)t.hasOwnProperty(i)&&(n+=i+":"+t[i]+";");return n}return t.toString()},exists:function(e){return"undefined"!=typeof e&&null!=e},firstGreaterThan0:function(){for(var e=0,t=arguments.length;t>e;e++){var n=arguments[e];if(n>0)return n}return 0},cloneObject:function(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},safeGet:function(t,n){return n=e.exists(n)?n:"",e.exists(t)?t:n},getBrowserName:function(){var e,t,n=navigator.userAgent,i=navigator.appName;return-1!=(t=n.indexOf("Opera"))||-1!=(t=n.indexOf("OPR/"))?i="Opera":-1!=(t=n.indexOf("Android"))?i="Android":-1!=(t=n.indexOf("Chrome"))?i="Chrome":-1!=(t=n.indexOf("Safari"))?i="Safari":-1!=(t=n.indexOf("Firefox"))?i="Firefox":-1!=(t=n.indexOf("IEMobile"))?i="Internet Explorer Mobile":"Microsoft Internet Explorer"==i||"Netscape"==i?i="Internet Explorer":(e=n.lastIndexOf(" ")+1)<(t=n.lastIndexOf("/"))&&(i=n.substring(e,t),i.toLowerCase()==i.toUpperCase()&&(i=navigator.appName)),i},getBrowserFullVersion:function(){var e,t,n,i,s,a=navigator.userAgent,o=navigator.appName,r=""+parseFloat(navigator.appVersion);return-1!=(n=a.indexOf("Opera"))?(r=a.substring(n+6),-1!=(n=a.indexOf("Version"))&&(r=a.substring(n+8))):-1!=(n=a.indexOf("OPR/"))?r=a.substring(n+4):-1!=(n=a.indexOf("Android"))?r=a.substring(n+11):-1!=(n=a.indexOf("Chrome"))?r=a.substring(n+7):-1!=(n=a.indexOf("Safari"))?(r=a.substring(n+7),-1!=(n=a.indexOf("Version"))&&(r=a.substring(n+8))):-1!=(n=a.indexOf("Firefox"))?r=a.substring(n+8):"Microsoft Internet Explorer"==o?(s=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=s.exec(a)&&(r=parseFloat(RegExp.$1))):"Netscape"==o?(s=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!=s.exec(a)&&(r=parseFloat(RegExp.$1))):(t=a.lastIndexOf(" ")+1)<(n=a.lastIndexOf("/"))&&(r=a.substring(n+1)),r=r.toString(),-1!=(i=r.indexOf(";"))&&(r=r.substring(0,i)),-1!=(i=r.indexOf(" "))&&(r=r.substring(0,i)),-1!=(i=r.indexOf(")"))&&(r=r.substring(0,i)),e=parseInt(""+r,10),isNaN(e)&&(r=""+parseFloat(navigator.appVersion)),r},browserAcceptsLargeURLs:function(){return null===window.ActiveXObject||!0}};return e}(),i=function(){var e="cs_",t=function(){var t="undefined"!=typeof localStorage?localStorage:{};n.extend(this,{get:function(n){return t[e+n]},set:function(n,i){t[e+n]=i},has:function(n){return e+n in t},remove:function(n){delete t[e+n]},clear:function(){for(var e in t)t.hasOwnProperty(e)&&delete t[e]}})};return t}(),s=function(e,t){var n=new Image;n.onload=function(){t&&t(200)},n.onerror=function(){t&&t()},n.src=e},a=function(e,t,n){n&&setTimeout(n,0)},o=function(){return{dir:function(){return null},append:function(){},write:function(){},deleteFile:function(){return!1},read:function(){return null}}}(),r=function(e,t){"undefined"!=typeof engine&&t&&setTimeout(t,0);var n=engine.createHttpClient(),i=n.createRequest("GET",e,null);i.start(),t&&setTimeout(t,0)},l=function(){var e={PLATFORM:"generic",httpGet:s,httpPost:a,Storage:i,IO:o,getCrossPublisherId:function(){return null},getAppName:function(){return Constants.UNKNOWN_VALUE},getAppVersion:function(){return Constants.UNKNOWN_VALUE},getVisitorId:function(){return this.getDeviceName()+ +new Date+~~(1e3*Math.random())},getVisitorIdSuffix:function(){return"72"},getDeviceName:function(){return""},getPlatformVersion:function(){return""},getPlatformName:function(){return"js"},getRuntimeName:function(){return""},getRuntimeVersion:function(){return""},getResolution:function(){return""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:function(){return!0},autoSelect:function(){},isCrossPublisherIdChanged:function(){return!1}};return e}(),u=function(){function e(){return"undefined"!=typeof engine&&"undefined"!=typeof engine.stats}function t(){return n.isNotEmpty(engine.stats.device.id)?engine.stats.device.id:n.isNotEmpty(engine.stats.network.mac)?engine.stats.network.mac:null}function s(){if(null==l){var e=t();null!=e?(l=e,u="31",c=e):(l=+new Date+~~(1e3*Math.random()),u="72",c=null)}}var l=null,u=null,c=null;return{PLATFORM:"trilithium",httpGet:r,httpPost:a,Storage:i,IO:o,getCrossPublisherId:function(){return s(),c},getAppName:function(){return n.isNotEmpty(engine.stats.application.name)?engine.stats.application.name:Constants.UNKNOWN_VALUE},getAppVersion:function(){return n.isNotEmpty(engine.stats.application.version)?engine.stats.application.version:Constants.UNKNOWN_VALUE},getVisitorId:function(){return s(),l},getVisitorIdSuffix:function(){return u},getDeviceName:function(){return n.safeGet(engine.stats.device.platform,"")},getPlatformVersion:function(){return n.safeGet(engine.stats.device.version,"")},getPlatformName:function(){return"js"},getRuntimeName:function(){return"trilithium"},getRuntimeVersion:function(){return""},getResolution:function(){return"undefined"!=typeof screen&&"undefined"!=typeof screen.height&&"undefined"!=typeof screen.width?screen.height+"x"+screen.width:""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:e}}();l.autoSelect=function(){u.isCompatible()&&n.extend(l,u)};var c,d,h="undefined"!=typeof window&&"undefined"!=typeof document;h?(c=window,d=document):(c={},d={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var n=n||{};n.filterMap=function(e,t){for(var i in e)-1==n.indexOf(i,t)&&delete e[i]},n.getKeys=function(e,t){var n,i=[];for(n in e)(!t||t.test(n))&&e.hasOwnProperty(n)&&(i[i.length]=n);return i};var p=function(){var e=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(t){return e[t]}}}(),f=function(){var e=[p.END,p.PLAY,p.PAUSE,p.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(t){return e[t]}}}(),m={ADPLAY:p.AD_PLAY,ADPAUSE:p.AD_PAUSE,ADEND:p.AD_END,ADCLICK:p.AD_CLICK},g={STREAMSENSE_VERSION:"4.1412.05",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",RESTRICTED_URL_LENGTH_LIMIT:2048,URL_LENGTH_LIMIT:4096,LABELS_ORDER:["c1","c2","ca2","cb2","cc2","cd2","ns_site","ca_ns_site","cb_ns_site","cc_ns_site","cd_ns_site","ns_vsite","ca_ns_vsite","cb_ns_vsite","cc_ns_vsite","cd_ns_vsite","ns_ap_an","ca_ns_ap_an","cb_ns_ap_an","cc_ns_ap_an","cd_ns_ap_an","ns_ap_pn","ns_ap_pv","c12","ca12","cb12","cc12","cd12","ns_ak","ns_ns_ap_hw","name","ns_ap_ni","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ca_ns_ap_ver","cb_ns_ap_ver","cc_ns_ap_ver","cd_ns_ap_ver","ns_ap_sv","ns_ap_cv","ns_type","ca_ns_type","cb_ns_type","cc_ns_type","cd_ns_type","ns_radio","ns_nc","ns_ap_ui","ca_ns_ap_ui","cb_ns_ap_ui","cc_ns_ap_ui","cd_ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ca_ns_st_mp","cb_ns_st_mp","cc_ns_st_mp","cd_ns_st_mp","ns_st_mv","ca_ns_st_mv","cb_ns_st_mv","cc_ns_st_mv","cd_ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_c12m","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_ar","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ca_ns_st_er","cb_ns_st_er","cc_ns_st_er","cd_ns_st_er","ns_st_pe","ns_st_ui","ca_ns_st_ui","cb_ns_st_ui","cc_ns_st_ui","cd_ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_ct","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","ns_ap_i1","ns_ap_i2","ns_ap_i3","ns_ap_i4","ns_ap_i5","ns_ap_i6","c3","ca3","cb3","cc3","cd3","c4","ca4","cb4","cc4","cd4","c5","ca5","cb5","cc5","cd5","c6","ca6","cb6","cc6","cd6","c10","c11","c13","c14","c15","c16","c7","c8","c9"]},_=function(){var e=function(){function e(e,t){var n=t[e];null!=n&&(i[e]=n)}var t,i,s=this,a=0,o=0,r=0,l=0,u=0,c=0;n.extend(this,{reset:function(e){null!=e&&e.length>0?n.filterMap(i,e):i={},i.hasOwnProperty("ns_st_cl")||(i.ns_st_cl="0"),i.hasOwnProperty("ns_st_pn")||(i.ns_st_pn="1"),i.hasOwnProperty("ns_st_tp")||(i.ns_st_tp="1"),s.setPauses(0),s.setStarts(0),s.setBufferingTime(0),s.setBufferingTimestamp(-1),s.setPlaybackTime(0),s.setPlaybackTimestamp(-1)},setLabels:function(e,t){null!=e&&n.extend(i,e),s.setRegisters(i,t)},getLabels:function(){return i},setLabel:function(e,t){var n={};n[e]=t,s.setLabels(n,null)},getLabel:function(e){return i[e]},getClipId:function(){return("undefined"==typeof t||null==t)&&s.setClipId("1"),t},setClipId:function(e){t=e},setRegisters:function(t,n){var i=t.ns_st_cn;null!=i&&(s.setClipId(i),delete t.ns_st_cn),i=t.ns_st_bt,null!=i&&(r=Number(i),delete t.ns_st_bt),e("ns_st_cl",t),e("ns_st_pn",t),e("ns_st_tp",t),e("ns_st_ub",t),e("ns_st_br",t),(n==f.PLAYING||null==n)&&(i=t.ns_st_sq,null!=i&&(o=Number(i),delete t.ns_st_sq)),n!=f.BUFFERING&&(i=t.ns_st_pt,null!=i&&(u=Number(i),delete t.ns_st_pt)),(n==f.PAUSED||n==f.IDLE||null==n)&&(i=t.ns_st_pc,null!=i&&(a=Number(i),delete t.ns_st_pc))},createLabels:function(e,t){var i=t||{};return i.ns_st_cn=s.getClipId(),i.ns_st_bt=String(s.getBufferingTime()),(e==p.PLAY||null==e)&&(i.ns_st_sq=String(o)),(e==p.PAUSE||e==p.END||e==p.KEEP_ALIVE||e==p.HEART_BEAT||null==e)&&(i.ns_st_pt=String(s.getPlaybackTime()),i.ns_st_pc=String(a)),n.extend(i,s.getLabels()),i},incrementPauses:function(){a++},incrementStarts:function(){o++},getBufferingTime:function(){var e=r;return l>=0&&(e+=+new Date-l),e},setBufferingTime:function(e){r=e},getPlaybackTime:function(){var e=u;return c>=0&&(e+=+new Date-c),e},setPlaybackTime:function(e){u=e},getPlaybackTimestamp:function(){return c},setPlaybackTimestamp:function(e){c=e},getBufferingTimestamp:function(){return l},setBufferingTimestamp:function(e){l=e},getPauses:function(){return a},setPauses:function(e){a=e},getStarts:function(){return o},setStarts:function(e){o=e}}),i={},s.reset()};return e}(),v=function(){var e=function(){var e,t,i=this,s=null,a=0,o=0,r=0,l=0,u=0,c=0,d=!1;n.extend(this,{reset:function(e){null!=e&&e.length>0?n.filterMap(t,e):t={},i.setPlaylistId(+new Date+"_"+c),i.setBufferingTime(0),i.setPlaybackTime(0),i.setPauses(0),i.setStarts(0),i.setRebufferCount(0),d=!1},setLabels:function(e,s){null!=e&&n.extend(t,e),i.setRegisters(t,s)},getLabels:function(){return t},setLabel:function(e,t){var n={};n[e]=t,i.setLabels(n,null)},getLabel:function(e){return t[e]},getClip:function(){return s},getPlaylistId:function(){return e},setPlaylistId:function(t){e=t},setRegisters:function(t,n){var i=t.ns_st_sp;null!=i&&(a=Number(i),delete t.ns_st_sp),i=t.ns_st_bc,null!=i&&(r=Number(i),delete t.ns_st_bc),i=t.ns_st_bp,null!=i&&(l=Number(i),delete t.ns_st_bp),i=t.ns_st_id,null!=i&&(e=i,delete t.ns_st_id),n!=f.BUFFERING&&(i=t.ns_st_pa,null!=i&&(u=Number(i),delete t.ns_st_pa)),(n==f.PAUSED||n==f.IDLE||null==n)&&(i=t.ns_st_pp,null!=i&&(o=Number(i),delete t.ns_st_pp))},createLabels:function(t,s){var l=s||{};return l.ns_st_bp=String(i.getBufferingTime()),l.ns_st_sp=String(a),l.ns_st_id=String(e),r>0&&(l.ns_st_bc=String(r)),(t==p.PAUSE||t==p.END||t==p.KEEP_ALIVE||t==p.HEART_BEAT||null==t)&&(l.ns_st_pa=String(i.getPlaybackTime()),l.ns_st_pp=String(o)),(t==p.PLAY||null==t)&&(i.didFirstPlayOccurred()||(l.ns_st_pb="1",i.setFirstPlayOccurred(!0))),n.extend(l,i.getLabels()),l},incrementStarts:function(){a++},incrementPauses:function(){o++,s.incrementPauses()},setPlaylistCounter:function(e){c=e},incrementPlaylistCounter:function(){c++},addPlaybackTime:function(e){if(s.getPlaybackTimestamp()>=0){var t=e-s.getPlaybackTimestamp();s.setPlaybackTimestamp(-1),s.setPlaybackTime(s.getPlaybackTime()+t),i.setPlaybackTime(i.getPlaybackTime()+t)}},addBufferingTime:function(e){if(s.getBufferingTimestamp()>=0){var t=e-s.getBufferingTimestamp();s.setBufferingTimestamp(-1),s.setBufferingTime(s.getBufferingTime()+t),i.setBufferingTime(i.getBufferingTime()+t)}},getBufferingTime:function(){var e=l;return s.getBufferingTimestamp()>=0&&(e+=+new Date-s.getBufferingTimestamp()),e},setBufferingTime:function(e){l=e},getPlaybackTime:function(){var e=u;return s.getPlaybackTimestamp()>=0&&(e+=+new Date-s.getPlaybackTimestamp()),e},setPlaybackTime:function(e){u=e},getStarts:function(){return a},setStarts:function(e){a=e},getPauses:function(){return o},setPauses:function(e){o=e},getRebufferCount:function(){return r},incrementRebufferCount:function(){r++},setRebufferCount:function(e){r=e},didFirstPlayOccurred:function(){return d},setFirstPlayOccurred:function(e){d=e}}),s=new _,t={},i.reset()};return e}(),b=function(){var i=function(i,s){function a(e){var t=0;if(null!=ht)for(var n=0;n<ht.length;n++){var i=ht[n],s=i.playingtime;if(!s||s>e){t=i.interval;break}}return t}function o(){d();var e=a(ut.getClip().getPlaybackTime());if(e>0){var t=mt>0?mt:e;Z=setTimeout(c,t)}mt=0}function r(){d();var e=a(ut.getClip().getPlaybackTime());mt=e-ut.getClip().getPlaybackTime()%e,null!=Z&&d()}function u(){mt=0,_t=0,gt=0}function c(){gt++;var e=U(p.HEART_BEAT,null);S(e),mt=0,o()}function d(){null!=Z&&(clearTimeout(Z),Z=null)}function h(){_(),K=setTimeout(m,pt)}function m(){var e=U(p.KEEP_ALIVE,null);S(e),lt++,h()}function _(){null!=K&&(clearTimeout(K),K=null)}function b(){w(),it.isPauseOnBufferingEnabled()&&A(f.PAUSED)&&(J=setTimeout(y,ft))}function y(){if(X==f.PLAYING){ut.incrementRebufferCount(),ut.incrementPauses();var e=U(p.PAUSE,null);S(e),lt++,X=f.PAUSED}}function w(){null!=J&&(clearTimeout(J),J=null)}function k(e){return e==f.PLAYING||e==f.PAUSED}function x(){B&&(clearTimeout(B),B=null)}function E(e){return e==p.PLAY?f.PLAYING:e==p.PAUSE?f.PAUSED:e==p.BUFFER?f.BUFFERING:e==p.END?f.IDLE:null}function T(e,t,i){if(x(),i)B=setTimeout(function(e,t){return function(){T(e,t)}}(e,t),i);else if(R(e)){var s=F(),a=ot,o=L(t),r=a>=0?o-a:0;P(F(),t),I(e,t),j(F()),N(e);for(var l=0,u=nt.length;u>l;l++)nt[l](s,e,t,r);C(t),ut.setRegisters(t,e),ut.getClip().setRegisters(t,e);var c=U(f.toEventType(e),t);n.extend(c,t),A(V)&&(S(c),X=V,lt++)}}function C(e){var t=e.ns_st_mp;null!=t&&(Q=t,delete e.ns_st_mp),t=e.ns_st_mv,null!=t&&(et=t,delete e.ns_st_mv),t=e.ns_st_ec,null!=t&&(lt=Number(t),delete e.ns_st_ec)}function S(e,n){void 0===n&&(n=!0),n&&M(e);var i=it.getPixelURL();if(G){if(!D()){var s=bt.am,a=bt.et,o=s.newApplicationMeasurement(G,a.HIDDEN,e,i);G.getQueue().offer(o)}}else i&&l.httpGet(t(i,e))}function D(){var e=G.getAppContext(),t=G.getSalt(),n=G.getPixelURL();return null==e||null==t||0==t.length||null==n||0==n.length}function M(e){tt=U(null),n.extend(tt,e)}function P(e,t){var i=L(t);if(e==f.PLAYING)ut.addPlaybackTime(i),r(),_();else if(e==f.BUFFERING)ut.addBufferingTime(i),w();else if(e==f.IDLE){var s=n.getKeys(ut.getClip().getLabels());ut.getClip().reset(s)}}function I(e,t){var n=L(t),i=O(t);rt=i,e==f.PLAYING?(o(),h(),ut.getClip().setPlaybackTimestamp(n),A(e)&&(ut.getClip().incrementStarts(),ut.getStarts()<1&&ut.setStarts(1))):e==f.PAUSED?A(e)&&ut.incrementPauses():e==f.BUFFERING?(ut.getClip().setBufferingTimestamp(n),dt&&b()):e==f.IDLE&&u()}function A(e){return e!=f.PAUSED&&e!=f.IDLE||X!=f.IDLE&&null!=X?e!=f.BUFFERING&&X!=e:!1}function O(e){var t=-1;return e.hasOwnProperty("ns_st_po")&&(t=n.getInteger(e.ns_st_po)),t}function L(e){var t=-1;return e.hasOwnProperty("ns_ts")&&(t=Number(e.ns_ts)),t}function R(e){return null!=e&&F()!=e}function N(e){V=e,ot=+new Date}function F(){return V}function j(e){Y=e}function U(){var e,t;1==arguments.length?(e=f.toEventType(V),t=arguments[0]):(e=arguments[0],t=arguments[1]);var i={};if("undefined"!=typeof document){var s=document;i.c7=s.URL,i.c8=s.title,i.c9=s.referrer}return null!=t&&n.extend(i,t),i.hasOwnProperty("ns_ts")||(i.ns_ts=String(+new Date)),null!=e&&!i.hasOwnProperty("ns_st_ev")&&(i.ns_st_ev=p.toString(e)),it.isPersistentLabelsShared()&&G&&n.extend(i,G.getLabels()),n.extend(i,it.getLabels()),z(e,i),ut.createLabels(e,i),ut.getClip().createLabels(e,i),i.hasOwnProperty("ns_st_mp")||(i.ns_st_mp=Q),i.hasOwnProperty("ns_st_mv")||(i.ns_st_mv=et),i.hasOwnProperty("ns_st_ub")||(i.ns_st_ub="0"),i.hasOwnProperty("ns_st_br")||(i.ns_st_br="0"),i.hasOwnProperty("ns_st_pn")||(i.ns_st_pn="1"),i.hasOwnProperty("ns_st_tp")||(i.ns_st_tp="1"),i.hasOwnProperty("ns_st_it")||(i.ns_st_it="c"),i.ns_st_sv=g.STREAMSENSE_VERSION,i.ns_type="hidden",i}function z(e,t){var i=t||{};if(i.ns_st_ec=String(lt),!i.hasOwnProperty("ns_st_po")){var s=rt,a=L(i);(e==p.PLAY||e==p.KEEP_ALIVE||e==p.HEART_BEAT||null==e&&V==f.PLAYING)&&(s+=a-ut.getClip().getPlaybackTimestamp()),i.ns_st_po=n.getInteger(s)}return e==p.HEART_BEAT&&(i.ns_st_hc=String(gt)),i}function q(e){var t=L(e);0>t&&(e.ns_ts=String(+new Date))}function $(e,t,n){t=t||{},t.ns_st_ad=1,e>=p.AD_PLAY&&e<=p.AD_CLICK&&it.notify(e,t,n)}function H(e,t){it.notify(p.CUSTOM,e,t)}var W,B,Y,V,G,J,K,Z,X,Q,et,tt,nt,it=this,st=500,at=null,ot=0,rt=0,lt=0,ut=null,ct=!0,dt=!0,ht=g.DEFAULT_HEARTBEAT_INTERVAL,pt=g.DEFAULT_KEEP_ALIVE_INTERVAL,ft=g.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,mt=0,gt=0,_t=0,vt=!1,bt={};l.autoSelect(),n.extend(this,{reset:function(e){ut.reset(e),ut.setPlaylistCounter(0),ut.setPlaylistId(+new Date+"_1"),ut.getClip().reset(e),null==e||e.isEmpty()?W={}:n.filterMap(W,e),lt=1,gt=0,r(),u(),_(),w(),x(),V=f.IDLE,Y=null,ot=-1,X=null,Q=g.DEFAULT_PLAYERNAME,et=g.STREAMSENSE_VERSION,tt=null},setPauseOnBufferingInterval:function(e){ft=e},getPauseOnBufferingInterval:function(){return ft},setKeepAliveInterval:function(e){pt=e},getKeepAliveInterval:function(){return pt},setHeartbeatIntervals:function(e){ht=e},notify:function(){var e,t,i,s;t=arguments[0],3==arguments.length?(i=arguments[1],s=arguments[2]):(i={},s=arguments[1]),e=E(t);var a=n.extend({},i);if(q(a),a.hasOwnProperty("ns_st_po")||(a.ns_st_po=n.getInteger(s).toString()),t==p.PLAY||t==p.PAUSE||t==p.BUFFER||t==p.END)it.isPausePlaySwitchDelayEnabled()&&k(V)&&k(e)&&(V!=f.PLAYING||e!=f.PAUSED||B)?T(e,a,st):T(e,a);else{var o=U(t,a);n.extend(o,a),S(o,!1),lt++}},getLabels:function(){return W},getState:function(){return V},setLabels:function(e){null!=e&&(null==W?W=e:n.extend(W,e))},getLabel:function(e){return W[e]},setLabel:function(e,t){null==t?delete W[e]:W[e]=t},setPixelURL:function(e){if(null==e||0==e.length)return null;var t=decodeURIComponent||unescape,n=e.indexOf("?");
if(n>=0){if(n<e.length-1){for(var i=e.substring(n+1).split("&"),s=0,a=i.length;a>s;s++){var o=i[s],r=o.split("=");2==r.length?it.setLabel(r[0],t(r[1])):1==r.length&&it.setLabel(g.PAGE_NAME_LABEL,t(r[0]))}e=e.substring(0,n+1)}}else e+="?";return at=e},getPixelURL:function(){return at?at:"undefined"!=typeof ns_p&&"string"==typeof ns_p.src?at=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):"string"==typeof ns_pixelUrl?at=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null},isPersistentLabelsShared:function(){return ct},setPersistentLabelsShared:function(e){ct=e},isPauseOnBufferingEnabled:function(){return dt},setPauseOnBufferingEnabled:function(e){dt=e},isPausePlaySwitchDelayEnabled:function(){return vt},setPausePlaySwitchDelayEnabled:function(e){vt=e},setPausePlaySwitchDelay:function(e){e&&e>0&&(st=e)},getPausePlaySwitchDelay:function(){return st},setClip:function(e,t){var n=!1;return V==f.IDLE&&(ut.getClip().reset(),ut.getClip().setLabels(e,null),t&&ut.incrementStarts(),n=!0),n},setPlaylist:function(e){var t=!1;return V==f.IDLE&&(ut.incrementPlaylistCounter(),ut.reset(),ut.getClip().reset(),ut.setLabels(e,null),t=!0),t},importState:function(e){reset();var t=n.extend({},e);ut.setRegisters(t,null),ut.getClip().setRegisters(t,null),C(t),lt++},exportState:function(){return tt},getVersion:function(){return g.STREAMSENSE_VERSION},addListener:function(e){nt.push(e)},removeListener:function(e){nt.splice(n.indexOf(e,nt),1)},getClip:function(){return ut.getClip()},getPlaylist:function(){return ut}}),n.extend(this,{adNotify:$,customNotify:H,viewNotify:function(t,n){t=t||it.getPixelURL(),t&&e(t,n)}}),ns_.comScore&&(bt=ns_.comScore.exports,G=bt.c()),W={},lt=1,V=f.IDLE,ut=new v,J=null,dt=!0,Z=null,gt=0,u(),K=null,B=null,vt=!1,X=null,rt=0,nt=[],it.reset(),i&&it.setLabels(i),s&&it.setPixelURL(s)};return function(e){function t(e,t){return k[E]||s(e,t)}function i(){E=-1;for(var e=0;x>=e;e++)if(k.hasOwnProperty(e)){E=e;break}return ns_.StreamSense.activeIndex=E,E}function s(e,t){return e=e||null,t=t||null,e&&"object"==typeof e&&(t=e,e=null),k[++x]=new ns_.StreamSense(t,e),i(),k[x]}function a(){var e=!1,t=E;if("number"==typeof arguments[0]&&isFinite(arguments[0]))t=arguments[0];else if(arguments[0]instanceof ns_.StreamSense)for(var n in k)if(k[n]===arguments[0]){t=n;break}return k.hasOwnProperty(t)&&(e=k[t],delete k[t],e.reset(),i()),e}function o(e){return e=e||{},t().setPlaylist(e),t().getPlaylist()}function r(e,n,i){return e=e||{},"number"==typeof n&&(e.ns_st_cn=n),t().setClip(e,i),t().getClip()}function l(e,n,i){return"undefined"==typeof e?!1:(i=i||null,n=n||{},t().notify(e,n,i))}function u(e){"undefined"!=typeof e&&t().setLabels(e)}function c(){return t().getLabels()}function d(e){"undefined"!=typeof e&&t().getPlaylist().setLabels(e)}function h(){return t().getPlaylist().getLabels()}function p(e){"undefined"!=typeof e&&t().getClip().setLabels(e)}function f(){return t().getClip().getLabels()}function m(e){return t().reset(e||{})}function g(e){return t().getPlaylist().reset(e||{})}function _(e){return t().getClip().reset(e||{})}function v(e){return e=e||{},t().viewNotify(null,e)}function b(e,n){return arguments.length>2&&(e=arguments[1],n=arguments[2]),e=e||{},"number"==typeof n&&(e.ns_st_po=n),t().customNotify(e,n)}function y(){return t().exportState()}function w(e){t().importState(e)}var k={},x=-1,E=-1;n.extend(e,{activeIndex:E,newInstance:s,"new":s,destroyInstance:a,destroy:a,newPlaylist:o,newClip:r,notify:l,setLabels:u,getLabels:c,setPlaylistLabels:d,getPlaylistLabels:h,setClipLabels:p,getClipLabels:f,resetInstance:m,resetPlaylist:g,resetClip:_,viewEvent:v,customEvent:b,exportState:y,importState:w})}(i),i}();return b.AdEvents=m,b.PlayerEvents=p,ns_.StreamingTag=ns_.StreamingTag||function(){var e=function(){var e=function(e){function t(){if(!ns_.comScore&&n.exists(e))if(y=n.isTrue(e.debug),n.exists(e.customerC2)){var t=e.secure?"https://sb":"http"+("s"==document.location.href.charAt(4)?"s://sb":"://b");v.setPixelURL(t+".scorecardresearch.com/p?c1=2"),v.setLabel("c2",e.customerC2)}else v.setPixelURL(""),y&&console.log("Warning: customerC2 is not provided (or incorrect) in the StreamingTag configuration.");v.setLabel("ns_st_it","r")}function i(e){return n.exists(e)||(e={}),n.exists(e.ns_st_ci)||(e.ns_st_ci="0"),n.exists(e.c3)||(e.c3="*null"),n.exists(e.c4)||(e.c4="*null"),n.exists(e.c6)||(e.c6="*null"),e}function s(e){return h>0&&e>=h?m+=e-h:m=0,m}function a(e){v.getState()!=f.IDLE&&v.getState()!=f.PAUSED?v.notify(p.END,s(e)):v.getState()==f.PAUSED&&v.notify(p.END,m)}function o(e){return r("ns_st_ci",g,e)&&r("c3",g,e)&&r("c4",g,e)&&r("c6",g,e)}function r(e,t,i){if(n.exists(e)&&n.exists(t)&&n.exists(i)){var s=t[e],a=i[e];return n.exists(s)&&n.exists(a)&&s===a}return!1}function l(e,t){a(e),d++;var i={ns_st_cn:d,ns_st_pn:"1",ns_st_tp:"0"};n.extend(i,t),v.setClip(i),g=t,h=e,m=0,v.notify(p.PLAY,m)}function u(e){var t=+new Date;a(t),d++,e=i(e);var s={ns_st_cn:d,ns_st_pn:"1",ns_st_tp:"1",ns_st_ad:"1"};n.extend(s,e),v.setClip(s),m=0,v.notify(p.PLAY,m),h=t,_=!1}function c(e,t){var n=+new Date;e=i(e),k==w.None&&(k=t),_&&k==t&&o(e)?(v.getClip().setLabels(e),v.getState()!=f.PLAYING&&(h=n,v.notify(p.PLAY,m))):l(n,e),_=!0,k=t}var d=0,h=0,m=0,g=null,_=!1,v=new b,y=!1,w={None:0,AudioContent:1,VideoContent:2},k=w.None;n.extend(this,{playAdvertisement:function(){y&&console&&console.warn("Calling deprecated function 'playAdvertisement'. Please call 'playVideoAdvertisement' or 'playAudioAdvertisement' functions instead.");var e={ns_st_ct:"va"};u(e)},playVideoAdvertisement:function(e){var t={ns_st_ct:"va"};e&&n.extend(t,e),u(t)},playAudioAdvertisement:function(e){var t={ns_st_ct:"aa"};e&&n.extend(t,e),u(t)},playContentPart:function(e){y&&console&&console.warn("Calling deprecated function 'playContentPart'. Please call 'playVideoContentPart' or 'playAudioContentPart' functions instead.");var t={ns_st_ct:"vc"};e&&n.extend(t,e),c(t,w.VideoContent)},playVideoContentPart:function(e){var t={ns_st_ct:"vc"};e&&n.extend(t,e),c(t,w.VideoContent)},playAudioContentPart:function(e){var t={ns_st_ct:"ac"};e&&n.extend(t,e),c(t,w.AudioContent)},stop:function(){var e=+new Date;v.notify(p.PAUSE,s(e))}}),t()};return function(){}(e),e}();return e}(),b}(),define("vendor/stream_sense",[],function(){"use strict";return window.ns_}),define("lib/videoMetrix",["lodash","utils/ted","vendor/stream_sense","exports"],function(e,t,n,i){"use strict";i.init=function(e){this._init(),this._setContext(e)},i.start=function(){this._play()},i.stop=function(){this._tag&&this._tag.stop()},i.startAd=function(){this._asset.isInAd=!0,this._play()},i.stopAd=function(){this._asset.isInAd=!1,this._play()},i._meta=null,i._asset=null,i._tag=null,i._init=e.once(function(){i._tag=new n.StreamingTag({customerC2:t("csClientId")})}),i._setContext=function(e){var t={};e.talkId&&(t.ns_st_ci=e.talkId),this._meta=t,this._asset={isInAd:!1,isVideo:!0}},i._reset=function(){i._meta=null,i._asset=null,i._tag=null},i._play=function(){this._tag&&(this._asset.isInAd?this._asset.isVideo?this._tag.playVideoAdvertisement():this._tag.playAudioAdvertisement():this._asset.isVideo?this._tag.playVideoContentPart(this._meta):this._tag.playAudioContentPart(this._meta))}}),define("widgets/player/cs-tracker",["jquery","utils/ted","lib/videoMetrix"],function(e,t,n){"use strict";function i(t){t._isInternal&&(this._data={lastMetaTalkId:null,lastPlayTalkId:null},this._widget=t,this._addHandlers(),e(window).unload(function(){n.stop()}))}return i.prototype._sendViewBeacon=function(e){var n=window.COMSCORE;n&&n.beacon&&n.beacon({c1:"1",c2:t("csClientId"),c5:"02",c6:e})},i.prototype._sendPostrollBeacon=function(){var e=window.COMSCORE;e&&e.beacon&&e.beacon({c1:"1",c2:t("csClientId"),c5:"10"})},i.prototype._onTalkPlay=function(e){this._sendViewBeacon(e)},i.prototype._addHandlers=function(){var e=this,t={playertalk:function(e,t){n.init({talkId:t.id})},playerplay:function(){var t=e._widget.options.currentTalk.id;e._data.lastPlayTalkId!==t&&(e._onTalkPlay(t),e._data.lastPlayTalkId=t),n.start()},playerpause:function(){n.stop()},playercomplete:function(){n.stop()},playerprerollstart:function(){n.startAd()},playerprerollcomplete:function(){n.stopAd()},playerpostrollstart:function(){e._sendPostrollBeacon(),n.startAd()},playerpostrollcomplete:function(){n.stopAd()}};this._handlers=t,this._widget._on(t)},i}),define("utils/f",[],function(){"use strict";var e=function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return e[t].apply(e,n)}};return e.create=function(e){return function(){var t=arguments,n=function(){return e.apply(this,t)};return n.prototype=e.prototype,new n}},e.get=function(e){return function(t){return t.get&&"function"==typeof t.get?t.get(e):t[e]&&"function"==typeof t[e]?t[e].call(t):t[e]}},e.splat=function(){var t=Array.prototype.slice.call(arguments);return function(n){for(var i=[],s=0;s<t.length;s++)i.push(e.get(t[s]).call(n));return i}},e.send=function(e){var t=Array.prototype.slice.call(arguments,1);return function(n){return n[e].apply(n,t)}},e.and=function(){var e=Array.prototype.slice.call(arguments);return function(t){for(var n=!0,i=0;i<e.length;i++)n=n&&e[i].call(null,t);return n}},e.not=function(e){return function(){return!e.apply(null,arguments)}},e.ascending=function(e,t){return e-t},e.descending=function(e,t){return t-e},e.truthy=function(e){return!!e},e.falsey=e.not(e.truthy),e}),define("player/topicFactory",["jquery"],function(e){"use strict";function t(n,i,s){var a,o;for(a=0,o=i.length;o>a;a++)e.isArray(i[a])?t(n,i[a],s):i[a].apply(n,s)}return function(n){var i={};return function(s){var a,o=s&&i[s];if(!o){a=e.Callbacks(n&&n.hasOwnProperty(s)?n[s]:"memory"),o={publish:a.fire,subscribe:a.add,unsubscribe:a.remove,once:function(){function e(){t(a,n,arguments),a.remove(e)}var n=arguments;return a.add(e)},publishUnique:function(){var e;return window.JSON?function(){var t=Array.prototype.slice.call(arguments,0),n=JSON.stringify(t);n!==e&&(a.fire.apply(a,t),e=n)}:!1}()};var r=null;a.add(function(e){r=e}),o.read=function(){return r},s&&(i[s]=o)}return o}}}),define("player/getFlashVars",["jquery"],function(){"use strict";function e(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}return function(t){t.options;return e({serviceHost:"https://www.ted.com",volume:t.config.get("volume"),autoplay:0,fullscreenEnabled:t.canFullScreen?0:1})}}),define("player/handleError",["jquery"],function(e){"use strict";var t=window.console;return function(n){t&&t.log&&t.log("Player error:\n"+(n?n.stack||n.message||"unknown":"unknown")),e.post("//www.ted.com/error_collector.php",{message:n})}}),define("player/hlsVastParser",["jquery","./topicFactory","./handleError"],function(e,t,n){"use strict";function i(e){this.vast=e,this.topic=t({companion:void 0}),this.loadCompanions()}function s(e){this.vastData=e,this.url=this.vastData.find("IFrameResource").text()}e.extend(i.prototype,{loadCompanions:function(){var e=this;this.preroll=new s(this.vast.find("Companion[width=6][height=7]")),this.companion=new s(this.vast.find("Companion[width=6][height=8]")),this.companion.load(function(t){t&&e.topic("companion").publish(t)})},sponsor:function(){var e={},t=this.vast.find("AdParameters").text().split("=");return e[t[0]]=t[1],e},prerollUrl:function(){return[this.preroll.url]},impressionUrl:function(){return[this.vast.find("Impression").text()]},clickUrl:function(){return this.vast.find("ClickThrough").text()}});var a=["start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","rewind","pause","resume","fullscreen","creativeView"];return a.forEach&&a.forEach(function(t){i.prototype[t+"Url"]=function(){return e.makeArray(this.vast.find("Linear Tracking[event="+t+"]").map(function(t,n){return e(n).text()}))}}),e.extend(s.prototype,{load:function(t){var i=this;return""==this.url?t():void e.getJSON(this.url).done(function(e){i.ad=e.companion?{type:"companion-mobile",dimensions:{width:320,height:50},hasDisplay:!0,houseAd:!1,creative:[{density:1,url:e.companion.creative.standard},{density:2,url:e.companion.creative.standard_2x}],impression:null,thirdPartyImpressions:e.companion.impression,click:e.companion.click,lineItemId:null,creativeId:null}:e.ad,t(i.ad)}).fail(function(e,t){n({context:"hls",error:"Error retrieving companion ad",status:t,url:i.url})})}}),i}),define("player/hlsInitTalk",["jquery","./hlsVastParser","./handleError"],function(e,t,n){"use strict";function i(n){var i=new e.Deferred,s=i.promise();return n=n.replace("%5Bcorrelator%5D",Math.random().toFixed(12).substr(2)),e.ajax({url:n,timeout:2e3}).then(function(n){i.resolve(new t(e(n)))},function(e,t,n){i.reject(t,n)}),s}return function(t,s){var a,o,r=new e.Deferred,l=r.promise(),u={};try{o=t.currentTalk.resources.hls.stream,a=t.currentTalk.resources.hls.adUrl}catch(c){return t.throwError({type:"init",message:"Missing HLS stream resource.",severity:"fatal"}),r.reject(),l}return i(a).done(function(n){t.vastAd=n,e.extend(u,n.sponsor())}).fail(function(e){n({context:"hls",error:"Error retrieving VAST ad",status:e,url:t.currentTalk.resources.hls.adUrl})}).always(function(){s.attr("src",o+(-1===o.indexOf("?")?"?":"&")+e.param(u)),r.resolve()}),l}}),define("player/replaceElement",["jquery","./getFlashVars","./hlsVastParser","./hlsInitTalk","swfobject"],function(e,t,n,i){"use strict";function s(e){return e.id||(e.id="ted-player-"+l++),e.id}function a(e){var n={bgcolor:"#000000",quality:"high",wmode:"opaque",allowscriptaccess:"always",allowfullscreen:"true"},i=e.options,a=s(i.el);if("OBJECT"!==i.el.nodeName){var o=t(e),r=i.attrs;n.flashvars=o,r.data=i.swf,swfobject.createSWF(r,n,a)}e.el=document.getElementById(a),e.topic("ready.dom").publish()}function o(t){var n,i=t.options,a=e("<video>"),o=s(i.el);t.currentTalk=i.talks[0],n=t.currentTalk.resources.h264[0].file,a.attr(i.attrs),t.options.shareToken&&(n=n+"&share_token="+t.options.shareToken),a.attr("preload","none"),a.attr("src",n),a.attr("id",o),e(i.el).replaceWith(a),t.el=a[0],t.topic("ready.dom").publish()}function r(t){var n=t.options,a=e("<video>"),o=s(n.el);t.currentTalk=n.talks[0],a.attr(n.attrs),a.attr("id",o),i(t,a).always(function(){e(n.el).replaceWith(a),t.el=a[0],t.topic("ready.dom").publish()})}var l=Math.floor(9999*Math.random()),u={flash:a,h264:o,hls:r};return function(e){return u[e.mode]?u[e.mode](e):void e.throwError({type:"init",message:"Cannot replace element for unrecognized player mode: "+e.mode,severity:"fatal"})}}),define("player/getSupportedMode",["jquery","swfobject"],function(e){"use strict";function t(e){return n.canPlayType(e).replace(/^no$/,"")}var n=document.createElement("video"),i=["flash","h264","hls"];return function(s){var a=navigator.userAgent.toLowerCase(),o=a.indexOf("windows nt")>-1&&a.indexOf("; arm;")>-1;if(s.mode&&-1!==e.inArray(s.mode,i))return s.mode;if(!o&&-1===a.indexOf("android")&&swfobject.hasFlashPlayerVersion(s.flashVersion))return"flash";try{if(!n.canPlayType)return!1;if(-1===a.indexOf("android")&&-1===a.indexOf("googletv")&&(t("application/vnd.apple.mpegURL")||t("application/x-mpegURL")))return"hls";if(t('video/mp4; codecs="avc1.42E01E"'))return"h264"}catch(r){}return!1}}),define("player/checkRequiredParams",[],function(){"use strict";var e=["el","talks"];return function(t,n){for(var i=!0,s=e.length;s--;)t[e[s]]||(n({type:"init",message:"Required option property is missing: "+e[s],severity:"fatal"}),i=!1);return i}}),define("player/throttle",["jquery"],function(e){"use strict";return function(t,n,i,s){var a,o=0;"boolean"!=typeof n&&(s=i,i=n,n=void 0);var r=function(){function e(){o=+new Date,i.apply(l,c)}function r(){a=void 0}var l=this,u=+new Date-o,c=arguments;s&&!a&&e(),a&&clearTimeout(a),void 0===s&&u>t?e():n!==!0&&(a=setTimeout(s?r:e,void 0===s?t-u:t))};return e.guid&&(r.guid=i.guid=i.guid||e.guid++),r}}),define("player/flashifySource",[],function(){"use strict";return function(e){return e+(-1===e.indexOf("?")?"?":"&")+"preroll=Blank&qr&network=tv"}}),define("player/getTalk",[],function(){"use strict";return function(e,t,n){var i,s=e.options.talks,a=s.length;for(n||(n=0);a--;)if(i=s[a],i.id==t)return s[a+n]}}),define("player/getLanguage",[],function(){"use strict";return function(e,t){if(!e.languages||!t)return!1;for(var n=e.languages.length;n--;)if(e.languages[n].languageCode===t)return e.languages[n];return!1}}),define("player/addHandlersFlash",["jquery","./flashifySource","./throttle","./getTalk","./getLanguage"],function(e,t,n,i,s){"use strict";var a=n(100,function(e,t){e("currentTime").publishUnique(t)}),o=n(100,function(e,t){e("postrollRemaining").publishUnique(t)});return function(n){function r(t,r){switch(t){case"player.error":n.throwError(e.extend({},r,{type:"flash"}));break;case"player.pause":h=!1,l("pause").publish();break;case"player.seeked":n._isFirstPlaying||l("seeked").publish();break;case"player.seeking":n._isFirstPlaying||(l("seeking").publish(),h&&(p=!0));break;case"player.play":n._isFirstPlaying=!1,l("ready.seekable").publish(),u&&(l("bufferPlayable").publish(),u=!1),h=!0,(n._isRequestedPlay||!p)&&l("play").publish(),p=!1,n._isRequestedPlay=!1;break;case"player.complete":h=!1,l("complete").publish(n.currentTalk);break;case"player.talk.complete":h=!1,l("talkComplete").publish(n.currentTalk);break;case"player.ready":l("ready.flashInterface").publish();break;case"player.loaded":l("ready.flashTalk").publish();var f=i(n,r.talkId),m=n.config.get("languageCode"),g=s(f,m);n.currentTalk=f,l("talk").publishUnique(f),g||!f.isSubtitleRequired&&f.nativeLanguage===n.options.nativeLanguage||(g=s(f,n.options.nativeLanguage)),g?(n.el.setLanguage(g.languageCode,g.isRtl),l("subtitle").publishUnique(g)):n.el.setLanguage(null,null),d&&n.el.playVideo(),d=!0;break;case"player.metadata":l("duration").publishUnique(r.duration);break;case"player.timeupdate":a(l,r.time);break;case"player.volumechange":var _=Math.round(1e3*+r.volume)/1e3;(_>0||!c)&&l("volume").publishUnique(_);break;case"player.ad.preroll.block":l("adBlock").publish(),l("prerollBlock").publish();break;case"player.ad.preroll.start":l("prerollStart").publish();break;case"player.ad.preroll.end":l("prerollComplete").publish();break;case"player.ad.postroll.start":l("postrollStart").publish();break;case"player.ad.postroll.end":l("postrollComplete").publish();break;case"player.ad.postroll.duration":l("postrollDuration").publish(r.duration);break;case"player.ad.postroll.remaining":o(l,r.time);break;case"player.buffer.empty":u||(u=!0,l("bufferUnplayable").publish());break;case"player.mouse.down":n.postrolling?l("postrollClick").publish():n.toggle();break;case"player.metrics":l("metricsData").publish(r);break;case"player.metrics.toggle":l("metricsToggle").publish()}}var l=n.topic,u=!1,c=n.config.get("muted");l("muted").subscribe(function(e){c=e}),l("ready.flashInterface").once(function(){var e=n.currentTalk||n.options.talks[0];n.currentTalk=e,n.el.load(e.id,t(e.resources.hls.stream),e.introDuration,e.adDuration,e.postAdDuration)}),l("ready.flashTalk").once(function(){l("ready.handlers").publish()});var d,h,p;window.onPlayerEvent=function(e,t){try{r(e,t)}catch(i){if(!i)return;n.throwError({message:i.message,stack:i.stack})}};var f=n.options.history,m=[];if(f&&f.length)for(var g=-1,_=f.length;++g<_;)window.onPlayerEvent.apply(m.slice.apply(f[g]))}}),define("player/isLastTalk",[],function(){"use strict";return function(e){return e.currentTalk.id===e.options.talks[e.options.talks.length-1].id}}),define("player/addHandlersH264",["jquery","./throttle","./isLastTalk"],function(e,t){"use strict";function n(e){var t=e.topic,n={};t("play").subscribe(function(){n={}}),t("talkComplete.unnormalized").subscribe(function(){var i=e.currentTalk||{};n.id&&i.id==n.id||t("talkComplete").publish(i),n=i})}return function(i){var s=i.topic,a=i.el,o=e(a);n(i),e.each(["play","pause","seeked","seeking"],function(e,t){o.on(t,function(){s(t).publish()})}),o.on("canplay",function(){var e;return function(){e&&a.play(),e=!0}}()),o.on("timeupdate",t(100,function(){s("currentTime").publishUnique(a.currentTime)})),o.on("durationchange",function(){s("duration").publishUnique(a.duration)}),o.on("ended",function(){s("talkComplete.unnormalized").publish(),s("complete").publish(i.currentTalk)}),o.on("volumechange",function(){s("volume").publishUnique(Math.round(1e3*+a.volume)/1e3),s("muted").publishUnique(a.muted)}),o.on("loadedmetadata",function(){s("ready.seekable").publish()})}}),define("player/addHandlersHls",["jquery","./handleError"],function(e,t){"use strict";function n(i){var a=i.el,o=i.topic;e(a).on("error",function(){t({context:"hls",error:"Error playing video",currentTime:a.currentTime,src:a.src,code:a.error?a.error.code:void 0})});var r;o("talk").subscribe(function(e){r!==e.id&&(s(i),r=e.id)}),o("currentTime").subscribe(n.checkAdEvents)}function i(e){var t=new Image;t.src=e}function s(s){function a(e){c.push(n.createAdEvent(e))}var o,r=s.topic,l=s.vastAd;n.adEvents=[];try{o=s.currentTalk.resources.hls.metadata}catch(u){return void s.throwError({type:"init",message:"Missing HLS metadata for current talk.",severity:"fatal"})}if(!l)return void s.throwError({type:"hls",message:"Error retrieving VAST ad on talk change."});l.topic("companion").subscribe(function(e){r("ad").publish(e)});var c=[];e.getJSON(o,l.sponsor()).then(function(e){var t=e.timing;a({startsAt:Math.floor(t.outro.end)-1,onFirstStart:function(){l.impressionUrl().forEach(i)}}),a({startsAt:8,endsAt:12,onFirstStart:function(){l.prerollUrl().forEach(i)},onEveryStart:function(){r("prerollStart").publish()},onEveryEnd:function(){r("prerollComplete").publish()}}),t.ad&&(a({startsAt:Math.floor(t.ad.start),endsAt:Math.floor(t.ad.end),onFirstStart:function(){l.startUrl().forEach(i),l.creativeViewUrl().forEach(i)},onEveryStart:function(){r("talkComplete.unnormalized").publish(),r("postrollStart").publish()},onEveryEnd:function(){r("postrollComplete").publish()}}),a({startsAt:Math.floor(t.ad.start+(t.ad.end-t.ad.start)/4),endsAt:Math.floor(t.ad.end),onFirstStart:function(){l.firstQuartileUrl().forEach(i)}}),a({startsAt:Math.floor(t.ad.start+(t.ad.end-t.ad.start)/2),endsAt:Math.floor(t.ad.end),onFirstStart:function(){l.midpointUrl().forEach(i)}}),a({startsAt:Math.floor(t.ad.start+3*(t.ad.end-t.ad.start)/4),endsAt:Math.floor(t.ad.end),onFirstStart:function(){l.thirdQuartileUrl().forEach(i)}}),a({startsAt:Math.floor(t.ad.end)-1,endsAt:Math.floor(t.ad.end),onFirstStart:function(){l.completeUrl().forEach(i)}})),n.adEvents=c}).fail(function(e,n){t({context:"hls",error:"Error retrieving HLS metadata",status:n,uri:o,query:l.sponsor()})})}function a(e){e.isCurrent||(e.onEveryStart(),e.hasEverStarted||(e.onFirstStart(),e.hasEverStarted=!0),e.isCurrent=!0)}function o(e){e.isCurrent&&(e.onEveryEnd(),e.hasEverEnded||(e.onFirstEnd(),e.hasEverEnded=!0),e.isCurrent=!1)}return n.adEvents=[],n.createAdEvent=function(t){return e.extend({startsAt:0,endsAt:-1,onFirstStart:e.noop,onFirstEnd:e.noop,onEveryStart:e.noop,onEveryEnd:e.noop},t,{isCurrent:!1,hasEverStarted:!1,hasEverEnded:!1})},n.checkAdEvents=function(e){for(var t,i=n.adEvents,s=i.length,r=0;s>r;r++)t=i[r],e>=t.startsAt&&(e<t.endsAt||-1===t.endsAt)?a(t):t.isCurrent&&o(t)},n}),define("player/addHandlers",["./throttle","./addHandlersFlash","./addHandlersH264","./addHandlersHls","./isLastTalk"],function(e,t,n,i,s){"use strict";function a(t){var n,i,s=e(100,function(){n&&i&&t("progress").publishUnique(n/i)});t("currentTime").subscribe(function(e){n=e,s()}),t("duration").subscribe(function(e){i=e,n=0,s()}),t("progress").publish(0)}return function(e){var o=e.mode,r=e.topic;switch(o){case"flash":t(e);break;case"h264":n(e);break;case"hls":n(e),i(e);break;default:return void e.throwError({type:"init",message:"No handlers found for unrecognized player mode: "+o,severity:"fatal"})}"flash"!==o&&r("ready.handlers").publish(),e.options.talks[0]&&r("duration").publish(e.options.talks[0].duration),r("duration").subscribe(function(t){e.currentTalk?e.currentTalk.duration=t:e.options.talks[0].duration=t}),r("complete").subscribe(function(){s(e)?r("ended").publish(e.currentTalk):e.playNext()}),a(r),r("postrollStart").subscribe(function(){e.postrolling=!0}),r("postrollComplete").subscribe(function(){e.postrolling=!1}),r("talk").subscribe(function(){e.postrolling=!1})}}),define("player/actionsFlash",["jquery","./flashifySource","./getTalk","./getLanguage"],function(e,t,n,i){"use strict";var s={};return e.each({pause:"pauseVideo",seek:"seek",sendAds:"sendAds",capQualityToStage:"capQualityToStage"},function(e,t){s[e]=function(){var e=this.el[t];e&&e.apply(this.el,[].slice.call(arguments))}}),s.play=function(){this._isRequestedPlay=!0,this.lastPlayedTalkId==(this.currentTalk&&this.currentTalk.id)?this.el.resumeVideo():(this._isFirstPlaying=!0,this.el.playVideo())},s.playTalk=function(e){var i=n(this,e);i&&this.currentTalk!=i?(this._isFirstPlaying=!0,this.currentTalk=i,this.el.load(i.id,t(i.resources.hls.stream),i.introDuration,i.adDuration,i.postAdDuration)):this.play()},s.mute=function(e){this.el.volume(e?0:this.config.get("volume"))},s.subtitle=function(e){var t=i(this.currentTalk,e);t?this.el.setLanguage(t.languageCode,t.isRtl):this.el.setLanguage(null,null),this.config.set("languageCode",t?t.languageCode:!1),this.topic("subtitle").publishUnique(t)},s.volume=function(e){this.el.volume(e)},s._playbackRate=function(){},s}),define("player/actionsH264",["jquery","./getTalk"],function(e,t){"use strict";var n={};return n.play=function(){this.topic("talk").publishUnique(this.currentTalk),this.el.play()},n.pause=function(){this.el.pause()},n.playTalk=function(e){var n=t(this,e);n&&(this.currentTalk=n,this.topic("talk").publishUnique(n),this.el.src=n.resources.h264[0].file)},n.mute=function(e){this.el.muted=e},n.seek=function(e){this.el.currentTime=e},n.volume=function(e){this.el.volume=e},n._playbackRate=function(e){this.el.playbackRate=e},n}),define("player/actionsHls",["jquery","./getTalk","./hlsInitTalk"],function(e,t,n){"use strict";var i={};return i.play=function(){this.topic("talk").publishUnique(this.currentTalk),this.el.play()},i.pause=function(){this.el.pause()},i.playTalk=function(i){var s=t(this,i),a=this.topic;s&&this.currentTalk!=s?(this.currentTalk=s,n(this,e(this.el)).always(function(){a("talk").publishUnique(s)})):this.play()},i.playNext=function(){var e=t(this,this.currentTalk.id,1);e&&this.playTalk(e.id)},i.playPrev=function(){var e=t(this,this.currentTalk.id,-1);e&&this.playTalk(e.id)},i.mute=function(e){this.el.muted=e},i.seek=function(e){this.el.currentTime=e},i.volume=function(e){this.el.volume=e},i._playbackRate=function(e){this.el.playbackRate=e},i}),define("player/getFullScreenActions",["jquery"],function(e){"use strict";function t(t){function n(){t.topic("enterFullScreen").publish(),t.isFullScreen=!0}function i(){t.topic("exitFullScreen").publish(),t.isFullScreen=!1}var s=document,o=t.fullScreenMode,r=a[o];"webkitVideo"===o?(e(t.el).on("webkitbeginfullscreen",n),e(t.el).on("webkitendfullscreen",i)):r&&e(s).on(r.change,function(){s[r.element]===t.fullScreenElement?n():!s[r.element]&&t.isFullScreen&&i()})}function n(e){function t(){n.webkitEnterFullscreen()}var n=e.el;n.readyState>=1?t(e):(n.addEventListener("loadedmetadata",t,!1),e.play())}function i(e){var t=e.fullScreenMode,n=window.document;"webkitVideo"===t?e.el.webkitExitFullscreen():a[t]&&n[a[t].cancel]()}function s(e){var t=e.fullScreenMode;"webkitVideo"===t?n(e):a[t]?e.fullScreenElement[a[t].request]():e.throwError({type:"client",message:"Full screen mode not supported",severity:"warning"})}var a={standard:{cancel:"cancelFullScreen",change:"fullscreenchange",enabled:"fullscreenEnabled",error:"fullscreenerror",element:"fullscreenElement",request:"requestFullScreen"},moz:{cancel:"mozCancelFullScreen",change:"mozfullscreenchange",enabled:"mozFullScreenEnabled",error:"mozfullscreenerror",element:"mozFullScreenElement",request:"mozRequestFullScreen"},ms:{cancel:"msExitFullscreen",change:"MSFullscreenChange",enabled:"msFullscreenEnabled",error:"MSFullscreenError",element:"msFullscreenElement",request:"msRequestFullscreen"},webkit:{cancel:"webkitCancelFullScreen",change:"webkitfullscreenchange",enabled:"webkitFullscreenEnabled",error:"webkitfullscreenerror",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen"}};return function(e){return t(e),{requestFullScreen:function(t){e.fullScreenElement||(e.fullScreenElement=t||e.el),s(e)},cancelFullScreen:function(){i(e)}}}}),define("player/addActions",["jquery","./actionsFlash","./actionsH264","./actionsHls","./getTalk","./getFullScreenActions"],function(e,t,n,i,s,a){"use strict";var o={flash:t,h264:n,hls:i};return function(e){function t(t){for(var n=-1,i=t.length;++n<i;)t[n].callback.apply(e,t[n].args)}function n(t){return function(){var n=[].slice.call(arguments);return u?t.apply(e,n):l.push({callback:t,args:n}),e}}var i=e.mode,r=o[i],l=[],u=!1;if(!r)return void e.throwError({type:"init",message:"No actions found for unrecognized player mode: "+i,severity:"fatal"});e.topic("ready").once(function(){u=!0,t(l)}),e.topic("play").subscribe(function(){e.lastPlayedTalkId=e.currentTalk&&e.currentTalk.id}),r.play=function(){var t=r.play,n=!1;return e.topic("ended").subscribe(function(){n=!0}),e.topic("play").subscribe(function(){n=!1}),function(){n&&r.seek(0),t.call(e)}}(),r.playNext=function(){var t=s(e,e.currentTalk.id,1);t&&e.playTalk(t.id)},r.playPrev=function(){var t=s(e,e.currentTalk.id,-1);t&&e.playTalk(t.id)},r.playbackRate=function(t){e.topic("playbackRate").publish(t)},r.volume=function(){var t=r.volume;return function(n){n=Math.round(1e3*+n)/1e3,0>n&&(n=0),n>1&&(n=1),t.call(e,n),e.topic("volume").publishUnique(n)}}(),r.mute=function(){var t=r.mute;return function(n){n=!!n,t.call(e,n),e.topic("muted").publishUnique(n)}}(),r.seek=function(){var t=r.seek,n=0;return e.topic("duration").subscribe(function(e){n=e}),function(i){i=+i,0>i&&(i=0),i>n&&(i=n),t.call(e,i)}}(),r.seek=function(){var t=r.seek,n=!1,i=!1;return e.topic("ready.seekable").once(function(){n!==!1&&t.call(e,n),i=!0}),function(s){i?t.call(e,s):n=s}}(),r.toggle=function(){e.paused?e.play():e.pause()};var c=a(e);r.requestFullScreen=c.requestFullScreen,r.cancelFullScreen=c.cancelFullScreen;for(var d in r)r.hasOwnProperty(d)&&(e[d]=n(r[d]))}}),define("player/addProperties",[],function(){"use strict";function e(){return i.requestFullScreen?!!n.fullscreenEnabled&&"standard":i.mozRequestFullScreen?!!n.mozFullScreenEnabled&&"moz":i.webkitRequestFullScreen?!!n.webkitFullscreenEnabled&&"webkit":i.webkitEnterFullscreen?"webkitVideo":i.msRequestFullscreen?!!n.msFullscreenEnabled&&"ms":!1}function t(){return i.playbackRate&&i.playbackRate===i.defaultPlaybackRate?!0:!1}var n=document,i=n.createElement("video");return function(n){n.fullScreenMode=e(),n.canFullScreen=n.fullScreenMode!==!1,n.mode=n.options.mode,n.talks=n.options.talks,n.canPlaybackRate="hls"===n.mode||"h264"===n.mode?t():!1,n.postrolling=!1,n.paused=!0,n.on("play",function(){n.paused=!1}).on("pause",function(){n.paused=!0})}}),define("player/addPlaybackRate",[],function(){"use strict";var e=1;return function(t){function n(){return t.config.get("playbackRate")}function i(){t._playbackRate(o?e:n())}function s(){o=!1,i()}function a(){o=!0,i()}var o=!1;t.on("ready",function(){t.playbackRate(n())}),t.on("play",i),t.on("prerollStart",a),t.on("postrollStart",a),t.on("prerollComplete",s),t.on("postrollComplete",s),t.on("playbackRate",function(e){t.config.set("playbackRate",e),i()})}}),define("player/addVolume",[],function(){"use strict";return function(e){var t=!1;e.on("ready",function(){e.volume(e.config.get("volume")),e.mute(e.config.get("muted"))}).on("muted",function(n){t=n,e.config.set("muted",n)}).on("volume",function(n){e.config.set("volume",n),n>0&&t&&e.mute(!1)})}}),define("player/augmentTalks",[],function(){"use strict";return function(e){if(!e||!e.length)return[];for(var t,n=e.length,i=n;i--;)t=e[i],t.index=i;return e}}),define("player/addInitPromise",["jquery"],function(e){"use strict";return function(t){var n=new e.Deferred;t.on("error",function(e){n.rejectWith(t,[e])
}),t.on("ready",function(){"pending"===n.state()&&n.resolveWith(t,[t])}),e.extend(t,n.promise())}}),define("player/addThrower",["jquery","./handleError"],function(e,t){"use strict";return function(n){var i=!0;n.one("play",function(){i=!1}),n.throwError=function(s){s=e.extend({type:"unknown",message:null,severity:"warning"},s||{}),i&&"fatal"===s.severity&&(s.severity="abortive"),t(e.extend({context:"ted_player_wrapper"},s)),n.topic("error").publish(s)}}}),define("player/Config",["jquery"],function(e){"use strict";function t(e){return!!(e&&e.getItem&&e.setItem&&window.JSON&&JSON.parse&&JSON.stringify)}function n(n,i){if(t(n)){var s=n.getItem(i);if("string"===e.type(s)&&(s=JSON.parse(s),"object"===e.type(s)))return s}return{}}function i(n,i,s){t(n)&&"object"===e.type(s)&&n.setItem(i,JSON.stringify(s))}function s(e){this._options=e,this._inited=!1}return e.extend(s.prototype,{_init:function(){this._inited||(this.internal=e.extend({},this._options.defaults,n(this._options.storageAdapter,this._options.storageProperty)),this._inited=!0)},get:function(e){return this._init(),this.internal[e]},set:function(e,t){this._init(),this.internal[e]=t,i(this._options.storageAdapter,this._options.storageProperty,this.internal)}}),s}),define("player/Player",["jquery","./topicFactory","./replaceElement","./getSupportedMode","./checkRequiredParams","./addHandlers","./addActions","./addProperties","./addPlaybackRate","./addVolume","./augmentTalks","./isLastTalk","./addInitPromise","./addThrower","./Config"],function(e,t,n,i,s,a,o,r,l,u,c,d,h,p,f){"use strict";function m(d){var m=this;this.topic=t({bufferPlayable:void 0,bufferUnplayable:void 0,play:void 0,pause:void 0,prerollStart:void 0,prerollBlock:void 0,postrollStart:void 0,postrollEnd:void 0,adBlock:void 0,seeked:void 0,seeking:void 0}),p(m);var g=!1;this.topic("error").subscribe(function(e){"abortive"===e.severity&&(g=!0)}),h(m),d=e.extend({},b,d),s(d,m.throwError),d.mode=i(d),d.mode||m.throwError({type:"client",message:"Client does not support any player mode.",severity:"fatal"}),d.talks=c(d.talks),d.talks.length||m.throwError({type:"init",message:"No talks sent to player.",severity:"fatal"}),this.options=d,this.config=new f(e.extend({defaults:{languageCode:!1,muted:!1,volume:d.defaultVolume,playbackRate:d.defaultPlaybackRate}},d)),r(this),o(m),u(m),l(m),g||(this.topic("ready.dom").once(function(){window.setTimeout(function(){a(m),m.topic("ready.handlers").once(function(){g||m.topic("ready").publish()})},10)}),n(this))}var g,_=function(){var e=document.createElement("video");return e&&e.defaultPlaybackRate?e.defaultPlaybackRate:1}();try{g=window.localStorage}catch(v){}var b={attrs:{},defaultPlaybackRate:_,defaultVolume:.5,el:null,flashVersion:"11.1.0",nativeLanguage:"en",storageAdapter:g,storageProperty:"playerconfig",swf:"assets/player.swf"};e.extend(m.prototype,{on:function(e,t){return this.topic(e).subscribe(t),this},one:function(e,t){return this.topic(e).once(t),this},isLastTalk:function(){return d(this)}});t();return m}),define("widgets/player",["jquery","lodash","widgets/player/ga-tracker","widgets/player/ted-tracker","widgets/player/cs-tracker","utils/f","utils/is_mobile","utils/query_param","utils/ted","player/Player","lib/pubSub","lib/focus-zone","Cookies","spinjs","jqueryui/widget","widgets/hover","lib/resize"],function(e,t,n,i,s,a,o,r,l,u,c,d,h,p){"use strict";function f(){return r("playerMode")||null}function m(e){e.preventDefault(),e.stopPropagation()}var g="player",_=g+"--playing",v=g+"--fullscreen",b=g+"--show-cursor",y=g+"__container",w=y+"__cursor-killer",k=y+"__focus",x=y+"__placeholder",E=y+"__video",T=e("<div></div>"),C=t.once(function(n,i){window.onYouTubeIframeAPIReady=t.bind(n,i),e.getScript("//www.youtube.com/iframe_api")});return e.widget("ted.player",e.ted.hover,{options:{breakpoint:!0,currentTalk:null,flashVars:{},metricsKey:null,mode:f(),nativeLanguage:"en",startTrackingAt:0,swf:l("playerPath"),talks:null,hideCursorDelay:1e3,soonThreshold:.1,recordInIdentity:!0},_isPlayerInitialized:!1,_isPlaying:!1,_addElements:function(){var e=this.element.find("div."+y);e.length||(e=T.clone().addClass(y).appendTo(this.element));var t=e.find("div."+x);t.length||(t=T.clone().addClass(x).appendTo(e)),t.wrap(T.clone().addClass(k));var n=t.closest("div."+k).addClass(E).attr({href:"#",role:"button",title:"Play/Pause"});this._on(n,{click:function(){this.toggle()}});var i=e.find("div."+w);i.length||(i=T.clone().addClass(w).appendTo(e)),this.elements={container:e,focal:n,placeholder:t,cursorKiller:i}},_breakpoint:function(e){this.options.breakpoint&&(1024>e?this.video.attr("controls","controls"):this.video.removeAttr("controls"))},_create:function(){this.options.currentTalk||(this.options.currentTalk=this.options.talks[0]),this._on({playerplay:function(){this._isPlaying=!0,this.element.addClass(_)},playerpause:function(){this._isPlaying=!1,this.element.removeClass(_)}}),this._isInternal=!this.talk().external,this.options.hoverStopDelay=this.options.hideCursorDelay,new n(this),new i(this),new s(this),this._initializePlayer()},_initializePlayer:function(){this._isPlayerInitialized||(this._isPlayerInitialized=!0,this.element.addClass(g),this._addElements(),this._isInternal?this._initializeInternalPlayer():"YouTube"===this.talk().external.service&&this._initializeYouTubePlayer(),this._hoverInit())},_initializeYouTubePlayer:function(){C(this._youTubeApiReady,this),this._on({playerrequestplay:function(){this._ytPlayer&&this._ytPlayer.playVideo&&this._ytPlayer.playVideo()}})},_youTubeApiReady:function(){var t=this,n=this.talk(),i="//www.youtube.com/embed/"+n.external.code+"?showinfo=0&enablejsapi=1&autoplay=0&origin="+location.origin;n.external.startTime&&(i+="&start="+n.external.startTime);var s=e("<iframe class="+E+" src="+i+" frameborder=0 allowfullscreen></iframe>");t.elements.placeholder.replaceWith(s),t._ytPlayer=new YT.Player(s.get(0),{events:{}}),t._trigger("domready")},_initializeInternalPlayer:function(){var n=r("dfptest");this.options.talks=this.options.talks.map(function(e){if(n){var t=encodeURIComponent(n);e.resources.hls.adUrl=e.resources.hls.adUrl.replace(/(cust_params=[^&]+)&/,"$1%26dfptest%3D"+t+"&")}var i=Number(e.introDuration);return e.introDuration=Math.min(i,11.82),e.adDuration=0===i?0:3.33,e.postAdDuration=0===i?0:.83,e}),this.player=new u({attrs:{"class":E},el:this.elements.placeholder.get(0),flashVars:this.options.flashVars,metricsKey:this.options.metricsKey,mode:this.options.mode,nativeLanguage:this.options.nativeLanguage,swf:this.options.swf,talks:this.options.talks}),this.element.addClass(g+"--"+this.mode()),o()&&this.element.addClass(g+"--is-mobile"),this._subscribeToPlayerEvents(),this._subscribeToKeyboardEvents(),this.player.one("ready.dom",t.bind(this._playerDomReady,this)),this.player.canFullScreen&&(this.player.on("enterFullScreen",t.bind(this._playerEnterFullScreen,this)),this.player.on("exitFullScreen",t.bind(this._playerExitFullScreen,this))),this.player.on("talk",t.bind(function(e){this.options.currentTalk=e,this._trigger("talk",null,e)},this)),this.player.on("bufferUnplayable",t.bind(this._bufferingStarted,this)),this.player.on("bufferPlayable",t.bind(this._bufferingStopped,this)),this._on({playercurrenttime:function(e,t){this._currentTime=t.currentTime},playerplaybackrate:function(e,t){this._playbackRate=t.playbackRate},playervolume:function(e,t){this._volume=t.volume},playerprogress:function(){var e;return function(t,n){!e&&n.progress>1-this.options.soonThreshold&&this.player.isLastTalk()&&(e=!0,this._trigger("soon"))}}(),playerpostrollcomplete:function(){this.player.isLastTalk()&&!this._queuedTalkId&&(this._queuedTalkId=this.options.currentTalk.id)},playerrequestplay:function(){var n=e("*:focus");n.closest(this.elements.focal).length||(this._oldFocus=n),this.elements.focal.attr("tabindex","1"),this._queuedTalkId?(e(this.player.el).attr("preload",""),this.player.playTalk(this._queuedTalkId),this._queuedTalkId=null,t.delay(a(this.player,"play"))):this.player.play()},playerplay:function(){this.elements.focal.focus()},playerrequestpause:function(){this.player.postrolling||this.player.pause()}})},_destroy:function(){this.options.breakpoint&&c("breakpoint").unsubscribe(this._breakpoint)},_playerDomReady:function(){var n=e(this.player.el);this.video=n,this.options.breakpoint&&c("breakpoint").subscribe(t.bind(this._breakpoint,this)),this._trigger("domready")},_playerEnterFullScreen:function(){this.element.addClass(v),this._fullscreenZone("activate")},_playerExitFullScreen:function(){this.element.removeClass(v),this._fullscreenZone("deactivate")},_subscribeToKeyboardEvents:function(){this._on(this.elements.focal,{keydown:this._keyDown,keyup:this._keyUp})},_subscribeToPlayerEvents:function(){var e,n=this;this._on({playerrequestplay:function(){e=!0},playerplay:function(){e=!1}}),t.forEach(["ad","currentTime","duration","ended","enterFullScreen","error","exitFullScreen","pause","play","progress","ready","seeked","seeking","volume","muted","idle","complete","talkComplete","prerollStart","prerollBlock","postrollStart","postrollComplete","postrollDuration","postrollRemaining","adBlock","bufferPlayable","bufferUnplayable","subtitle","playbackRate","metricsData","metricsToggle"],function(t){n.player.on(t,function(i){var s={};"play"!==t||e||n._trigger("requestplay"),s[t]=i,n._trigger(t,null,s),n["_"+t]=i})})},_hoverStart:function(e){this.element.addClass(b),this._trigger("hoverstart",e)},_hoverStop:function(e){this.element.removeClass(b),this._trigger("hoverstop",e)},_bufferingStarted:function(){this._spinner||(this._spinner=new p({lines:13,length:13,width:5,radius:16,color:"#FFF",trail:50,shadow:!0})),this._spinner.spin(this.element.get(0))},_bufferingStopped:function(){this._spinner.stop()},_keyDown:function(t){var n=e.ui.keyCode,i=t.ctrlKey||t.shiftKey||t.altKey,s=this,a=s.options.currentTalk&&s.options.currentTalk.duration||0,o=s._currentTime||0,r=s.volume()||0;switch(t.keyCode){case n.ENTER:case n.NUMPAD_ENTER:case n.SPACE:s.toggle(),m(t);break;case n.DOWN:i?s.mute(!0):s.volume(r-.1),m(t);break;case n.UP:i?s.mute(!1):s.volume(r+.1),m(t);break;case n.LEFT:s.seek(i?o-.1*a:o-15),m(t);break;case n.RIGHT:s.seek(i?o+.1*a:o+15),m(t);break;case n.HOME:s.seek(0),m(t);break;case n.END:s.seek(a-1),m(t);break;case n.TAB:var l=this._oldFocus;this._tabDown||!l||l.is(":hidden")||l.is(":disabled")||(l.focus(),m(t)),this._oldFocus=null,this._tabDown=!0}},_keyUp:function(t){t.keyCode===e.ui.keyCode.TAB&&(this._tabDown=!1)},_fullscreenZone:function(e){var t=this.player.fullScreenElement,n=this._fullscreenZoneObj;t&&(n||(n=new d(t),this._fullscreenZoneObj=n),n[e]())},mode:function(){return this._isInternal?this.player.options.mode:"external"},talk:function(e){return arguments.length&&(this.queue(e),this._trigger("requestplay")),this.options.currentTalk},talks:function(){return this.player.talks},toggle:function(){this[this._isPlaying?"pause":"play"]()},play:function(){this._trigger("requestplay")},playNext:function(){this._trigger("requestnext"),this.player.playNext()},playPrev:function(){this._trigger("requestprev"),this.player.playPrev()},pause:function(){this._trigger("requestpause")},_playbackRate:null,playbackRate:function(e){return arguments.length&&(this.player.playbackRate(e),this._playbackRate=e),this._playbackRate},queue:function(e){this._queuedTalkId=e},sendAds:function(e){this.player.sendAds(e)},seek:function(e,t){this.options.startTrackingAt=t?e:0,this.player.seek(e)},_subtitle:null,subtitle:function(e){if(arguments.length){var n=e?t.find(this.talk().languages,{languageCode:e}):!1;this.player.subtitle(e),this._subtitle=n}return this._subtitle},_volume:null,volume:function(e){return arguments.length&&this.player.volume(e),this._volume},_muted:null,mute:function(e){return arguments.length&&this.player.mute(e),this._muted},toggleFullScreen:function(){var t=e("html,body"),n=e(document).scrollTop(),i=e(this.element),s=i.offset().top;n>s&&t.scrollTop(s),this[this.player.isFullScreen?"cancelFullScreen":"requestFullScreen"](this.elements.container.get(0))},requestFullScreen:function(e){this.player.requestFullScreen(e)},cancelFullScreen:function(e){this.player.cancelFullScreen(e)},isControllable:function(){return this._isInternal},isFullScreen:function(){return this._isInternal?this.player.isFullScreen:!1},canFullScreen:function(){return this._isInternal?this.player.canFullScreen:!1},canPlaybackRate:function(){return this._isInternal?this.player.canPlaybackRate:!1},canSubtitle:function(){var e=String(this.player.mode);return this._isInternal&&"flash"===e},capQualityToStage:function(e){this.player.capQualityToStage(e)}}),function(t,n){return e(t).player(n)}}),define("hbs!templates/playerPip",["hbs","hbs/handlebars","templates/helpers/thumb"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div class="player-pip__controls">\n  <div class="player-pip__thumb">'+this.escapeExpression((t.thumb||e&&e.thumb||t.helperMissing).call(e,"",{name:"thumb",hash:{},data:i}))+'</div>\n\n  <a class="player-pip__controls__button player-pip__controls__play" href="#">\n    <i class="player-pip__controls__icon g-pip-play"></i>\n  </a>\n\n  <a class="player-pip__controls__button player-pip__controls__pause" href="#">\n    <i class="player-pip__controls__icon g-pip-pause"></i>\n  </a>\n</div>\n\n<div class="player-pip__details"></div>\n'},useData:!0});return t.registerPartial("templates/playerPip",n),n}),define("hbs!templates/playerPipDetails",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDate","templates/helpers/formatDuration"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="player-pip__meta">\n  <span class="player-pip__meta__event">'+this.escapeExpression((s=null!=(s=t.event||(null!=e?e.event:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"event",hash:{},data:i}):s))+"</span>\n  &middot;\n  "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Filmed",{name:"t",hash:{},data:i}))+'\n  <span class="player-pip__meta__value">'+this.escapeExpression((t.formatDate||e&&e.formatDate||t.helperMissing).call(e,"MMMM YYYY",null!=e?e.filmed:e,{name:"formatDate",hash:{forceUTC:!0},data:i}))+'</span>\n  &middot;\n  <span class="player-pip__meta__value">'+this.escapeExpression((t.formatDuration||e&&e.formatDuration||t.helperMissing).call(e,null!=e?e.duration:e,{name:"formatDuration",hash:{},data:i}))+'</span>\n</div>\n\n<a class="l3 player-pip__title player-pip__top-link" href="#">'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+"</a>\n"},useData:!0});return t.registerPartial("templates/playerPipDetails",n),n}),define("widgets/playerPip",["jquery","hbs!templates/playerPip","hbs!templates/playerPipDetails","waypoints","jqueryui/widget"],function(e,t,n){"use strict";var i="player-pip--playing",s="player-pip--paused",a="player-pip__container";return e.widget("ted.playerPip",{options:{player:null,waypoint:null},shouldBeOn:!1,_create:function(){var n=this,i=e("html,body"),s=e(t()),o=this.element.find("div."+a);o.length||(o=e("<div></div>").addClass(a).appendTo(this.element)),o.append(s),this.detailsElement=s.filter("div.player-pip__details"),this.options.player&&this._setPlayer(),n._on({"click a.player-pip__controls__play":function(e){e.preventDefault(),this._trigger("play")},"click a.player-pip__controls__pause":function(e){e.preventDefault(),this._trigger("pause")},"click a.player-pip__top-link":function(e){e.preventDefault(),i.animate({scrollTop:n.options.waypoint.offset().top},200)}}),n.options.waypoint.waypoint(function(e){n.shouldBeOn="down"===e,n.refreshState()},{offset:function(){return-n.options.waypoint.height()}})},_setPlayer:function(){function t(e){n.details({event:e.event,filmed:e.filmed,published:e.published,duration:e.duration,name:e.name,thumb:e.thumb})}var n=this,a=e(n.options.player);t(a.player("talk")),n._on({playerpipchangestate:function(e,t){a.player("capQualityToStage",!t.isOn)},playerpipplay:function(){a.player("play")},playerpippause:function(){a.player("pause")}}),a.on("playerrequestplay",function(){n.element.addClass(i)}).on("playerplay",function(){n.element.removeClass(s).addClass(i)}).on("playerpause",function(){n.element.addClass(s).removeClass(i)}).on("playerended",function(){n.element.removeClass(s).removeClass(i)}).on("playertalk",function(e,n){t(n)})},details:function(t){var i;arguments.length&&(e.isPlainObject(t)?(t=e.extend({eventName:"",filmed:new Date,duration:0,name:"",thumb:""},t),t.filmed*=1e3,t.thumb&&this.element.find("img.thumb__image").attr("src",t.thumb),i=n(t)):i=t,this.detailsElement.html(i))},refreshState:function(){var e=this.shouldBeOn;this.element[e?"addClass":"removeClass"]("player-pip--on"),this._trigger("changeState",null,{isOn:e})}}),function(t,n){return e(t).playerPip(n)}}),define("widgets/playerHero",["jquery","lodash","lib/pubSub","Modernizr","hbs!templates/playerHeroHiccup","widgets/controls","widgets/player","widgets/playerPip","lib/resize"],function(e,t,n,i,s){"use strict";return e.widget("ted.playerHero",{_hasPlayed:!1,options:{hiccups:!1,isSkip:!1,isTranscript:!1,metricsKey:null,nativeLanguage:"en",precontrol:!1,talks:[]},_create:function(){var e=this;e.playerElement=e.element.find("div.player"),e.maxiControlsElement=e.element.find("div.controls--maxi"),e.miniControlsElement=e.element.find("div.controls--mini"),e.pipElement=e.element.find("div.player-pip"),this._addPlayStates(),e._on(e.playerElement,{playererror:function(t,n){var i=n.error,s="client"===i.type?"isClient":!1;"abortive"===i.severity&&e._hiccup(s||"isInit"),"fatal"===i.severity&&e._hiccup(s||"isFatal")},playerrequestplay:function(){e._onFirstPlay()}}),e._on({"click a.player-hero__play":function(e){e.preventDefault(),this.play()}}),e._on(e.pipElement,{playerpipchangestate:function(t,n){e.element[n.isOn?"addClass":"removeClass"]("player-hero--pip-on")}}),e.playerElement.player({metricsKey:e.options.metricsKey,nativeLanguage:e.options.nativeLanguage,talks:e.options.talks})},_isMiniBreakpoint:!1,_isPlayerInitialized:!1,_isPlayerFullScreen:!1,_addPlayStates:function(){function t(){n.element.addClass(o).removeClass(u).removeClass(a).removeClass(r).removeClass(l)}var n=this,i=!1,s=n.playerElement,a="player-hero--idle",o="player-hero--playing",r="player-hero--paused",l="player-hero--unactivated",u="player-hero--ended",c="player-hero--early-request";n._on(s,{playerplay:t,playerrequestplay:t,playerpause:function(){n.element.removeClass(o).removeClass(a).removeClass(u),s.player("isControllable")?n.element.addClass(r).removeClass(l):n.element.addClass(l)},playerdomready:function(){window.playerHeroPlay&&(window.playerHeroPlay=e.noop),n.element.hasClass(c)&&(i=!0,n.play(),s.addClass("player--playing"),n.element.removeClass(c))},playerready:function(){i&&(n.play(),i=!1);var e=n.playerElement.player("mode");"flash"===e&&n.pipElement.playerPip({player:n.playerElement,waypoint:n.element.find("div.player-hero__banner")}),n.options.precontrol&&n._renderMaxiControls()},playeridle:function(){n.element.addClass(a)},playerended:function(){n.element.removeClass(a).addClass(u).removeClass(r).removeClass(l).addClass(o)},playerenterfullscreen:function(){n._isPlayerFullScreen=!0,n._refreshMiniControlsState(),n._isPlayerInitialized||n.play()},playerexitfullscreen:function(){n._isPlayerFullScreen=!1,n._refreshMiniControlsState()},playerhoverstart:function(){this.miniControlsElement.addClass("controls--visible")},playerhoverstop:function(){this.miniControlsElement.removeClass("controls--visible")}})},_refreshMiniControlsState:function(){var e=this._isPlayerFullScreen||this._isMiniBreakpoint;this.miniControlsElement[e?"addClass":"removeClass"]("controls--active")},_renderMaxiControls:function(){this._isMaxiControlsRendered||(this._isMaxiControlsRendered=!0,this.playerElement.player("isControllable")?this.maxiControlsElement.controls({isSkip:this.options.isSkip,isTranscript:this.options.isTranscript,player:this.playerElement,template:"maxi"}):this.element.addClass("player-hero--uncontrollable"))},_onFirstPlay:function(){var e=this;if(!e._isPlayerInitialized){e._isPlayerInitialized=!0,e._renderMaxiControls(),this.playerElement.player("isControllable")&&e.miniControlsElement.controls({player:e.playerElement,template:"mini"});var i=e.playerElement.player("mode"),s=e.options.hiccups;(s===i||s===!0||t.isArray(s)&&t.contains(s,i))&&e._hiccup("isHiccup"),"flash"===i&&n("breakpoint").subscribe(function(t){e._isMiniBreakpoint=1024>t,e._refreshMiniControlsState()})}},_hiccup:function(e){if(!this._hiccuped){this._hiccuped=!0;var t={};t[e]=!0,this.element.prepend(s(t))}},play:function(){this._hasPlayed=!0,TED.playerOffset&&TED.playerOffset>0&&this.playerElement.player("seek",TED.playerOffset),this.playerElement.player("play")},player:function(){return this.playerElement}}),function(t,n){return e(t).playerHero(n)}}),define("hbs!templates/popupMenu",["hbs","hbs/handlebars"],function(e,t){var n=t.template({1:function(e,t,n,i){var s,a;return'      <li class="poup-menu__item">\n        <a href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:i}):a))+'" '+(null!=(s=t["if"].call(e,null!=e?e.blank:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+' class="l3 popup-menu__link">\n          '+this.escapeExpression((a=null!=(a=t.label||(null!=e?e.label:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"label",hash:{},data:i}):a))+"\n        </a>\n      </li>\n"},2:function(){return'target="_blank"'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="popup-menu">\n  <ul class="popup-menu__list">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"  </ul>\n</div>\n"},useData:!0});return t.registerPartial("templates/popupMenu",n),n}),define("widgets/popupMenu",["jquery","lodash","hbs!templates/popupMenu","widgets/tooltip"],function(e,t,n){"use strict";return e.widget("ted.popupMenu",e.ted.tooltip,{options:{interactive:!0,inverse:!0,items:[],position:{my:"center top+10",at:"center bottom",of:window,collision:"fit flip"}},_create:function(){this.options.content||(this.options.content=n({items:this._items()})),this._super(),this._on(this.popupObject,{"click a.popup-menu__link":function(e){var t=this.popupObject.find("a.popup-menu__link").index(e.target),n=-1===t?null:this.options.items[t];n.url||e.preventDefault(),this._trigger("itemclick",e,n)!==!1&&n.callback&&n.callback.call(e.target,e,n)}})},_items:function(){return t.map(this.options.items,function(e){var n=e.url||"#",i=e.blank||n.match(/^(?:https?:)?\/\//);return t.merge({},e,{url:n,blank:i})})}}),function(t,n){return e(t).popupMenu(n)}}),define("hbs!templates/talkDownloadModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'    <select class="talk-download__language form-control form-control--dropdown">\n      <option value="">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Subtitles: None",{name:"t",hash:{},data:i}))+"</option>\n"+(null!=(s=t.each.call(e,null!=e?e.subtitledLanguages:e,{name:"each",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+"    </select>\n"},2:function(e,t,n,i){var s;return'        <option value="'+this.escapeExpression((s=null!=(s=t.languageCode||(null!=e?e.languageCode:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"languageCode",hash:{},data:i}):s))+'">\n          '+this.escapeExpression((s=null!=(s=t.languageName||(null!=e?e.languageName:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"languageName",hash:{},data:i}):s))+"\n        </options>\n"},4:function(e,t,n,i){var s;return'      <li data-size="'+this.escapeExpression((s=null!=(s=t.size||(null!=e?e.size:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"size",hash:{},data:i}):s))+'">\n        <label>\n          <input name="size" class="talk-download__size" type="radio" value="'+this.escapeExpression((s=null!=(s=t.size||(null!=e?e.size:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"size",hash:{},data:i}):s))+'">\n          '+this.escapeExpression((s=null!=(s=t.label||(null!=e?e.label:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"label",hash:{},data:i}):s))+"\n        </label>\n      </li>\n"},6:function(e,t,n,i){var s;return'  <div class="talk-download__audio">\n    <h4>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Audio",{name:"t",hash:{},data:i}))+'</h4>\n    <div class="talk-download__coach">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Audio downloads are available in MP3 format.",{name:"t",hash:{},data:i}))+'</div>\n\n    <a class="button" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.talk:e)?s.audioDownload:s,e))+'" download>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Download audio",{name:"t",hash:{},data:i}))+"</a>\n  </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n  </a>\n\n  <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Download this talk",{name:"t",hash:{},data:i}))+'</h3>\n</div>\n\n<div class="talk-download__video">\n  <h4>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Video",{name:"t",hash:{},data:i}))+'</h4>\n  <div class="talk-download__coach">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Videos are available for download in MP4 format.",{name:"t",hash:{},data:i}))+"</div>\n\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.talk:e)?s.subtitledDownloads:s,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'\n  <ul class="talk-download__list">\n'+(null!=(s=t.each.call(e,null!=e?e.sizes:e,{name:"each",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?s:"")+'  </ul>\n\n  <a class="button talk-download__button--video" href="#" download>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Download video",{name:"t",hash:{},data:i}))+'</a>\n\n  <div class="talk-download__link">\n    For low bandwidth downloads,\n    <a href="http://www.ted.com/talks/quick-list" target="_blank">\n      visit TED\'s quicklist\n    </a>\n  </div>\n</div>\n\n'+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.talk:e)?s.audioDownload:s,{name:"if",hash:{},fn:this.program(6,i,0),inverse:this.noop,data:i}))?s:"")},useData:!0});return t.registerPartial("templates/talkDownloadModal",n),n}),define("widgets/talkDownloadModal",["jquery","hbs!templates/talkDownloadModal","widgets/modal"],function(e,t){"use strict";function n(e,t){for(var n,i=e.length,s=[],a=-1;++a<i;)n=e[a],t&&t[n.languageCode]&&s.push(n);return s}var i=[{size:"low",label:"Low (320x180)"},{size:"medium",label:"Medium (512x288)"},{size:"high",label:"High (854x480)"}];e.widget("ted.talkDownloadModal",e.ted.modal,{options:{subtitle:null,talk:null},elements:{},_create:function(){this.element.html(t({sizes:i,talk:this.options.talk,subtitledLanguages:n(this.options.talk.languages,this.options.talk.subtitledDownloads)})),this.elements.sizeRadios=this.element.find("input.talk-download__size"),this.elements.sizeItems=this.elements.sizeRadios.closest("li"),this.elements.videoDownload=this.element.find("a.talk-download__button--video"),this.elements.languageDropdown=this.element.find("select.talk-download__language"),this._on({talkdownloadmodalopen:this._onOpen}),this._super(),this._on({"click input.talk-download__size":this.refreshVideoUrl,"change select.talk-download__language":this.refreshVideoUrl,"click a.talk-download__button--video":function(e){this._trigger("download",e,{type:"video",language:this.elements.languageDropdown.val(),quality:this.elements.sizeRadios.filter(":checked:data(visible)").val()})},"click a.talk-download__button--audio":function(e){this._trigger("download",e,{type:"audio"})}}),this.refreshVideoUrl()},refreshVideoUrl:function(){var t,n=this.elements.languageDropdown.val(),i=this.options.talk;t=n?i.subtitledDownloads[n]:i.nativeDownloads,this.elements.sizeItems.each(function(){var n=e(this),i=n.find("input"),s="visible",a=t[n.data("size")];a?(n.show(),i.data(s,s)):(n.hide(),i.removeData(s))});var s=this.elements.sizeRadios.filter(":checked:data(visible)");s.length||(s=this.elements.sizeRadios.filter(":data(visible)").last().prop("checked",!0)),this.elements.videoDownload.attr("href",t[s.val()])},_onOpen:function(){this.options.subtitle&&this.elements.languageDropdown.length&&this.elements.languageDropdown.val(this.options.subtitle),this.refreshVideoUrl()}})}),define("hbs!templates/talkEmbedModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'    <div>\n      <h4 class="m5">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Select subtitles",{name:"t",hash:{},data:i}))+'</h4>\n      <select class="talk-embed__language">\n        <option value="">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Subtitles: None",{name:"t",hash:{},data:i}))+"</option>\n"+(null!=(s=t.each.call(e,null!=(s=null!=e?e.talk:e)?s.languages:s,{name:"each",hash:{},fn:this.program(2,i,0),inverse:this.noop,data:i}))?s:"")+"      </select>\n    </div>\n"},2:function(e,t,n,i){var s;return'          <option value="'+this.escapeExpression((s=null!=(s=t.languageCode||(null!=e?e.languageCode:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"languageCode",hash:{},data:i}):s))+'">\n            '+this.escapeExpression((s=null!=(s=t.languageName||(null!=e?e.languageName:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"languageName",hash:{},data:i}):s))+"\n          </options>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n  </a>\n\n  <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Embed this talk",{name:"t",hash:{},data:i}))+'</h3>\n</div>\n\n<div class="talk-embed">\n  <div>\n    <h4 class="m5">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Copy & paste this code into your website or blog.",{name:"t",hash:{},data:i}))+'</h4>\n    <input class="form-control talk-embed__code">\n    <h4 class="m5">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Wordpress shortcode",{name:"t",hash:{},data:i}))+'</h4>\n    <input class="form-control talk-embed__wordpress">\n  </div>\n\n'+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.talk:e)?s.languages:s,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'\n  <div class="talk-embed__sizes">\n    <h4 class="m5">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Select a size",{name:"t",hash:{},data:i}))+'</h4>\n    <a class="talk-embed__size talk-embed__size--small" href="#" data-x="560" data-y="315">560 x 315</a>\n    <a class="talk-embed__size talk-embed__size--selected talk-embed__size--medium" href="#" data-x="640" data-y="360">640 x 360</a>\n    <a class="talk-embed__size talk-embed__size--large" href="#" data-x="854" data-y="480">854 x 480</a>\n  </div>\n</div>\n'},useData:!0});return t.registerPartial("templates/talkEmbedModal",n),n}),define("widgets/talkEmbedModal",["jquery","hbs!templates/talkEmbedModal","widgets/modal"],function(e,t){"use strict";var n="talk-embed",i=n+"__size",s=i+"--selected";e.widget("ted.talkEmbedModal",e.ted.modal,{options:{talk:null},elements:{},_create:function(){this._setContent(),this._super(),this._on({"click a.talk-embed__size":function(t){this.elements.sizes.removeClass(s),e(t.target).addClass(s),this.refreshEmbed(),t.preventDefault()
},"click input.talk-embed__code":function(t){e(t.target).select()},"change select.talk-embed__language":this.refreshEmbed}),this.refreshEmbed()},_setContent:function(){this.element.html(t(this.options)),this.elements.code=this.element.find("input."+n+"__code"),this.elements.wordpress=this.element.find("input."+n+"__wordpress"),this.elements.sizes=this.element.find("a."+i),this.elements.language=this.element.find("select."+n+"__language")},_setOptions:function(e,t){this._super(e,t),this._setContent(),this.refreshEmbed()},refreshEmbed:function(){var e=this.elements.language.val(),t=this.elements.sizes.filter("a."+s),n=e?"lang/"+e+"/":"",i=e?" lang="+e:"";this.elements.code.val(["<iframe ",'src="https://embed-ssl.ted.com/talks/',n,this.options.talk.slug,'.html" ','width="',t.data("x"),'" ','height="',t.data("y"),'" ','frameborder="0" scrolling="no" ',"webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>"].join("")),this.elements.wordpress.val(["[ted id=",this.options.talk.id,i,"]"].join(""))}})}),define("hbs!templates/talkRatingModal",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return'        <li class="talk-rating__item">\n          <label>\n            <input class="talk-rating__checkbox" type="checkbox" value="'+this.escapeExpression((s=null!=(s=t.id||(null!=e?e.id:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"id",hash:{},data:i}):s))+'">\n            <span>'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+"</span>\n          </label>\n        </li>\n"},3:function(e,t,n,i){return'      <div class="talk-rating__flip">\n        <a class="l3 talk-rating__flip__link" href="#">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"See all ratings",{name:"t",hash:{},data:i}))+"</a>\n      </div>\n"},5:function(e,t,n,i){var s;return'        <li class="talk-rating__item">\n          <div class="talk-rating__result">\n            <div class="talk-rating__result__bar" style="width:'+this.escapeExpression((s=null!=(s=t.percent||(null!=e?e.percent:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"percent",hash:{},data:i}):s))+'%"></div>\n            <span class="talk-rating__result__name">'+this.escapeExpression((s=null!=(s=t.name||(null!=e?e.name:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"name",hash:{},data:i}):s))+'</span>\n            <span class="talk-rating__result__value">'+this.escapeExpression((s=null!=(s=t.percent||(null!=e?e.percent:e))?s:t.helperMissing,"function"==typeof s?s.call(e,{name:"percent",hash:{},data:i}):s))+"%</span>\n          </div>\n        </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="talk-rating">\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Close",{name:"t",hash:{},data:i}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Rate this talk",{name:"t",hash:{},data:i}))+'</h3>\n  </div>\n\n  <div class="talk-rating__submit">\n    <p>\n      '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"How would you describe this talk? Tell us by choosing up to three words. (If you choose just one, it will count three times.)",{name:"t",hash:{},data:i}))+'\n    </p>\n\n    <ul class="talk-rating__list">\n'+(null!=(s=t.each.call(e,null!=e?e.ratings:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'    </ul>\n\n    <button class="button talk-rating__submit__commit" disabled>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Submit",{name:"t",hash:{},data:i}))+"</button>\n\n"+(null!=(s=t["if"].call(e,null!=e?e.total:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+'  </div>\n\n  <div class="talk-rating__show">\n    <p>\n      <span class="talk-rating__submitted-message">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Thanks for rating this talk!",{name:"t",hash:{},data:i}))+"</span>\n      "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Here's what everyone else thought:",{name:"t",hash:{},data:i}))+'\n    </p>\n\n    <ul class="talk-rating__list">\n'+(null!=(s=t.each.call(e,null!=e?e.ratings:e,{name:"each",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+'    </ul>\n\n    <div class="talk-rating__flip">\n      <a class="l3 talk-rating__flip__link" href="#">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Submit your own rating",{name:"t",hash:{},data:i}))+"</a>\n    </div>\n  </div>\n\n</div>\n"},useData:!0});return t.registerPartial("templates/talkRatingModal",n),n}),function(e,t,n){"object"==typeof exports?module.exports=n():"function"==typeof define&&define.amd?define("depot",n):t[e]=n()}("depot",this,function(){"use strict";function e(e){return e&&JSON.parse(e)}function t(e,t){return e+"-"+t}function n(e,t){var n,i;if("function"==typeof e)n=e(t);else{n=!0;for(i in e)n&=e[i]===t[i]}return n}function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function s(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function a(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function o(e,t){var n,i;if(t=a({idAttribute:"_id",storageAdaptor:localStorage},t),!t.storageAdaptor)throw new Error("No storage adaptor was found");return n=t.storageAdaptor.getItem(e),i=n&&n.split(",")||[],Object.create(r,{name:{value:e},store:{value:n},ids:{value:i,writable:!0},idAttribute:{value:t.idAttribute},storageAdaptor:{value:t.storageAdaptor}})}var r={save:function(e){var n;return e[this.idAttribute]||(e[this.idAttribute]=s()),n=e[this.idAttribute]+"",this.ids.indexOf(n)<0&&(this.ids.push(n),this.storageAdaptor.setItem(this.name,this.ids.join(","))),this.storageAdaptor.setItem(t(this.name,n),JSON.stringify(e)),e},update:function(e,t){"undefined"==typeof t&&(t=e,e=t[this.idAttribute]);var n=this.get(e);return n&&(n=a(n,t),this.save(n)),n},updateAll:function(e){var t=this.all();return t.forEach(function(t){t=a(t,e),this.save(t)},this),t},find:function(i){var s,a,o=this.name,r=this;return i?this.ids.reduce(function(l,u){return a=e(r.storageAdaptor.getItem(t(o,u))),s=n(i,a),s&&l.push(a),l},[]):this.all()},get:function(n){return e(this.storageAdaptor.getItem(t(this.name,n)))},all:function(){var n,i=this,s=this.name;return this.ids.reduce(function(a,o){return n=i.storageAdaptor.getItem(t(s,o)),n&&a.push(e(n)),a},[])},destroy:function(n){var i,s=n[this.idAttribute]?n[this.idAttribute]:n,a=t(this.name,s);return n=e(this.storageAdaptor.getItem(a)),this.storageAdaptor.removeItem(a),i=this.ids.indexOf(s),-1!=i&&this.ids.splice(i,1),this.storageAdaptor.setItem(this.name,this.ids.join(",")),n},destroyAll:function(i){for(var s,a,o,r,l=this.ids.length-1;l>=0;l--)s=this.ids[l],r=t(this.name,s),i?(o=e(this.storageAdaptor.getItem(r)),a=n(i,o),a&&(this.storageAdaptor.removeItem(r),this.ids.splice(l,1))):this.storageAdaptor.removeItem(r);i?this.storageAdaptor.setItem(this.name,this.ids.join(",")):(this.storageAdaptor.removeItem(this.name),this.ids=[])},size:function(){return this.ids.length}};return o}),define("widgets/talkRatingModal",["jquery","lodash","Modernizr","hbs!templates/talkRatingModal","depot","widgets/modal"],function(e,t,n,i,s){"use strict";var a=e.ted.modal.prototype;if(n.localstorage){var o=s("talkRatings",{idAttribute:"id",storageAdaptor:window.sessionStorage});e.widget("ted.talkRatingModal",e.ted.modal,{options:{talkId:null,ratings:[]},_create:function(){var e=o.get(this.options.talkId),n=this;this._calculateTotal(),this._calculatePercents(),this.element.html(i({ratings:this.options.ratings,total:this.options.total})),e&&this.submitted(),a._create.apply(this,t.toArray(arguments)),this.boxes=this.element.find("input.talk-rating__checkbox"),this.button=this.element.find("button.talk-rating__submit__commit"),this._on("button.talk-rating__submit__commit",{click:function(e){e.preventDefault(),n.submit()}}),this._on("input.talk-rating__checkbox",{click:function(){n.sanitize()}}),this._on("a.talk-rating__flip__link",{click:function(e){e.preventDefault(),n.element.toggleClass("talk-rating--flipped")}})},_calculatePercents:function(){var e=this.options.total;t.forEach(this.options.ratings,function(t){t.percent=e>0?Math.round(t.count/e*100):0})},_calculateTotal:function(){var e=t.pluck(this.options.ratings,"count");this.options.total=t.reduce(e,function(e,t){return e+t})},sanitize:function(){var e=this.boxes,t=e.filter(":checked");this.button.prop("disabled",!t.length),e.not(t).prop("disabled",t.length>2)},submit:function(){var t=this.element.find("input.talk-rating__checkbox:checked"),n=t.map(function(){return+this.value}).toArray(),i=this;return this._trigger("submit"),e.post("/ratings",{talk_id:this.options.talkId,talk_rating_ids:n},"json").then(function(){o.save({id:i.options.talkId,ratings:n}),i.submitted()},function(){window.alert("Sorry, your rating couldn't be saved. Please try again.")})},submitted:function(){this.element.addClass("talk-rating--submitted")}})}}),define("widgets/favoriteButton",["jquery","lodash","lib/auth","lib/favorite","lib/pubSub","widgets/tooltip"],function(e,t,n,i,s){"use strict";function a(){return e(document.documentElement).hasClass("loggedin")}var o="favorite-button",r=o+"--remove",l=o+"--add",u=o+"--working",c=o+"__label",d="Remove",h="Favorite",p="Error",f="Working…";e.widget("ted.favoriteButton",e.ted.tooltip,{options:{favoriteId:null,interactive:!0,inverse:!0,position:{my:"right middle",at:"left middle",collision:"flip flip"},itemId:null,itemType:null,supportTouch:!1,allowClick:!0,signInUrl:window.TED?window.TED.signInUrl:"",signUpUrl:window.TED?window.TED.signUpUrl:""},add:function(){this._toggleFavorite(!0)},details:function(){var e,t=this.options;return e={itemId:t.itemId,itemType:t.itemType},t.favoriteId&&(e.id=t.favoriteId),e},remove:function(){this._toggleFavorite(!1)},_handleFavoriteButtonEvents:{click:function(e){(a()||n.capable())&&(e.preventDefault(),a()?this._toggleFavorite():n.prompt().done(this._toggleFavoriteBound))}},_isAdded:!1,_checkAddition:function(e){this._isOurItem(e)&&this._toggledFavorite(!0)},_checkRemoval:function(e){this._isOurItem(e)&&this._toggledFavorite(!1)},_create:function(){var e=this;this.element.addClass(o),this.label=this.element.find("."+c),t.extend(e.options,{content:'<div style="color:#111;text-align:left;font-size:13px;line-height:1.4;width:145px;"><a class="l3 auth-login" href="'+e.options.signInUrl+'">Log in</a> or <a class="l3" href="'+e.options.signUpUrl+'">sign up</a><br>to add favorites.</div>',beforeOpen:function(){return!a()}}),e._checkDetails(),e._checkAddition=t.bind(e._checkAddition,e),e._checkRemoval=t.bind(e._checkRemoval,e),s("favorite.add").subscribe(e._checkAddition),s("favorite.remove").subscribe(e._checkRemoval),e._on(e._handleFavoriteButtonEvents),e._super(),e._toggleFavoriteBound=t.bind(e._toggleFavorite,e),a()||(e.element.attr("href",e.options.signInUrl),s("auth.login").subscribe(function(){e._checkDetails(),e.element.attr("href","#")}))},_destroy:function(){s("favorite.add").unsubscribe(this._checkAddition),s("favorite.remove").unsubscribe(this._checkRemoval),this._super()},_isOurItem:function(e){return e.itemId===this.options.itemId||e.itemType===this.options.itemType},_setOption:function(e,t){this._super(e,t),("itemId"===e||"itemType"===e)&&this._checkDetails()},_checkDetails:function(){var e=this;i.get(e.details()).then(function(t){e._isAdded=!!t,t&&(e.options.favoriteId=t.id),e._toggledFavorite(e._isAdded)},function(){e._toggledFavorite(!1)})},_setLabel:function(e){this.label.text(e)},_toggleFavorite:function(e){var n=this;t.isUndefined(e)&&(e=!this._isAdded),e=!!e,n.element.hasClass(u)||(n.element.addClass(u),n._setLabel(f),i[e?"add":"remove"](n.details()).then(function(t){n.options.favoriteId=e?t.id:null,n._toggledFavorite(e)},function(){n._setLabel(p),t.delay(function(){n._setLabel(e?h:d)},800)}).always(function(){n.element.removeClass(u)}))},_toggledFavorite:function(e){this._setLabel(e?d:h),this._isAdded=e,this.element.addClass(e?r:l).removeClass(e?l:r)}})}),define("widgets/watchLaterButton",["jquery","lodash","deferLink","lib/auth","lib/ga","lib/watchLater","lib/pubSub","widgets/tooltip"],function(e,t,n,i,s,a,o){"use strict";function r(){return e(document.documentElement).hasClass("loggedin")}var l="watch-later-button",u=l+"--remove",c=l+"--add",d=l+"--working",h=l+"__label",p="Remove",f="Watch later",m="Error",g="Working…";e.widget("ted.watchLaterButton",e.ted.tooltip,{options:{interactive:!0,inverse:!0,position:{my:"right middle",at:"left middle",collision:"flip flip"},saveId:null,itemId:null,itemType:null,supportTouch:!1,allowClick:!0,signInMessage:"Short on time? Save\nthis to watch later.",signInUrl:window.TED?window.TED.signInUrl:""},add:function(){this._toggleSave(!0)},details:function(){var e,t=this.options;return e={itemId:t.itemId,itemType:t.itemType},t.saveId&&(e.id=t.saveId),e},update:function(e){t.extend(this.options,e),a.update(this.details())},remove:function(){this._toggleSave(!1)},_handleWatchLaterEvents:{click:function(e){return s.sendEvent("watchLater","click",this.options.itemType.toLowerCase()),r()||i.capable()?(e.preventDefault(),void(r()?this._toggleSave():i.prompt().done(this._toggleSaveBound))):void n(50).call(e.target,e)}},_isSaved:!1,_checkAddition:function(e){this._isOurItem(e)&&this._toggledSave(!0)},_checkRemoval:function(e){this._isOurItem(e)&&this._toggledSave(!1)},_create:function(){var e=this;this.element.addClass(l),this.label=this.element.find("."+h),t.extend(e.options,{content:'<div style="color:#111;font-size:13px;line-height:1.6;text-align:left;width:145px;">'+e.options.signInMessage.replace("\n","<br>")+"</div>",beforeOpen:function(){return!r()}}),e._checkDetails(),e._checkAddition=t.bind(e._checkAddition,e),e._checkRemoval=t.bind(e._checkRemoval,e),o("watchLater.add").subscribe(e._checkAddition),o("watchLater.remove").subscribe(e._checkRemoval),e._on(e._handleWatchLaterEvents),e._super(),e._toggleSaveBound=t.bind(e._toggleSave,e),r()||(e.element.attr("href",e.options.signInUrl),o("auth.login").subscribe(function(){e._checkDetails(),e.element.attr("href","#")}))},_destroy:function(){o("watchLater.add").unsubscribe(this._checkAddition),o("watchLater.remove").unsubscribe(this._checkRemoval),this._super()},_isOurItem:function(e){return e.itemId===this.options.itemId&&e.itemType===this.options.itemType},_setOption:function(e,t){this._super(e,t),("itemId"===e||"itemType"===e)&&this._checkDetails()},_checkDetails:function(){var e=this;a.get(e.details()).then(function(t){e._isAdded=!!t,t&&(e.options.saveId=t.id),e._toggledSave(e._isAdded)},function(){e._toggledSave(!1)})},_setLabel:function(e){this.label.text(e)},_toggleSave:function(e){var n=this;t.isUndefined(e)&&(e=!this._isAdded),e=!!e,n.element.hasClass(d)||(n.element.addClass(d),n._setLabel(g),a[e?"add":"remove"](n.details()).then(function(t){n.options.saveId=e?t.id:null,n._toggledSave(e)},function(){n._setLabel(m),t.delay(function(){n._setLabel(e?f:p)},800)}).always(function(){n.element.removeClass(d)}))},_toggledSave:function(e){this._setLabel(e?p:f),this._isAdded=e,this.element.addClass(e?u:c).removeClass(e?c:u)}})}),define("talk/talkPage",["jquery","lodash","./countdown","utils/query_param","lib/ga","lib/pubSub","talk/transcript","lib/ads","lib/instaplay","lib/qos","lib/favorite","lib/watchLater","utils/share","utils/timeFromUrl","views/subtitle-modal","hbs!templates/talkEndCard","hbs!templates/talkViewsBreakdown","views/ThreadView","models/Thread","hbs!templates/subtitle-help-modal","widgets/playerHero","widgets/tooltip","widgets/popupMenu","widgets/talkArticleLink","widgets/talkDownloadModal","widgets/talkEmbedModal","widgets/talkRatingModal","widgets/favoriteButton","widgets/watchLaterButton","waypoints"],function(e,t,n,i,s,a,o,r,l,u,c,d,h,p,f,m,g,_,v,b){"use strict";function y(e,t){"embed"===t.service?k.embed(e):(s.sendEvent("talk.share","start",t.service),h(t.service,{url:w.talks[0].shareUrl||w.talks[0].canonical,message:w.talks[0].title}))}var w,k={};return k.endCardTempl=function(e){var i=k.hero.data("tedPlayerHero").playerElement,s=n.getNext(e.relatedTalks);return s&&l.capable()&&"flash"===i.player("mode")?n.template({nextTalk:s,relatedTalks:t.reject(e.relatedTalks,s)}):m(e)},k.forceEndCard=function(){var e=i("endCard");if(e){var s,a=k.options.relatedTalks.slice(0,3),o=a[0],r=t.reject(a,o);s="checker"===e?n.checkerTemplate({nextTalk:o,relatedTalks:r}):"timer"===e||"timer-halted"===e?n.timerTemplate({nextTalk:o,relatedTalks:r}):m({relatedTalks:a}),k.hero.removeClass("player-hero--unactivated").addClass("player-hero--playing player-hero--ended").find("a.player-hero__play").after(s),"timer"===e&&n.startCountdown()}},k.checkDeepLink=function(){var e=p(),t=e.seconds;if(t){if(e.offset){var n=w.talks[0].introDuration;t+=n}var i=k.hero.data("tedPlayerHero").playerElement;i.one("playerready",function(){i.player("seek",t)})}},k.initComments=t.once(function(){var e=new v({id:w.threadId}),t=new _({el:document.getElementById("thread"),model:e});t.render(),e.set("sort",t.getSort()),e.more(),a("comment.report").subscribe(function(){s.sendEvent("comment","flag","talk")}),a("comment.create").subscribe(function(e){s.sendEvent("comment",e.parentId?"reply":"new","talk")}),a("comment.upvote").subscribe(function(e){e.upvoted&&s.sendEvent("comment","upvote","talk")})}),k.initExtras=function(){var n=[];e('a.ga-link[data-ga-category="talk.extras"]').each(function(){n.push(e(this).data("ga-label").split("|")[0])}),n.length&&s.sendEvent("talk.extras","impression",t.uniq(n).join("|"),{nonInteraction:1}),e("a.open-article").talkArticleLink(),e("a.talk-more__link--citations").on("talkarticlelinkshow",function(){s.sendEvent("talk.extras","click","citation|show")}).on("talkarticlelinkhide",function(){s.sendEvent("talk.extras","click","citation|hide")})},k.initInstaplay=function(){l.check(window.location.href)&&k.hero.playerHero("player").player("play")},k.init=function(i){var a=i.talks[0];w=i,k.options=w,k.hero=e("#player-hero").playerHero({isTranscript:!0,nativeLanguage:w.language,precontrol:w.precontrol||!1,talks:w.talks}),s.sendEvent("talk.page","view",a.id,{nonInteraction:1}),k.initSubtitles(),r.initPlayer(k.hero.playerHero("player")),u.player=k.hero.playerHero("player"),u.initQos(),k.initInstaplay(),k.initWatchLater(a),k.initFavorite(a),k.checkDeepLink();var l=[{label:"Twitter",service:"twitter",smallOnly:!0},{label:"Facebook",service:"facebook",smallOnly:!0},{label:"Email",service:"email",smallOnly:!0},{label:"Google +",service:"gplus"},{label:"LinkedIn",service:"linkedin"},{label:"Pinterest",service:"pinterest"}],c=e("#sharing-other").popupMenu({items:t.map(l,function(e){return t.merge(e,{callback:y})})}).popupMenu("popup").find("li.poup-menu__item");t.each(t.filter(l,{smallOnly:!0}),function(e,t){c.eq(t).addClass("hide-lg")}),e("a.talk-sharing__link").click(function(t){var n=e(this);t.preventDefault(),y(t,{label:n.data("service-label"),service:n.data("service-name")})}),o.player=k.hero.data("tedPlayerHero").playerElement,o.initLink({offset:1e3*a.introDuration}),o.player.one("playerplay",function(){k.hero.find("a.player-hero__play").after(k.endCardTempl({relatedTalks:w.relatedTalks.slice(0,3)}))}),o.player.one("playerended",n.startCountdown),e("a.download-button").on("click",k.download),e("a.rate-button").on("click",k.rate),e("#thread").waypoint(k.initComments,{offset:"100%"}),k.initCoder(),k.initExtras(),k.initNoLanguage(),k.forceEndCard()},k.initCoder=function(){var e;return t.once(function(){history&&history.replaceState&&(o.player.on("playerpause",function(){if(e){var t=window.location.href.split("#")[0],n=e-w.talks[0].introDuration;if(0>=n)return;history.replaceState(history.state,null,t+"#t-"+Math.floor(1e3*n))}}),o.player.on("playercurrenttime",function(t,n){e=n.currentTime}))})}(),k.download=function(){var t;return function(n){n&&n.preventDefault()&&n.preventDefault(),t?t.talkDownloadModal("open"):(t=e("<div>").talkDownloadModal(e.extend({open:s.sendEvent.recall("talk.download","show"),download:function(e,t){s.sendEvent("talk.download","download",t.type+("audio"===t.type?"":"|"+t.quality))}},{talk:w.talks[0]})),o.player.on("playersubtitle",function(e,n){t.talkDownloadModal("option","subtitle",n.subtitle.languageCode)}))}}(),k.embed=function(){var t;return function(){t?t.talkEmbedModal("open"):t=e("<div>").talkEmbedModal(e.extend({open:s.sendEvent.recall("talk.embed","show")},{talk:w.talks[0]}))}}(),k.initBreakdown=function(n){e("#sharing-count").tooltip({openDelay:300,content:g({sources:t.map(n,function(e){return e.width=e.value/2,e})}),position:{my:"center top+10",at:"center bottom",of:window,collision:"fit flip"},inverse:"true",interactive:!0})},k.initFavorite=function(n){var i={itemId:n.id,itemType:"Talk"};e("a.favorite-button").favoriteButton(i);var o=null,r=t.once(function(){s.sendEvent("favorite","play","talk")}),l=k.hero.playerHero("player");l.on("playercurrenttime",function(){o&&r()}),c.get(i).done(function(e){e&&(o=e.id)}),a("favorite.add").subscribe(function(e){e.itemId===i.itemId&&e.itemType===i.itemType&&(o=e.id)}),a("favorite.remove").subscribe(function(e){e.itemId===i.itemId&&e.itemType===i.itemType&&(o=null)})},k.initNoLanguage=function(){i("nolanguage")&&e("<div class=player-hero__hiccup><div class=player-hero__inner><div class=container>Sorry, subtitles are not available in the language you requested.</div></div></div>").insertBefore(k.hero)},k.initSubtitles=function(){var t=e("#hero-subtitle-link"),n=k.hero.playerHero("player"),i=e("<div>").html(b()).modal({autoOpen:!1}),a=!1,o=new f;k.hero.on("click","a.controls__subtitles",function(){s.sendEvent("talk.subtitleSelector","show","controls")}),e("#hero-subtitle-help").on("click",function(e){e.preventDefault(),e.stopPropagation(),i.modal("open")}),t.on("click",function(e){e.preventDefault(),a&&(o.open(),s.sendEvent("talk.subtitleSelector","show","hero"))});var r;o.state.on("change:selected",function(e,t){var i=String(r),s=String(t),a=s!==i,l=!!t&&a;a&&(n.player("subtitle",t),o.close()),l&&n.player("play")}),n.on({playerready:function(){n.player("canSubtitle")&&(o.render(),a=!0,t.removeClass("player-hero__meta__transcript-link--unclickable"))},playersubtitle:function(e,t){r=t&&t.subtitle&&t.subtitle.languageCode?t.subtitle.languageCode:!1,o.state.set("selected",r)},playertalk:function(e,t){o.state.set("languages",t.languages)}})},k.initWatchLater=function(n){var i={itemId:n.id,itemType:"Talk"},o=k.hero.playerHero("player");e("a.watch-later-button").watchLaterButton(e.extend({signInMessage:"Short on time? Save\nthis talk to watch later."},i));var r=null,l=t.once(function(e){s.sendEvent("watchLater","play","talk",e)});o.on("playercurrenttime",t.throttle(function(e,t){if(r){var n=Math.floor(t.currentTime);n>5&&d.update({id:r,secondsPlayed:n}),l(n)}},3e4)),d.get(i).done(function(e){e&&(e.secondsPlayed&&!p().seconds&&o.one("playerready",function(){o.player("seek",e.secondsPlayed,!0)}),r=e.id)}),a("watchLater.add").subscribe(function(e){e.itemId===n.id&&(r=e.id)}),a("watchLater.remove").subscribe(function(e){e.itemId===n.id&&(r=null)})},k.rate=function(){var t;return function(n){n&&n.preventDefault()&&n.preventDefault(),t?t.talkRatingModal("open"):t=e("<div>").talkRatingModal(e.extend({open:s.sendEvent.recall("talk.rate","show"),submit:s.sendEvent.recall("talk.rate","submit")},{talkId:w.talks[0].id,ratings:w.ratings}))}}(),k.hero=null,k}),define("global/floodlight",["jquery","exports"],function(e,t){"use strict";t.close=function(){window.localStorage.setItem("floodlight","hide"),e("#floodlight").slideUp(240)},t.clear=function(){try{window.localStorage.removeItem("floodlight")}catch(e){}}}),define("global/links",["jquery","deferLink","lib/ga"],function(e,t,n){"use strict";function i(e){if(e.match(location.origin))return!1;for(var t=-1;++t<r;)if(e.match(o[t].re))return o[t]}function s(t,n,i){t=e.extend({},l,t);for(var s in t)t.hasOwnProperty(s)&&e.isFunction(t[s])&&(t[s]=t[s].call(n,i));return t}function a(e){var a=i(this.href);return a?(n.send(s(a,this,e)),t.call(this,e)):!0}var o=[{re:/^https?:\/\/(?:.*\.)tedprize\.(org|com)/,eventCategory:"link.outbound.tedPrize"},{re:/^https?:\/\/ed\.ted\.com/,eventCategory:"link.outbound.tedEd"},{re:/^https?:\/\/tedfellows\.posterous\.com/,eventCategory:"link.outbound.fellowsBlog"},{re:/^https?:\/\/(?:.*\.)universalsubtitles\.org/,eventCategory:"link.outbound.translatorDashboard"},{re:/^https?:\/\/(?:.*\.)feedburner\.com/,eventCategory:"link.outbound.feedburner"},{re:/^https?:\/\//}],r=o.length,l={hitType:"event",eventCategory:"link.outbound.other",eventAction:"click",eventLabel:function(){return this.href}};return{init:function(){e("body").on("click","a[href]",a)}}}),define("Mailcheck",["exports"],function(){var e={domainThreshold:2,secondLevelThreshold:2,topLevelThreshold:2,defaultDomains:["msn.com","bellsouth.net","telus.net","comcast.net","optusnet.com.au","earthlink.net","qq.com","sky.com","icloud.com","mac.com","sympatico.ca","googlemail.com","att.net","xtra.co.nz","web.de","cox.net","gmail.com","ymail.com","aim.com","rogers.com","verizon.net","rocketmail.com","google.com","optonline.net","sbcglobal.net","aol.com","me.com","btinternet.com","charter.net","shaw.ca"],defaultSecondLevelDomains:["yahoo","hotmail","mail","live","outlook","gmx"],defaultTopLevelDomains:["com","com.au","com.tw","ca","co.nz","co.uk","de","fr","it","ru","net","org","edu","gov","jp","nl","kr","se","eu","ie","co.il","us","at","be","dk","hk","es","gr","ch","no","cz","in","net","net.au","info","biz","mil","co.jp","sg","hu"],run:function(t){t.domains=t.domains||e.defaultDomains,t.secondLevelDomains=t.secondLevelDomains||e.defaultSecondLevelDomains,t.topLevelDomains=t.topLevelDomains||e.defaultTopLevelDomains,t.distanceFunction=t.distanceFunction||e.sift3Distance;var n=function(e){return e},i=t.suggested||n,s=t.empty||n,a=e.suggest(e.encodeEmail(t.email),t.domains,t.secondLevelDomains,t.topLevelDomains,t.distanceFunction);return a?i(a):s()},suggest:function(e,t,n,i,s){e=e.toLowerCase();var a=this.splitEmail(e);if(n&&i&&-1!==n.indexOf(a.secondLevelDomain)&&-1!==i.indexOf(a.topLevelDomain))return!1;var o=this.findClosestDomain(a.domain,t,s,this.domainThreshold);if(o)return o==a.domain?!1:{address:a.address,domain:o,full:a.address+"@"+o};var r=this.findClosestDomain(a.secondLevelDomain,n,s,this.secondLevelThreshold),l=this.findClosestDomain(a.topLevelDomain,i,s,this.topLevelThreshold);if(a.domain){var o=a.domain,u=!1;if(r&&r!=a.secondLevelDomain&&(o=o.replace(a.secondLevelDomain,r),u=!0),l&&l!=a.topLevelDomain&&(o=o.replace(a.topLevelDomain,l),u=!0),1==u)return{address:a.address,domain:o,full:a.address+"@"+o}}return!1},findClosestDomain:function(e,t,n,i){i=i||this.topLevelThreshold;var s,a=99,o=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var r=0;r<t.length;r++){if(e===t[r])return e;s=n(e,t[r]),a>s&&(a=s,o=t[r])}return i>=a&&null!==o?o:!1},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,i=0,s=0,a=0,o=5;n+i<e.length&&n+s<t.length;){if(e.charAt(n+i)==t.charAt(n+s))a++;else{i=0,s=0;for(var r=0;o>r;r++){if(n+r<e.length&&e.charAt(n+r)==t.charAt(n)){i=r;break}if(n+r<t.length&&e.charAt(n)==t.charAt(n+r)){s=r;break}}}n++}return(e.length+t.length)/2-a},splitEmail:function(e){var t=e.trim().split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var i=t.pop(),s=i.split("."),a="",o="";if(0==s.length)return!1;if(1==s.length)o=s[0];else{a=s[0];for(var n=1;n<s.length;n++)o+=s[n]+".";o=o.substring(0,o.length-1)}return{topLevelDomain:o,secondLevelDomain:a,domain:i,address:t.join("@")}},encodeEmail:function(e){var t=encodeURI(e);return t=t.replace("%20"," ").replace("%25","%").replace("%5E","^").replace("%60","`").replace("%7B","{").replace("%7C","|").replace("%7D","}")}};return"undefined"!=typeof module&&module.exports&&(module.exports=e),"function"==typeof define&&define.amd&&define("mailcheck",[],function(){return e}),"undefined"!=typeof window&&window.jQuery&&!function(t){t.fn.mailcheck=function(t){var n=this;if(t.suggested){var i=t.suggested;t.suggested=function(e){i(n,e)}}if(t.empty){var s=t.empty;t.empty=function(){s.call(null,n)}}t.email=this.val(),e.run(t)}}(jQuery),e}),define("lib/newsletter",["jquery","Mailcheck"],function(e,t){"use strict";function n(t){var n=[];return t.isDaily&&n.push("daily"),t.isWeekly&&n.push("weekly"),t.isFellows&&n.push("fellows"),e.getJSON("//www.ted.com/newsletter/signup.json?callback=?",{newsletterSignup:{email_address:t.email,subscription_list:n}})}function i(t){function i(e){"error"===e.status?l.rejectWith(t,[["uncaught"]]):l.resolveWith(t)}function a(){l.rejectWith(t,[["server"]])}function o(){n(t).then(i,a)}function r(e){l.rejectWith(this,[e])}var l=new e.Deferred;return s(t).then(o,r),l}function s(n){var i=[],s=new e.Deferred;return""===n.email&&i.push("blankemail"),(""+n.email).match(/.+@.+/)||i.push("email"),n.isDaily||n.isWeekly||n.isFellows||i.push("subscription"),t.run({email:n.email,suggested:function(e){if(i.push({type:"suggestion",data:e.full}),1===i.length){var s=n.email.match(/@(.+$)/)[1];t.defaultDomains.push(s)}}}),i.length?s.rejectWith(n,[i]):s.resolveWith(n),s.promise()}return{ajax:n,subscribe:i,validate:s}}),define("global/subscribe",["jquery","lodash","lib/newsletter","lib/ga"],function(e,t,n,i){"use strict";function s(e){m(),i.sendEvent("newsletter","submit","footer"),r={email:d.val(),isDaily:u.is(":checked"),isWeekly:c.is(":checked")},n.subscribe(r).then(a,o),e.preventDefault()}function a(){i.sendEvent("newsletter","success",t.filter([r.isDaily?"daily":!1,r.isWeekly?"weekly":!1]).join(",")),e(p+"-details").slideUp(f),e(p+"-success").slideDown(f)}function o(t){var n,i,s,a=t[0];if(h.slideUp(f),"object"==typeof a?(n=a.type,i=a.data):n=a,s=e(p+"-error-"+n),s.slideDown(f),i){var o=s.find(".newsletter-signup-error__data");o.text(i),o.click(function(e){e.preventDefault(),d.val(i),h.slideUp(f)})}}var r,l,u,c,d,h,p="#newsletter-signup",f="fast",m=t.once(function(){u=e(p+"-daily"),c=e(p+"-weekly"),d=e(p+"-email"),h=l.find("p.footer-newsletter__error")});return{init:function(){l=e(p),l.on("submit",s)}}}),define("hbs!templates/latcherFixture",["hbs","hbs/handlebars"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'\n<div class="latcher">\n  <a class="latcher__back" href="#">Main</a>\n</div>\n'},useData:!0});return t.registerPartial("templates/latcherFixture",n),n}),define("global/navs",["jquery","lib/ga","lib/pubSub","spinjs","hbs!templates/latcherFixture","lib/resize"],function(e,t,n,i,s){"use strict";function a(){return l||(l=new i({className:"spinner spinner--centered"})),l}function o(t,n){var i=t.data("url");n.drillDown("findNext",i,function(t){if(t)t.element.drillDown("show");else{var o=e(s());a().spin(o.get(0)),o.find("a.latcher__back").on("click",function(){n.drillDown("show")}),n.drillDown("queue",o,{id:i}),o.drillDown("show"),e.ajax({url:i,xhrFields:{withCredentials:!0}}).done(function(t){a().stop(),o.append(e(t).find("#submenu").addClass("submenu--fixture").find("a.submenu__heading__link[href=#]").closest("h3").remove().end().end().find("li."+p).removeClass(p).end())})}})}function r(i){var s=n("breakpoint").read()>=1024,a=e(this),r=a.closest("li.nav__item"),l=r.siblings(),u=r.closest("div.shoji__fixture"),p=r.closest("div.drillDown"),f=r.children(d),m=r.hasClass(h),g=a.data("ga-label");if(!r.hasClass("nav__item--disabled")){if(r[s?"addClass":"toggleClass"](h),l.not(c).removeClass(h),!f.length)return void(p.length&&r.hasClass("nav__item--latch")&&(i.preventDefault(),o(a,p)));!m&&g&&r.hasClass(h)&&t.sendEvent("navigation.menu","open",g),(u.length||!s)&&(l.filter(c).removeClass(h).children(d).stop(!0,!0).animate({height:"hide"},200),f.stop(!0,!0).animate({height:"toggle"},200),i.preventDefault())
}}var l,u={},c="li.nav__item--foldable",d="div.nav__folder",h="nav__item--active",p="submenu__item--active";return u.init=function(){e(document).on("click","a.nav__link",r)},u}),define("lib/shoji",["jquery","lodash","Modernizr","lib/pubSub","utils/throwError","lib/resize"],function(e,t,n,i,s){"use strict";function a(t){var n=e(t);return n.hasClass(f)||(n=n.closest("div."+f)),n.length||s("Could not find fixture "+t),n}function o(n,i){var s=e("<div class="+f+">"),a={};return t.defaults(a,i,{at:"left"}),v(),s.addClass(f+"--"+a.at),s.data("at",a.at),s.append(n),s.appendTo(h),s}function r(){return v(),n.csstransforms3d&&p>=320}function l(){v(),e(document.activeElement).blur(),d.removeClass(m+" "+g)}function u(e){var t=a(e);v(),h.children().removeClass(_),t.addClass(_),c(t.data("at"))}function c(e){l(),d.addClass("shoji--opened shoji--"+e)}var d,h,p,f="shoji__fixture",m="shoji--left",g="shoji--right",_=f+"--revealed",v=t.once(function(){d=e("#shoji"),h=e("#shoji-fixtures"),e("#shoji-lattice").on("click",function(){return l(),!1}),i("breakpoint").subscribe(function(e){p=e})});return{_getFixture:a,_init:v,addFixture:o,canSlide:r,concealFixture:l,revealFixture:u,slide:c}}),define("widgets/fixture",["jquery","lodash","lib/shoji","jqueryui/widget"],function(e,t,n){"use strict";var i,s=t.once(function(){i=e("body,html")});return e.widget("ted.fixture",{options:{at:"left",autoReveal:!0,scrollAnimationDuration:200},_create:function(){s(),this.fixture=n.addFixture(this.element.remove(),{at:this.options.at}),this.options.autoReveal&&this.reveal()},reveal:function(){this.options.scrollAnimationDuration&&i.scrollTop()&&i.animate({scrollTop:0},this.options.scrollAnimationDuration),n.revealFixture(this.fixture)},conceal:function(){n.concealFixture()}}),function(t,n){return e(t).fixture(n)}}),define("widgets/drillDown",["jquery","lodash","jqueryui/widget"],function(e,t){"use strict";e.widget("ted.drillDown",{options:{id:null,prev:null,next:null,tense:null},_create:function(){var e=this.options,t=e.prev;e.next||(e.next=[]);var n=e.next.length,i=e.tense;i||(i="present",t&&(i="future"),n&&(i="past")),this.element.addClass("drillDown drillDown--"+i),t?e.prev.after(this.element):n&&e.next[0].element.before(this.element)},next:function(e){return e&&(this.options.next=e),this.options.next},prev:function(e,t){return arguments.length?this.options.prev=this._drify(e,{next:this.element},t):this.options.prev},queue:function(e,t){this.options.next.push(this._drify(e,{prev:this.element},t))},show:function(){var e=this.options;if(e.prev&&e.prev.addClass("drillDown--past"),this._nextEls().addClass("drillDown--future"),this._dShow)this._dShow();else{var n=this.element;this._dShow=function(){n.removeClass("drillDown--past drillDown--future")},t.defer(this._dShow)}},findNext:function(e,t){for(var n,i=this.options.next,s=i.length;s--&&!n;)i[s].options.id===e&&(n=i[s]);return t&&t.call(n,n),n},_drify:function(t,n,i){var s=e(t),a=this.widgetFullName;return s.data(a)||s.drillDown(e.extend(n,i||{})).data(a)},_nextEls:function(){for(var t=e(),n=this.options.next,i=n.length;i--;)t=t.add(n[i].element);return t}})}),define("menuAim",["jquery"],function(e){"use strict";function t(t){var n,i=e(this),s=null,a=[],o=null,r=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop},t),l=3,u=300,c=200,d=function(e){a.push({x:e.pageX,y:e.pageY}),a.length>l&&a.shift()},h=function(){o&&clearTimeout(o),r.exitMenu(this)&&(s&&r.deactivate(s),s=null)},p=function(){o&&clearTimeout(o),r.enter(this),_(this)},f=function(){r.exit(this)},m=function(){g(this)},g=function(e){e!==s&&(s&&r.deactivate(s),r.activate(e),s=e)},_=function(e){var t=v();null===t?o=setTimeout(function(){g(e)},c):t?o=setTimeout(function(){_(e)},t):g(e)},v=function(){function t(e,t){return(t.y-e.y)/(t.x-e.x)}if(!s||!e(s).is(r.submenuSelector))return null;var o=i.offset(),l={x:o.left,y:o.top-r.tolerance},c={x:o.left+i.outerWidth(),y:l.y},d={x:o.left,y:o.top+i.outerHeight()+r.tolerance},h={x:o.left+i.outerWidth(),y:d.y},p=a[a.length-1],f=a[0];if(!p)return 0;if(f||(f=p),f.x<o.left||f.x>h.x||f.y<o.top||f.y>h.y)return 0;if(n&&p.x===n.x&&p.y===n.y)return 0;var m=c,g=h;"left"===r.submenuDirection?(m=d,g=l):"below"===r.submenuDirection?(m=h,g=d):"above"===r.submenuDirection&&(m=l,g=c);var _=t(p,m),v=t(p,g),b=t(f,m),y=t(f,g);return b>_&&v>y?(n=p,u):(n=null,0)};i.mouseleave(h).find(r.rowSelector).mouseenter(p).mouseleave(f).on("touchend",function(t){s&&e(s).is(r.submenuSelector)||(t.preventDefault(),m.apply(this,Array.prototype.slice.call(arguments,0)))}).click(m),e(document).mousemove(d)}return e.fn.menuAim=function(e){return this.each(function(){t.call(this,e)}),this},e}),define("global/mainNav",["jquery","lodash","lib/shoji","lib/pubSub","lib/ga","hbs!templates/latcherFixture","lib/resize","widgets/fixture","widgets/drillDown","menuAim"],function(e,t,n,i,s,a){"use strict";function o(t){if(t.preventDefault(),n.canSlide())if(u)u.fixture("reveal");else{u=e("#banner-core").clone(),u.find("nav.nav--main").removeClass("nav--main"),u.add("*[id]",u).removeAttr("id"),u.find("li.nav__item--latch a").attr("href",function(){var t=e(this),n=t.attr("href");return t.attr("data-url",n),"#"}),u.show(),u.fixture();var i=e("div.shoji__fixture--left #submenu");if(u.drillDown({tense:i.length?"past":"present"}),!i.length)return;var s=e(a()).append(i.clone().addClass("submenu--fixture"));s.find("a.latcher__back").on("click",function(){u.drillDown("show")}),u.drillDown("queue",s,{tense:"present"})}else e("#main-nav").toggleClass("nav--main--open")}function r(t){1024>t||(i("breakpoint").unsubscribe(r),e("#main-nav").find("ul:first > li > a").each(function(){var t=e(this);e('<span class="nav__link nav__link--placeholder" aria-hidden></span>').text(t.text()).insertAfter(t),t.addClass("nav__link--placeheld")}))}function l(){function n(){l=!0,f.trigger("mouseleave")}function a(){return h.read()>=1024}function o(i){1024>i||(h.unsubscribe(o),f.menuAim({activate:function(t){var n=e(t),i=n.find("a.nav__link"),o=i.data("ga-label");return a()?(o&&!n.hasClass(u)&&s.sendEvent("navigation.menu","open",o),n.addClass(u).removeClass(c),void m.addClass(d)):!1},deactivate:function(t){return a()?(e(t).removeClass(u).removeClass(c),void m.removeClass(d)):!1},exitMenu:function(i){return a()?l?(l=!1,!0):(e(i).find("li."+u).addClass(c),r=t.delay(n,p),!1):!1},enter:function(t){return a()?(e(t).removeClass(c),clearTimeout(r),void(r=null)):!1},submenuDirection:"below"}),m.on("click",n))}var r,l,u="nav__item--active",c="nav__item--deactivating",d="main-nav-screen--active",h=i("breakpoint"),p=250,f=e(this).children("ul"),m=e("#main-nav-screen");i("breakpoint").subscribe(o)}var u,c={};return c.init=function(){i("breakpoint").subscribe(r),e("#main-nav-toggle").on("click",o),e("nav.nav--main").each(l)},c}),define("hbs!templates/login",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){return'\n<div class="login-form">\n  <form class="form-vertical" action="https://auth.ted.com/session" method="post">\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Email:",{name:"t",hash:{},data:i}))+'</span>\n      <input class="form-control" name="user[email]" type="email">\n    </label>\n\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Password:",{name:"t",hash:{},data:i}))+'</span>\n      <input class="form-control" name="user[password]" type="password">\n    </label>\n\n    <div class="form-group">\n      <input class="button button--dark button--wide" type="submit" value="Log in">\n\n      <div>\n        <a class="l3" href="https://auth.ted.com/account/password/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Need help logging in?",{name:"t",hash:{},data:i}))+'</a>\n      </div>\n    </div>\n  </form>\n\n  <div class="login-form__or"></div>\n\n  <div>\n    <a class="button button--wide button--dark button--facebook" href="/users/new?facebook=true">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log in with Facebook",{name:"t",hash:{},data:i}))+"</a>\n  </div>\n\n  <div>\n    "+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Don't have a TED account?",{name:"t",hash:{},data:i}))+'\n    <a class="l3" href="/users/new">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Sign up",{name:"t",hash:{},data:i}))+"</a>\n  </div>\n</div>\n"},useData:!0});return t.registerPartial("templates/login",n),n}),define("global/login",["jquery","lib/shoji","lib/pubSub","hbs!templates/login","lib/resize","widgets/fixture","widgets/tooltip"],function(e,t,n,i){"use strict";function s(s){var a=n("breakpoint").read()>=1024;if(u&&!a&&t.canSlide())return s.preventDefault(),r?void r.fixture("reveal"):void(r=e(i()).fixture({at:"right"}))}function a(e){1024>e||u&&(n("breakpoint").unsubscribe(a),o.tooltip({content:i(),interactive:!0,position:{my:"right bottom-20",at:"right top",of:window,collision:"fit flip"},beforeOpen:function(){return n("breakpoint").read()>=1024}}))}var o,r,l={},u=!1;return l.init=function(){o=e("#login-link"),o.on("click",s),n("breakpoint").subscribe(a)},l}),define("hbs!templates/accountFixture",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(e,t,n,i){var s;return null!=(s=t["if"].call(e,null!=e?e.items:e,{name:"if",hash:{},fn:this.program(2,i,0),inverse:this.program(10,i,0),data:i}))?s:""},2:function(e,t,n,i){var s,a;return'          <li class="nav__item nav__item--foldable '+(null!=(s=t["if"].call(e,null!=e?e.open:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+'">\n            <a class="nav__link" href="#">'+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"name",hash:{},data:i}):a))+'</a>\n            <div class="nav__folder" '+(null!=(s=t["if"].call(e,null!=e?e.open:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+'>\n              <ul class="nav__menu">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?s:"")+"              </ul>\n            </div>\n          </li>\n"},3:function(){return"nav__item--active"},5:function(){return'style="display:block"'},7:function(e,t,n,i){var s,a;return'                  <li class="nav__item">\n                    <a class="nav__link" href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:i}):a))+'" '+(null!=(s=t["if"].call(e,null!=e?e.external:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+">"+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"name",hash:{},data:i}):a))+"</a>\n                  </li>\n"},8:function(){return'target="_blank"'},10:function(e,t,n,i){var s,a;return'          <li class="nav__item '+(null!=(s=t["if"].call(e,null!=e?e.latch:e,{name:"if",hash:{},fn:this.program(11,i,0),inverse:this.noop,data:i}))?s:"")+'">\n            <a class="nav__link" href="'+this.escapeExpression((a=null!=(a=t.url||(null!=e?e.url:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"url",hash:{},data:i}):a))+'" '+(null!=(s=t["if"].call(e,null!=e?e.external:e,{name:"if",hash:{},fn:this.program(8,i,0),inverse:this.noop,data:i}))?s:"")+">"+this.escapeExpression((a=null!=(a=t.name||(null!=e?e.name:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"name",hash:{},data:i}):a))+"</a>\n          </li>\n"},11:function(){return"nav__item--latch"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s;return'\n<div class="account__fixture">\n  <div class="account__fixture__welcome">\n    <h2 class="h6">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Hi ",{name:"t",hash:{},data:i}))+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.firstName:s,e))+",</h2>\n    <div>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This is your stuff.",{name:"t",hash:{},data:i}))+'</div>\n  </div>\n\n  <nav class="nav">\n    <ul class="nav__menu">\n'+(null!=(s=t.each.call(e,null!=e?e.items:e,{name:"each",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+"    </ul>\n  </nav>\n</div>\n"},useData:!0});return t.registerPartial("templates/accountFixture",n),n}),define("hbs!templates/accountPoparoo",["hbs","hbs/handlebars","templates/helpers/t"],function(e,t){var n=t.template({1:function(){return"account__poparoo__later--populated"},3:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="/profiles/'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.profileId:s,e))+'/tedx-event-management">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"TEDx Events",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},5:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.conferences:s,e))+'">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Conferences",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},7:function(e,t,n,i){var s;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.tedEdHistory:s,e))+'" target="_blank">\n          '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Your activity on TED-Ed",{name:"t",hash:{},data:i}))+"\n        </a>\n      </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,i){var s,a;return'\n<div class="account__poparoo">\n  <h2>'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Hi ",{name:"t",hash:{},data:i}))+this.escapeExpression(this.lambda(null!=(s=null!=e?e.user:e)?s.firstName:s,e))+",</h2>\n  <div>"+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"This is your stuff.",{name:"t",hash:{},data:i}))+'</div>\n\n  <ul class="account__poparoo__menu">\n    <li class="account__poparoo__item" id="account-talks">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedTalks:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Saved talks",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(s=t["if"].call(e,null!=e?e.savedTalksCount:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedTalks:s,e))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((a=null!=(a=t.savedTalksCount||(null!=e?e.savedTalksCount:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"savedTalksCount",hash:{},data:i}):a))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item" id="account-playlists">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedPlaylists:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Saved playlists",{name:"t",hash:{},data:i}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(s=t["if"].call(e,null!=e?e.savedPlaylistsCount:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?s:"")+'" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.savedPlaylists:s,e))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((a=null!=(a=t.savedPlaylistsCount||(null!=e?e.savedPlaylistsCount:e))?a:t.helperMissing,"function"==typeof a?a.call(e,{name:"savedPlaylistsCount",hash:{},data:i}):a))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.favoriteTalks:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Favorite talks",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.favoritePlaylists:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Favorite playlists",{name:"t",hash:{},data:i}))+"\n      </a>\n    </li>\n\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.isTEDxOrganizer:s,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.hasConferences:s,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?s:"")+"\n"+(null!=(s=t["if"].call(e,null!=(s=null!=e?e.user:e)?s.hasEdActivity:s,{name:"if",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?s:"")+'\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.settings:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Settings",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.profile:s,e))+'">\n        '+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Your profile",{name:"t",hash:{},data:i}))+'\n      </a>\n    </li>\n  </ul>\n\n  <a class="account__poparoo__leave" href="'+this.escapeExpression(this.lambda(null!=(s=null!=e?e.itemUrls:e)?s.logOut:s,e))+'">'+this.escapeExpression((t.t||e&&e.t||t.helperMissing).call(e,"Log out",{name:"t",hash:{},data:i}))+"</a>\n</div>\n"},useData:!0});return t.registerPartial("templates/accountPoparoo",n),n}),define("plugins/addClassFor",["jquery"],function(e){"use strict";e.fn.extend({addClassFor:function(e,t){var n=this;return window.setTimeout(function(){n.removeClass(e)},t),n.addClass(e)}})}),define("global/account",["jquery","lodash","lib/shoji","lib/pubSub","lib/currentUser","lib/personalStorage","lib/watchLaterLocal","utils/monogram","hbs!templates/accountFixture","hbs!templates/accountPoparoo","hbs!templates/latcherFixture","lib/resize","transit","widgets/fixture","plugins/addClassFor"],function(e,t,n,i,s,a,o,r,l,u,c){"use strict";function d(t){var s=i("breakpoint").read()>=1024;if(n.canSlide()&&(t.preventDefault(),!s)){if(b)return void b.fixture("reveal");b=e(l({items:T(w),user:w})).fixture({at:"right"}),b.find("li.nav__item--latch a").attr("href",function(){var t=e(this),n=t.attr("href");return t.attr("data-url",n),"#"});var a=e("div.shoji__fixture--right #submenu");if(b.drillDown({tense:a.length?"past":"present"}),a.length){a.find("h3.submenu__heading").remove();var o=e(c()).append(a.clone().addClass("submenu--fixture"));o.find("a.latcher__back").on("click",function(){b.drillDown("show")}),b.drillDown("queue",o,{tense:"present"})}}}function h(e){if(!(1024>e)){i("breakpoint").unsubscribe(h);var t=_.parent().find("div.nav__folder").html(u({itemUrls:E,user:w,savedTalksCount:!1,savedPlaylistsCount:!1}));y=t.find("a."+x),f()}}function p(){v||(v=e("#account-link").find("img.banner__account__image")),v.transition({opacity:0}).transition({opacity:1}).transition({opacity:0}).transition({opacity:1})}function f(){o.count().done(C)}function m(e,t){e.find("a.account__poparoo__later")[t?"addClass":"removeClass"]("account__poparoo__later--populated").find("span").text(t)}function g(t){var n;w=t,S(),f(),w.avatarUrl?(n=e("<img class=banner__account__image id=account-image>"),n.attr({alt:"",src:w.avatarUrl}),e("#account-image").replaceWith(n)):e("#account-image").text(r(w.firstName+" "+w.lastName))}var _,v,b,y,w,k={},x="account__poparoo__later",E={savedTalks:"/dashboard/saved_talks",savedPlaylists:"/dashboard/saved_playlists",favoriteTalks:"/dashboard/favorite_talks",favoritePlaylists:"/dashboard/favorite_playlists",watchHistory:"/dashboard/history",conferences:"/dashboard/conferences",tedEdHistory:"http://ed.ted.com/activity/lessons",settings:TED.settingsUrl,profile:"/profile",logOut:TED.signOutUrl},T=function(e){var t=[];if(t.push({name:"Talks",open:!0,items:[{name:"Saved talks",url:E.savedTalks},{name:"Saved playlists",url:E.savedPlaylists},{name:"Favorite talks",url:E.favoriteTalks},{name:"Favorite playlists",url:E.favoritePlaylists},{name:"Talks you've watched",url:E.watchHistory}]}),e&&e.isTEDxOrganizer&&t.push({name:"TEDx Events",url:"/profiles/"+e.profileId+"/tedx-event-management"}),e&&e.hasConferences){var n={name:"Conferences",open:!1,items:[]};e.upcomingConferences&&e.upcomingConferences.reduce(function(e,t){return e.push({name:t.name,url:"/dashboard/conferences/"+t.slug}),e},n.items),n.items.push({name:"Badge",url:"/dashboard/conferences/badge"}),n.items.push({name:"Contact us",url:"/dashboard/conferences/contact"}),t.push(n)}return e&&e.hasEdActivity&&t.push({name:"Your TED-Ed activity",url:E.tedEdHistory,external:!0}),t.push({latch:!0,name:"Settings",url:TED.settingsUrl}),t.push({name:"Your profile",url:"/profile"}),t.push({name:"Log out",url:TED.signOutUrl}),t},C=function(){var t,n,i;return function(s){var a,o=s.total,r=o>0;if(o!==t){var l;n&&s.talks!==n&&(a="talks",l=s.talks>n),i&&s.playlists!==i&&(a="playlists",l=s.playlists>i),a&&e("#account-"+a)[l?"addClass":"removeClass"]("account__poparoo__item--active"),s.talks!==n&&m(e("#account-talks"),s.talks),s.playlists!==i&&m(e("#account-playlists"),s.playlists);var u=e("#account-badge");u.text(s.total>99?99:s.total)[r?"addClass":"removeClass"]("badge--visible"),r&&null!==t&&s.total>t&&u.addClassFor("badge--notify",600),n=s.talks,i=s.playlists,t=o}}}(),S=t.once(function(){_=e("#account-link"),_.on("click",d),i("breakpoint").subscribe(h),i("favorite.add").subscribe(p),i("watchLater.add").subscribe(f),i("watchLater.remove").subscribe(f)});return k.init=t.once(function(){i("auth.login").subscribe(g),s.getDetails().done(g)}),k}),define("global/uconf",["jquery","Cookies"],function(e,t){"use strict";var n="#";return{init:function(i,s){e(n+s).on("click",function(s){s.preventDefault(),e(n+i).slideUp("fast"),t.expire("_uconf",{domain:"ted.com",path:"/"})})}}}),define("global/keyboard",["jquery","exports","jqueryui/core"],function(e,t){"use strict";t._keyDowned=!1,t._keyDown=function(n){var i;n.keyCode!==e.ui.keyCode.SPACE||t._keyDowned||n.isPropagationStopped()||n.isDefaultPrevented()||!(i=e(n.target)).is("a[role=button]")||(n.preventDefault(),i.trigger("click",n)),t._keyDowned=!0},t._keyUp=function(){t._keyDowned=!1},t.init=function(){e(window).on({keydown:t._keyDown,keyup:t._keyUp})}}),define("global/errors",["lib/errorCollector"],function(e){"use strict";window.onerror=function(t,n,i){i&&n.match(/^https?:\/\/(?:.*\.)?(?:ted|tedcdn)\.com\//)&&(!n.match(/\.js/)&&5>i||e.log(t,{file:n,line:i}))}}),require(["jquery","lodash","dq","global/floodlight","global/links","global/subscribe","global/navs","global/mainNav","global/login","global/account","global/uconf","global/keyboard","lib/ads","global/errors","lib/auth","lib/instaplay","jqueryujs"],function(e,t,n,i,s,a,o,r,l,u,c,d,h){"use strict";t.defer(function(){s.init(),a.init(),o.init(),r.init(),l.init(),u.init(),d.init()}),n({q:_g,modules:{ads:h,floodlight:i,uconf:c}})}),define("global",function(){}),define("talk",["jquery","dq","abby-tests/sponsorship-2/sponsorship","talk/talkPage","talk/transcript","global"],function(e,t,n,i,s){"use strict";t({modules:{sponsorship:n,talkPage:i,transcript:s}})})}();
//# sourceMappingURL=talk.js
//# sourceMappingURL=talk.js.map